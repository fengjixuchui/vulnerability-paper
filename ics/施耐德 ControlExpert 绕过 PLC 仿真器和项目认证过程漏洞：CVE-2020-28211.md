> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/2VsdZJAhNLqD8tglLGELqQ)

**![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3MmaYz8UWHicLDSC4e3NqcibOLicCiaYtmQm9A0Ied3OLs4Wibj6bLz8jmf0gB3k0h1aQNNVKNqjKFcZV0Mg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)**
----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Schneider Electric EcoStruxure Control Expert（前称 Unity Pro）是法国施耐德电气（Schneider Electric）公司的一套用于 Schneider Electric 逻辑控制器产品的编程软件。该软件的 V14.1 以下的版本存在一个不正确的授权漏洞 - CVE-2020-28211，可导致项目的身份验证被绕过。

Part1

漏洞状态

<table interlaced="enabled" width="677"><tbody><tr><td width="123" valign="top" align="center">漏洞细节<br></td><td width="123" valign="top" align="center">漏洞 POC<br></td><td width="123" valign="top" align="center">漏洞 EXP<br></td><td width="123" valign="top" align="center">在野利用<br></td></tr><tr><td width="123" valign="top" align="center">有<br></td><td width="123" valign="top" align="center">有<br></td><td width="123" valign="top" align="center">有</td><td width="123" valign="top" align="center">无</td></tr></tbody></table>

Part2

漏洞描述

EcoStruxure Control Expert 上存在不正确的授权漏洞，当使用调试器或其他方法覆盖内存时，该漏洞可能导致绕过身份验证。

<table interlaced="enabled" width="677"><tbody><tr><td width="103" valign="middle" align="center">‍漏洞名称<br></td><td valign="middle" align="left" width="432.6666666666667"><p>&nbsp; 绕过 PLC 仿真器和项目认证过程漏洞</p></td></tr><tr><td width="103" valign="middle" align="center">CVE 编号</td><td valign="top" width="432.6666666666667">CVE-2020-28211</td></tr><tr><td width="103" valign="middle" align="center">漏洞类型</td><td valign="top" width="432.6666666666667">绕过身份验证</td></tr><tr><td width="103" valign="middle" align="center">漏洞等级</td><td valign="top" width="432.6666666666667">7.8 高危</td></tr><tr><td width="103" valign="middle" align="center">公开状态</td><td valign="top" width="432.6666666666667">公开<br></td></tr><tr><td width="103" valign="middle" align="center">时间线</td><td valign="top" width="432.6666666666667"><section>2020-11-05 - 分配 CVE</section><section>2020-11-08 - 公开发布</section></td></tr><tr><td valign="middle" colspan="1" rowspan="1" align="center">影响范围<br></td><td valign="top" colspan="1" rowspan="1" width="432.6666666666667"><p>‍Schneider Electric EcoStruxure Control Expert&nbsp; version &lt;=&nbsp;v14.1<br></p></td></tr><tr><td valign="middle" colspan="1" rowspan="1" align="center">复现环境<br></td><td valign="middle" colspan="1" rowspan="1" align="left"><section>Windows 10</section><section>Schneider Electric EcoStruxure Control Expert v14.1</section></td></tr></tbody></table>

Part3

漏洞复现

- 安装 Schneider Electric EcoStruxure Control Expert v14.1

- 启动 Control Expert 14.1

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqRUjfDhnsLgyCicX1rZl4p35fBz6nWlicDoWvxib9XpCLZV5gTdmycXUbg/640?wx_fmt=png)

新建任意项目并添加密码 (这里我们先暂时设置 hellovuleye):

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvq73UDuxDHAGZI9gXnn16AxwFkdU0YCqtdZROGcbJ1fZ72icJgdJUiaSmQ/640?wx_fmt=png)

无需其他操作，直接保存项目到任意目录下:

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqgObf7FBRBAibFmw0M1JUqFCMashwVrXJrPJBoC5D1KGDB1UFWlwYfpQ/640?wx_fmt=png)

项目生成两个文件 **.stu  **.ztx

其中 stu 是主要工程文件，双击打开就会提示输入密码。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqFZBXyMIjYiaicXKDicfm9aTzibClePmHukB74LL7JqxUh41ibFBAZthKleg/640?wx_fmt=png)

这里我们使用 xdbg 附加进程。然后在 关键函数位置下断点。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvq9ktvRulTKfukhEK3TJ6tRFdV8RW8hYYZbVSI6bDia7gYA0wCiaw80L8g/640?wx_fmt=png)

输入任意错误密码我这里输入 9 个 6 (666666666

) 然后点击确定。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqoXlcziawNttXRibKFfEhWmXDBibiaQVBbymJHjP3NcdqjwBib1ibrDG46gmw/640?wx_fmt=png)

断点断下，我们不做任何处理，直接运行。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqGAcGD6YPbEoF7SnAyTd5L05fic4PAo9MCvjjFvoAAaJbKBcfAnQXQrA/640?wx_fmt=png)

提示密码错误。

再次输入 9 个 6-> 确定。

断点再次断下，我们进行内存覆盖，F9 执行。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqm6P2OicJMADfBLFEQufH8GHCSdX2v4OpU4iaPm3vh8L22Y9QVWMKbLlQ/640?wx_fmt=png)

项目被打开。

**复现成功！**

Part4

漏洞细节

此漏洞出现的原因是最终验证身份的关键点只是一个函数的返回值，很容易被绕过，如果使用一些加密方式来加密工程文件，首先验证密码，然后通过密码解密工程，这样就不容易被绕过。

Part5

修复缓解建议

1. 软件升级至最新版本。

2. 安装主机卫士，开启实时防护。

**SAFE**

**获取更多情报**

  

联系我们，获取更多漏洞情报详情及处置建议，让企业远离漏洞威胁。  
电话：18511745601

邮箱：shiliangang@andisec.com

**漏洞分析回顾**  
![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3MmYrt8sZBqiah8aNInQspzccnPAAhd0OKLQ5Ziad4ovQEohiamyrpYjQcwVAWROpYWmMXia1YRKPiczFSQw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqJddia6nWBkicKwU0R51S6sAQM6m8KibuRKGchiaEyvBmxBmCGgfJcPiby8g/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247527471&idx=1&sn=b47d0c0c2ca5a8cdadd5f29c9f2738c1&chksm=fd768678ca010f6e4c7fb5df798fceed8e3812ced7f01bb4e65535237e812d802e03c6653a92&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmYIzIgURvDm1RmDXLIKabvqkNHGnMqI6BQVR5bC0e5KOuJWXG7T9AklJAB74nx7OkSWGKMMjBsaLw/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247527321&idx=1&sn=99adf54de611e2219c72dddad13543c5&chksm=fd7681ceca0108d8c2a6b89ee1a1d3444429093cc3a1eacb18c9e96d5c213c07e49903c2c985&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmYIzIgURvDm1RmDXLIKabvq6qCKHakWCXdVd9XBFBDdAotZ8FrTZiajcVaMSkau6QByhiatRtVABWXQ/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247527202&idx=1&sn=ea96acfd6496f6007b256ce2a57e8d07&chksm=fd768175ca010863e5e3433d97818fbb52a03531a59a8deb10cd070990a0f032cfd644b9091e&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmYIzIgURvDm1RmDXLIKabvq2pmTxeppF969UqoeN1240kOJtZhWIj1sqtnLxhibFbZKLicybU8Qa4qg/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247526917&idx=1&sn=cfabda4c5811b30453ea57f876fba6e1&chksm=fd768052ca010944cd7874202f1fbdb11f62b995ed642ae55ee78d61ed71ec7d7177df80bfc4&scene=21#wechat_redirect)

  

北京安帝科技有限公司是新兴的工业网络安全能力供应商，专注于网络化、数字化、智能化背景下的工业网络安全技术、产品、服务的创新研究和实践探索，基于网络空间行为学理论及工业网络系统安全工程方法，围绕工业网络控制系统构建预防、识别、检测、保护、响应、恢复等核心能力优势，为电力、水利、石油石化、轨道交通、烟草、钢铁冶金、智能制造、矿业等关键信息基础设施行业提供安全产品、服务和综合解决方案。坚持 IT 安全与 OT 安全融合发展，坚持产品体系的自主可控，全面赋能客户构建 “业务应用紧耦合、用户行为强相关、安全风险自适应、网络弹性稳增强” 的主动防御和纵深防御相结合的安全保障体系。截至 2021 年底，公司主要产品已应用于数千家 “关基” 企业，其中工业网络安全态势感知平台已部署 4000 余家客户，虚实结合工业网络靶场服务超过 50 家客户。

![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3Mma4ibTfp7sC3ibt8WmetoDfiaGHEb7VOiaemeFbuCTupYgus7NTKkibwKwpsEDfzqZdXh1skHff6A6VNgA/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

**点击 “在看” 鼓励一下吧**

**![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZOFFgf4oTyfUTx7y0ZBV9yIg8qmaSwAvbjiba2KQn7VgmXYIriagc9H0hMu1u0UIZr98JYSmyG9tibg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)**