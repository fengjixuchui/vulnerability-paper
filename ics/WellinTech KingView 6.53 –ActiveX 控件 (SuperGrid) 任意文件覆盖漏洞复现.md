> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/md98UqnzrTtf3hyyERFuIg)

**![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3MmaYz8UWHicLDSC4e3NqcibOLicCiaYtmQm9A0Ied3OLs4Wibj6bLz8jmf0gB3k0h1aQNNVKNqjKFcZV0Mg/640?wx_fmt=gif)**
---------------------------------------------------------------------------------------------------------------------------------------------------

亚控科技是一家致力于人机界面产品研发的公司，总部位于中国北京，在日本、韩国、新加坡等多个国家设有分支机构。该公司 SCADA 产品 KingView 6.53 之前的版本中 ActiveX(SuperGrid) 控件存在任意文件覆盖漏洞，一旦被攻击者利用可能导致任意命令执行。该系列产品广泛应用于，电力、制造、供水和污水处理、楼宇自动化、采矿、环保、冶金等领域，具有较高的市场占有率。

Part1

漏洞状态

<table interlaced="enabled"><tbody><tr><td width="123" valign="top" align="center">漏洞细节<br></td><td width="123" valign="top" align="center">漏洞 POC<br></td><td width="123" valign="top" align="center">漏洞 EXP<br></td><td width="123" valign="top" align="center">在野利用<br></td></tr><tr><td width="123" valign="top" align="center">有<br></td><td width="123" valign="top" align="center">有<br></td><td width="123" valign="top" align="center">有</td><td width="123" valign="top" align="center">未知</td></tr></tbody></table>

Part2

漏洞描述

KingView 6.53 之前的版本中 ActiveX(SuperGrid) 控件存在任意文件覆盖漏洞。该漏洞产生的原因为程序中使用 ReplaceDBFile 函数时没有过滤用户提交的输入，其结果可导致远程攻击者可通过两个路径名参数创建或覆盖任意文件，并随后执行任意程序。

<table interlaced="enabled"><tbody><tr><td width="103" valign="middle" align="center">‍漏洞名称<br></td><td width="431" valign="middle" align="left"><section>WellinTech KingView 6.53 –ActiveX 控件 (SuperGrid) 任意文件覆盖漏洞</section></td></tr><tr><td width="103" valign="middle" align="center">CVE 编号</td><td width="431" valign="top">CVE-2013-6127</td></tr><tr><td width="103" valign="middle" align="center">漏洞类型</td><td width="431" valign="top">任意文件覆盖</td></tr><tr><td width="103" valign="middle" align="center">漏洞等级</td><td width="431" valign="top">7.5&nbsp;高危</td></tr><tr><td width="103" valign="middle" align="center">公开状态</td><td width="431" valign="top">公开<br></td></tr><tr><td width="103" valign="middle" align="center">时间线</td><td width="431" valign="top"><p>2013.10.15 – 分配 CVE ID</p><p>2015.11.24 – 漏洞补丁发布</p></td></tr></tbody></table>

Part3

漏洞复现

**1. 实验环境**

靶机环境：win xp sp3，IE7

软件版本：KingView 6.53

**2. 复现步骤**

第一步：将渗透主机中的 C:\share\poc2.txt 设为共享文件。

第二步：将渗透主机中的 IE —》internet 选项中 ActiveX 件改为启用状态。

第三步：攻击者通过靶机 IE 浏览器访问桌面文件 28084.html。

![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3Mmb9p0SKroKg8326viadLiczIWqDeicULwfYcZMWK4jpCDPVaeV9hIYNtcWcA9JjB1J2oqlaDicDIEmz6Q/640?wx_fmt=jpeg)

发现靶机文件中的 C:\Windows\poc1.txt 的 poc1 文件内容覆盖。

![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZWRtpTVIpmqSia9Ooa8SwQ0lj3DPjWKQD0zUAfSOVrE2fXejia1axEYydK42tPZK0fShxxa2MA33Rw/640?wx_fmt=jpeg)

Part4

漏洞分析

通过 COMRaider 工具可查看漏洞控件 “SuperGrid.ocx” 的接口，其中函数 ReplaceDBFile 没有正确过滤用户提交的输入，导致可以调用 ReplaceDBFile 覆盖使用 ActiveX 控件的应用程序（典型的 IE 浏览器）可以使一个位置的文件覆盖另一个位置的文件。

![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZWRtpTVIpmqSia9Ooa8SwQ0FjErrs7mR3axxCJVIwCbhMDgjUBejLjq8LBsyc4fv9MP1drxY1ZYTQ/640?wx_fmt=jpeg)

Part5

修复建议  

升级到最新版本。

Part6

缓解措施

屏蔽 SuperGrid ActiveX 控件。

**SAFE**

**获取更多情报**

  

联系我们，获取更多漏洞情报详情及处置建议，让企业远离漏洞威胁。  
电话：18511745601

邮箱：shiliangang@andisec.com

**漏洞分析回顾**  
![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3MmYrt8sZBqiah8aNInQspzccnPAAhd0OKLQ5Ziad4ovQEohiamyrpYjQcwVAWROpYWmMXia1YRKPiczFSQw/640?wx_fmt=gif)[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZWRtpTVIpmqSia9Ooa8SwQ0tr0YxhElttZRwWaYztZ53RIRL4GjicRBrrt70X32YSHEs1J65hAKPrg/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247527321&idx=1&sn=99adf54de611e2219c72dddad13543c5&chksm=fd7681ceca0108d8c2a6b89ee1a1d3444429093cc3a1eacb18c9e96d5c213c07e49903c2c985&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZWRtpTVIpmqSia9Ooa8SwQ05iaRMJK5EKmMxYG398LmrZibDTSy7CXn4sx4icpHLXGQsggCibtoRIr6eQ/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247527202&idx=1&sn=ea96acfd6496f6007b256ce2a57e8d07&chksm=fd768175ca010863e5e3433d97818fbb52a03531a59a8deb10cd070990a0f032cfd644b9091e&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZWRtpTVIpmqSia9Ooa8SwQ05J2eeqnNXc2RXyhzVFMvdEFEwHrR9amjtOiamyxNVzHr1Ut7JrficPKg/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247526917&idx=1&sn=cfabda4c5811b30453ea57f876fba6e1&chksm=fd768052ca010944cd7874202f1fbdb11f62b995ed642ae55ee78d61ed71ec7d7177df80bfc4&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZWRtpTVIpmqSia9Ooa8SwQ0v03LicAAkvniarIwhDWiaHWSE66t8QWyuhtbTAkGMbmO6I6SeXylQY7QA/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247526417&idx=1&sn=eb560bc466b7006cebdb3b6542adf075&chksm=fd768246ca010b50f8a84978eec9810ae0e29b3c0a70669d61762aee143b8c63082d9cd7214a&scene=21#wechat_redirect)

  

北京安帝科技有限公司是新兴的工业网络安全能力供应商，专注于网络化、数字化、智能化背景下的工业网络安全技术、产品、服务的创新研究和实践探索，基于网络空间行为学理论及工业网络系统安全工程方法，围绕工业网络控制系统构建预防、识别、检测、保护、响应、恢复等核心能力优势，为电力、水利、石油石化、轨道交通、烟草、钢铁冶金、智能制造、矿业等关键信息基础设施行业提供安全产品、服务和综合解决方案。坚持 IT 安全与 OT 安全融合发展，坚持产品体系的自主可控，全面赋能客户构建 “业务应用紧耦合、用户行为强相关、安全风险自适应、网络弹性稳增强” 的主动防御和纵深防御相结合的安全保障体系。截至 2021 年底，公司主要产品已应用于数千家 “关基” 企业，其中工业网络安全态势感知平台已部署 4000 余家客户，虚实结合工业网络靶场服务超过 50 家客户。

![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3Mma4ibTfp7sC3ibt8WmetoDfiaGHEb7VOiaemeFbuCTupYgus7NTKkibwKwpsEDfzqZdXh1skHff6A6VNgA/640?wx_fmt=gif)

**点击 “在看” 鼓励一下吧**

**![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZOFFgf4oTyfUTx7y0ZBV9yIg8qmaSwAvbjiba2KQn7VgmXYIriagc9H0hMu1u0UIZr98JYSmyG9tibg/640?wx_fmt=png)**