> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/cDxFoqA1pcbbmWp7HmWpCg)

  

  

网安引领时代，弥天点亮未来 

  

  

  

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x00写在前面**  

  

**本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责！**

  

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x01漏洞信息**  

  

该漏洞的存在是由于Linux内核中某些*_OR_NULL指针类型的指针算法的可用性。本地用户可以运行特制的程序，最终以root权限执行任意代码，利用条件为低权限用户认证。

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x02影响范围**  

  

linux内核 5.8 - 5.16

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x03漏洞复现**  

  

  

内核版本

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hBhu8XqF5QxERKDce19xHOWZ4aTrLjxiaUeKaTKnqo6x3j6EbNxSkPYyR4dp9ax1ZXyr2MbLERQ7Zg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

1.github下载利用exp

```
git clone https://github.com/tr3ee/CVE-2022-23222.git
```

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hBhu8XqF5QxERKDce19xHOWaUvj43N1TF5n4HvBcCbEtYGb30LIpBiafI4ibiaTQUCxHS5z6KzpH71ww/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

2.make进行编译

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hBhu8XqF5QxERKDce19xHOW6zACRrTibP8FLnsmzgic3ucbzicR4rl7VeNehITfWD7n0z4ksD4FXYD7Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

3.执行exp进行本地提权到root

普通用户权限

![图片](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hBhu8XqF5QxERKDce19xHOWA2icCzCn8ox7E14IoNibw69ApZ5CTkQUibTAvd8f2gqEBeqK0ibU9a10ng/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

4.root权限下运行，显示如下

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

root权限  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

这里是github执行效果  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**0x04修复建议**  

  

目前厂商已发布升级补丁以修复漏洞，更新到以下版本

linux内核 5.10.92 / 5.15.15 / 5.16.1

补丁获取链接

```
https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tree/kernel/bpf/verifier.c?h=v5.10.83#n6022
```

  

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**0x05参考链接**  

  

https://github.com/tr3ee/CVE-2022-23222

https://mp.weixin.qq.com/s/OpzV6nAs2YhJTCkG4qNt_w

  

  

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==) 

知识分享完了

喜欢别忘了关注我们哦~

  

学海浩茫，

予以风动，

必降弥天之润！

  

   弥  天

安全实验室  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)