<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/kzp1g_6QBHi92aLVf-A9Jw)

![图片](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKtyRqLobnku1gh5GxiarOOHzVwY4mmmiaLiadjn0C7Q7Ka0VuVB841s5ibQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![图片](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKUwkOcaWnA0M0dcRfJib3K9Kc11EPOvzsNdT0PmbIArNlxshVmG4XO8Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

点击上方 蓝字 关注我们

  

  

_**1. PLC 任意端口拒绝服务漏洞**_

  

<table cellspacing="0" cellpadding="0" width="551" style="visibility: visible;"><tbody style="visibility: visible;"><tr style="height: 72px; visibility: visible;"><td width="66" style="border-width: 1px; border-color: windowtext; padding: 0px 7px; visibility: visible;" height="72"><section style="text-align: center; margin-left: 8px; margin-right: 8px; visibility: visible;">问题名称</section></td><td width="485" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-style: none; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; padding: 0px 7px; visibility: visible;" height="72"><section style="margin-left: 8px; margin-right: 8px; visibility: visible;">PLC任意端口拒绝服务漏洞</section></td></tr><tr style="visibility: visible;"><td width="66" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: none; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; padding: 0px 7px; visibility: visible;"><section style="text-align: center; margin-left: 8px; margin-right: 8px; visibility: visible;">检测工具</section></td><td width="485" style="margin-left: 8px; margin-right: 8px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-style: none; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; padding: 0px 7px; height: 72px; visibility: visible;"><section style="margin-left: 8px; margin-right: 8px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-style: none; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; padding: 0px 7px; height: 72px; visibility: visible;">Python</section></td></tr><tr style="height: 74px; visibility: visible;"><td width="66" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: none; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; padding: 0px 7px; visibility: visible;" height="74"><section style="text-align: center; margin-left: 8px; margin-right: 8px; visibility: visible;">问题描述</section></td><td width="485" style="border-top-style: none; border-left-style: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px; visibility: visible;" height="74"><section style="text-align: left; margin-left: 8px; margin-right: 8px; visibility: visible;">远程攻击者可利用此漏洞使得设备无响应，导致拒绝服务，需断电重启PLC后方可恢复正常。</section></td></tr><tr style="visibility: visible;"><td width="66" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: none; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; padding: 0px 7px; visibility: visible;"><section style="text-align: center; margin-left: 8px; margin-right: 8px; visibility: visible;">测试步骤描述</section></td><td width="485" style="border-top-style: none; border-left-style: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px; visibility: visible;"><section style="margin-left: 8px; margin-right: 8px; visibility: visible;">1、向PLC开放的任意端口（如21，5900，11000，30000等）发送超长UDP数据包（例如5000个字符A）</section><section style="margin-left: 8px; margin-right: 8px; visibility: visible;">2、可发现原来运行中的PLC程序停止，软件中弹出PLC离线提示，同时PLC无法被PING通</section><section style="margin-left: 8px; margin-right: 8px; visibility: visible;">3、断电重启后方可恢复运行。</section><section style="margin-left: 8px; margin-right: 8px; visibility: visible;"><img class="rich_pages wxw-img" data-ratio="0.5229591836734694" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK12BwrzH19hr2dArrsUPumoibcKn5VLAMict1L7qRL3bVO9uRDVDUQEibw/640?wx_fmt=png" data-type="png" data-w="784" height="158" width="303" _width="303px" src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK12BwrzH19hr2dArrsUPumoibcKn5VLAMict1L7qRL3bVO9uRDVDUQEibw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" style="visibility: visible !important; width: 303px !important; height: auto !important;" crossorigin="anonymous" alt="图片" data-fail="0"><img class="rich_pages wxw-img" data-ratio="0.3746397694524496" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKQKelUXwiag6eshqIztDS1zpGOXXicCBdxIwJxcpo5IkTmickpzhHyoqaw/640?wx_fmt=png" data-type="png" data-w="694" height="109" width="290" _width="290px" src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKQKelUXwiag6eshqIztDS1zpGOXXicCBdxIwJxcpo5IkTmickpzhHyoqaw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" style="visibility: visible !important; width: 290px !important; height: auto !important;" crossorigin="anonymous" alt="图片" data-fail="0"></section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">其他说明</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br></td></tr></tbody></table>

![图片](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKDjL7tMvJ0bOEhFt9ZtyMkRMhClNrCcufrOlm5HvsBLULE8ibLUiaP0Pg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

  

_**2. PLC 远程控制启停漏洞**_

  

<table cellspacing="0" cellpadding="0" width="551"><tbody><tr style="height: 72px;"><td width="66" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题名称</section></td><td width="485" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;">PLC远程控制启停漏洞</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">检测工具</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">Python发包脚本&nbsp;wireshark</section></td></tr><tr style="height: 74px;"><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;">攻击者可远程向PLC 11000端口发送特殊构造的数据包，实现远程控制PLC的启动/停止。</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">测试步骤描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="text-align: left;margin-left: 8px;margin-right: 8px;">通过分析交互协议，实现：</section><section style="text-align: left;margin-left: 8px;margin-right: 8px;">1、远程控制停机：向运行状态的PLC的11000端口发送UDP数据包，内容：0d00661a100019000000f82a03000000’，收到响应报文后观察PLC上I/O指示灯熄灭，程序停止运行；</section><section style="margin-left: 8px;margin-right: 8px;">2、远程控制启动：向停止状态的PLC的11000端口发送UDP数据包，内容：0d00913910001a007000f82a0100ffff，收到响应报文后观察PLC上I/O指示灯点亮，程序恢复运行；</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">其他说明</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br></td></tr></tbody></table>

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

_**3**__**.  PLC_Config 软件**__**内置弱密码加密漏洞**_

  

<table cellspacing="0" cellpadding="0" width="551"><tbody><tr style="height: 72px;"><td width="66" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题名称</section></td><td width="485" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;">PLC_Config软件存在弱密码加密漏洞</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">检测工具</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">IDA</section></td></tr><tr style="height: 74px;"><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;">PLC软件中的“生成统一下载镜像”功能，压缩时使用了内置统一的弱密码（DCCE），加密后的镜像文件可被解密还原。弱密码无法提供有效加密保护。</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">测试步骤描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">1、打开PLC_Config，在左边的控制器图标上单击右键</section><section style="margin-left: 8px;margin-right: 8px;">2.&nbsp;在弹出菜单中选择“生成下载镜像”选项，选择加密</section><section style="margin-left: 8px;margin-right: 8px;">3．修改生成的镜像文件后缀为7z，打开后按提示输入密码DCCE即可解压，得到解密后的镜像完整目录结构：</section><section style="margin-left: 8px;margin-right: 8px;"><img data-ratio="0.90625" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKriaPKT8IQKIibxNbYhiaEia0BbKdckxGcz0nba1JH1JPBNEz3GsaVYiaM8Q/640?wx_fmt=png" data-type="png" data-w="448" height="203" width="224" _width="224px" class="" src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKriaPKT8IQKIibxNbYhiaEia0BbKdckxGcz0nba1JH1JPBNEz3GsaVYiaM8Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" style="width: 224px !important; height: auto !important; visibility: visible !important;" crossorigin="anonymous" alt="图片" data-fail="0"></section><section style="margin-left: 8px;margin-right: 8px;">5. 通过逆向分析发现，该功能的实现是通过7Z作为压缩工具，IDA反汇编可发现见密码为DCCE。</section><section style="margin-left: 8px;margin-right: 8px;"><img data-ratio="0.8137044967880086" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK63ldTPpcB2DIksyLCgq3FjgzWRibKUWSVIBeHiaWZpfEvqCRNW5E7OiaQ/640?wx_fmt=png" data-type="png" data-w="467" height="265" width="325" _width="325px" class="" src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK63ldTPpcB2DIksyLCgq3FjgzWRibKUWSVIBeHiaWZpfEvqCRNW5E7OiaQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" style="width: 325px !important; height: auto !important; visibility: visible !important;" crossorigin="anonymous" alt="图片" data-fail="0"></section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">其他说明</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br></td></tr></tbody></table>

![图片](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKDjL7tMvJ0bOEhFt9ZtyMkRMhClNrCcufrOlm5HvsBLULE8ibLUiaP0Pg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

  

_**4. PLC 远程篡改参数导致无法组态编程**_

  

<table cellspacing="0" cellpadding="0" width="551"><tbody><tr style="height: 72px;"><td width="66" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题名称</section></td><td width="485" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;">PLC远程篡改“控制器名称”参数导致无法再次组态编程，重启无效，只能恢复固件</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">检测工具</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">基于python脚本</section></td></tr><tr style="height: 74px;"><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: left;margin-left: 8px;margin-right: 8px;">PLC未能正确处理字符串截断，构造畸形字符报文修改PLC“控制器名称”参数，可导致PLC无法再次组态，无法使用软件上传下载编写程序，断电重启无法恢复，只能重新刷固件。</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">测试步骤描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><ol style="list-style-type: decimal;margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li style="font-size: 16px;"><p>1.&nbsp;查看PLC配置信息，可以看到控制器信息完整。</p></li></ol><section style="margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-ratio="1.029654036243822" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKCpz8AzfOQaBTNy9wjJEIR9IwO84YEOX6dicS330biaibhZXaJLHxYrbmw/640?wx_fmt=png" data-type="png" data-w="607" height="256" width="250" _width="250px" src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKCpz8AzfOQaBTNy9wjJEIR9IwO84YEOX6dicS330biaibhZXaJLHxYrbmw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" style="width: 250px !important; height: auto !important; visibility: visible !important;" crossorigin="anonymous" alt="图片" data-fail="0"></section><section style="margin-left: 8px;margin-right: 8px;">2.向11000端口发送特定畸形数据包(不以0x00结尾)，修改PLC的“控制器名称”，例如“0x6161616161616161616161616161…”。</section><section style="margin-left: 8px;margin-right: 8px;"><img data-ratio="0.3406813627254509" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKvEzQ67gRibJbckLh7c8hx9zCl9QS8e098kqFTibbl6fkIyLExLeCQLnA/640?wx_fmt=png" data-type="png" data-w="499" height="90" width="262" _width="262px" class="" src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKvEzQ67gRibJbckLh7c8hx9zCl9QS8e098kqFTibbl6fkIyLExLeCQLnA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" style="width: 262px !important; height: auto !important; visibility: visible !important;" crossorigin="anonymous" alt="图片" data-fail="0"></section><section style="margin-left: 8px;margin-right: 8px;">2、读取plc配置信息发现“控制器名称”已无法显示，虽然plc在线，但无法修改控制器参数及进行组态，断电重启无效，新建工程无法识别PLC，只有重置PLC固件才能恢复使用。</section><section style="margin-left: 8px;margin-right: 8px;"><img data-ratio="0.6026272577996716" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKiaT0bvn1rmZjlemEyYibeR6xuJ6VHghYKqIFrcSyr0cBOMqM1quibKALQ/640?wx_fmt=png" data-type="png" data-w="609" height="170" width="280" _width="280px" class="img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 280px !important; height: 169.53px !important;" crossorigin="anonymous" alt="图片"></section><section style="margin-left: 8px;margin-right: 8px;"><img data-ratio="0.35687732342007433" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK9ttyic1phFA2VwhuiaVgEQaHyouH2LLM30gyd2ucLH8pAJaplYEHUUOA/640?wx_fmt=png" data-type="png" data-w="807" height="100" width="282" _width="282px" class="img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 282px !important; height: 101.926px !important;" crossorigin="anonymous" alt="图片"></section><section style="margin-left: 8px;margin-right: 8px;">重新点开的时候，发现程序配置虽然可以读取，但是重复报错，显示不正常，提示“写AI工程校准值失败”。</section><section style="margin-left: 8px;margin-right: 8px;"><img data-ratio="0.7086092715231788" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKF7qsAia930RmLFA582vzPEndB8SdZBmDl7XbuTltSsTTnCURkKU6AZw/640?wx_fmt=png" data-type="png" data-w="604" height="183" width="258" _width="258px" class="img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 258px !important; height: 183.404px !important;" crossorigin="anonymous" alt="图片"></section><section style="margin-left: 8px;margin-right: 8px;"><img data-ratio="0.7392739273927392" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKlBs3jD2u1wXSg16sdUo68oOHEKicwRvPicic0eib8VfH1licsiaicH9G6u9BQ/640?wx_fmt=png" data-type="png" data-w="606" height="253" width="343" _width="343px" class="img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 343px !important; height: 254.092px !important;" crossorigin="anonymous" alt="图片"></section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">其他说明</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">漏洞成因分析：在处理“控制器名称”参数的流程中，C语言字符串以0x00表示结束符，如果在发送给PLC修改PLC工程名时不是用\x00结尾，导致程序无法正确读取PLC名称，从而导致PLC_Config无法写入正常工程。</section></td></tr></tbody></table>

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

_**5. PLC 名称型号标识等明文信息泄露**_

  

<table cellspacing="0" cellpadding="0" width="551"><tbody><tr style="height: 72px;"><td width="56" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题名称</section></td><td width="495" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;">PLC名称、型号、标识等明文信息泄露</section></td></tr><tr><td width="56" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">检测工具</section></td><td width="495" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">python</section></td></tr><tr style="height: 74px;"><td width="56" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题描述</section></td><td width="495" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;">通过发送特殊构造数据包，无需认证即可远程获取PLC类型等明文信息，包括<strong>控制器类型，控制器标识，控制器名称</strong>等。这使得该类型PLC容易被网络扫描发现。</section></td></tr><tr><td width="56" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">测试步骤描述</section></td><td width="495" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="text-align: left;margin-left: 8px;margin-right: 8px;">1、读取PLC信息向11000端口发送报文：0c00b593100049060000152700000000，返回响应报文如图第二行，可见明文指出了控制器类型为MAC1000，控制器标识0000000000000000158198301010001，控制器名称MAC1000 Programable Controller</section><section style="text-align: left;margin-left: 8px;margin-right: 8px;"><img data-ratio="0.13682092555331993" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK1DsHJXEGyxPkTmHaGb3w2XKHgUdqxhGRRzEz4LmMA1sBnfhsf646vQ/640?wx_fmt=png" data-type="png" data-w="994" height="50" width="361" _width="361px" class="img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 361px !important; height: 51.1187px !important;" crossorigin="anonymous" alt="图片"></section><section style="text-align: left;margin-left: 8px;margin-right: 8px;">2、与组态软件中显示信息一致。<img data-ratio="0.19824561403508772" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKgwVQCfPRo4ZkQ18Ix0JOnvkm6EgKMic5aNVicibuogMAA9ex9Kg35dHiaA/640?wx_fmt=png" data-type="png" data-w="1140" height="69" width="349" _width="349px" class="img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 349px !important; height: 70.7912px !important;" crossorigin="anonymous" alt="图片"></section><section style="margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img img_loading" data-ratio="0.4803921568627451" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKdoy1l0rE0jsTFrkpQKbRMrmWeRSJ339pKho8F303U3Clczd9YYnUow/640?wx_fmt=png" data-type="png" data-w="816" height="169" width="353" _width="353px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 353px !important; height: 170.618px !important;" crossorigin="anonymous" alt="图片"></section></td></tr><tr><td width="56" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">其他说明</section></td><td width="495" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br></td></tr></tbody></table>

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

_**6.  PLC 远程窃取当前运行程序**_

  

<table cellspacing="0" cellpadding="0" width="551"><tbody><tr style="height: 72px;"><td width="66" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题名称</section></td><td width="485" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;">PLC远程窃取当前运行组态程序</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">检测工具</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">Python wireshark</section></td></tr><tr style="height: 74px;"><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">问题描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;">无加密认证，攻击者可远程向PLC 11000端口发送特殊构造的数据包，可获取PLC当前运行的程序和注释等信息。</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">测试步骤描述</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;">1、向11000端口发包0c0063fb1000dd1b2627252700003101</section><section style="margin-left: 8px;margin-right: 8px;">2、收到返回报文中，包含了PLC程序和明文的代码注释信息，其中注释中的汉字经过了编码处理，例如汉字“为”对应十六进制字符‘ce aa’。解码后与软件中程序注释比较一致。</section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img img_loading" data-ratio="0.532345013477089" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK0E9CWNT7UzgYScicibKX6vOzwHM8awFP11BlIia1f3QjVpwic4tYtDfdMg/640?wx_fmt=png" data-type="png" data-w="742" height="129" width="242" _width="242px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 242px !important; height: 129.763px !important;" crossorigin="anonymous" alt="图片"></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;">3、使用wireshark抓取上位机软件上载工程流量包，手动构造报文远程发送，可获取编译完成的程序代码。</section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img img_loading" data-ratio="0.6605080831408776" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKjv1DU1iaQ6jceibHa3CtHnBrPKItkCy2LUeILty10C6RqAJL6QSHvMbw/640?wx_fmt=png" data-type="png" data-w="866" height="166" width="250" _width="250px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 250px !important; height: 165.806px !important;" crossorigin="anonymous" alt="图片"></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;">4、</section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img img_loading" data-ratio="0.66626936829559" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKj5wN7JBQGkCWQ3WMeVTWBSXZpEljSQp9nmp2XWichJzKmPuQxw5nHzg/640?wx_fmt=png" data-type="png" data-w="839" height="183" width="275" _width="275px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 275px !important; height: 183.892px !important;" crossorigin="anonymous" alt="图片"></section><p style="text-align:  center;">5、可得到16进制形式的报文，对应编译后的程序代码，进行逆向分析，可以得到出来组态程序代码。附图分别为原程序示意图2张及根据报文分析程序图3张。<img class="rich_pages wxw-img img_loading" data-ratio="0.667621776504298" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaK2h0cqGRKcbibTrHAKzz6pKw8bRC1Woicic7uyHyWia2omhZgUQVjwcibCaQ/640?wx_fmt=png" data-type="png" data-w="698" height="193" width="289" _width="289px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 289px !important; height: 193.607px !important;" crossorigin="anonymous" alt="图片"><img class="rich_pages wxw-img img_loading" data-ratio="0.6671597633136095" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKmc9qiaFRa2G7JxOkcyDnUV3B4Kegyd4teAAJpbrfsF96HSgdewz4ptA/640?wx_fmt=png" data-type="png" data-w="676" height="191" width="286" _width="286px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 286px !important; height: 191.473px !important;" crossorigin="anonymous" alt="图片"></p><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img img_loading" data-ratio="2.0375" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKb4y4W2iaRQiaYNiabvAiaj9lRibN84eBxoXhZDX9DP93XxxOOeIwscEbRsQ/640?wx_fmt=png" data-type="png" data-w="640" height="363" width="179" _width="179px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 179px !important; height: 362.637px !important;" crossorigin="anonymous" alt="图片"></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img img_loading" data-ratio="3.606060606060606" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKtvTrevnU2GrIzBcKLKgcCR4ibhCLsrjquIJDw6yUylsHkNjibVu2p54Q/640?wx_fmt=png" data-type="png" data-w="462" height="445" width="124" _width="124px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 124px !important; height: 441.939px !important;" crossorigin="anonymous" alt="图片"></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img img_loading" data-ratio="1.115606936416185" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnRxmjE46bBVrYJhteia87eiaKJltGyFqllAUJ8rfqoEqCcamAt245Eia1FKnH0voq3e4ez0SicQvfiapZg/640?wx_fmt=png" data-type="png" data-w="692" height="184" width="165" _width="165px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 165px !important; height: 183.844px !important;" crossorigin="anonymous" alt="图片"></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;">&nbsp;</section><section style="text-align: center;margin-left: 8px;margin-right: 8px;">6、根据逆向分析出的结果，我们可以对流量进行更改，从而能够编译任意梯形图语句表并下载到任意PLC中，破坏并覆盖其原有程序。</section></td></tr><tr><td width="66" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;">其他说明</section></td><td width="485" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br></td></tr></tbody></table>

感谢

阅读

 ![](http://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSZmibNONzibea8WkcAFcdQcXicIYgWuvOtR8HqlqJ68Avib679FBGHYqxRibldppr6etXJxxWRrlBToiaw/0?wx_fmt=png) ** 山石网科安全技术研究院 ** 山石网科安全技术研究院简称“山石安研院”正式成立于2020年4月，是山石网科的信息安全智库部门，山石安研院旗下包括干将、莫邪两大安全实验室，以及安全预警分析、高端攻防培训两支独立的技术团队。 316篇原创内容   公众号