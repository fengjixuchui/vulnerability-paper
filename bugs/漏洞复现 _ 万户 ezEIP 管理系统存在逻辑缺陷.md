<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/AdUiByefSerJE8YSyzWI2g)

  

点击上方蓝字关注我们

BEGINNING OF SPRING

![](https://mmbiz.qpic.cn/mmbiz_gif/z7icWibwNQicf1QCEcTzvGFkdLPgp832KCow54U64xGcfU3BoUqphwjsUoJic0EyTBMFAxEykWLnfeILAcZRtzLrdQ/640?wx_fmt=gif)

0x01

      阅读须知       

Reading Instructions

![](https://mmbiz.qpic.cn/mmbiz_png/X8pI8icoh79vrwCxdib7QSBb6QLSO3psbEiaXHfy8RZh13ic6m57LBtGhC60SdVIVRk7GmvkqiaibIriaHvgkORAia55lQ/640?wx_fmt=png)

    数字人才创研院秉承探究学习与交流的理念，一切从降低已有潜在威胁出发，所有发布的技术文章仅供参考，未经授权请勿利用文章中的技术内容对任何计算机系统进行入侵操作，否则对他人或单位而造成的直接或间接后果和损失，均由使用者本人负责。

    郑重声明：本文所提供的工具与思路仅用于学习与研究，禁止用于非法目的！

团队已致电客户说明并告知详细解决方案！  

![](https://mmbiz.qpic.cn/mmbiz_png/XQsIhMDyz0unrjh9QZibtE16IibicwafvgPDLKqCMhDFfddJIWIHR8FWuIjyib2OpS1LNz9VWTt0EBTwTHMpSibibvng/640?wx_fmt=png)

0x02

       漏洞概述      

Vulnerability Overview

  

  

  万户网络 ezEIP 企业网站信息管理系统是在服务 3000 多家品牌客户的经验基础上，总结提炼出的一套兼容各大主流浏览器的网站管理软件。ezEIP 能结合企业经营特点、产品和服务特性做快速定制性开发，拥有高扩展性，且自带网络营销及产品推广功能。

  万户 ezEIP 企业网站管理系统**存在逻辑缺陷漏洞**，攻击者通过漏洞可以获取任意用户密码，进而渗透服务器权限，导致服务器失陷。

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHRTfKwlWXMf3AbmFF2Ribh78LGMLGibvBknyQguGQVOr7f233L3CCFWZgG5obu2dicgoibb4nnibwEh0Mg/640?wx_fmt=png)

0x03

       漏洞复现      

Vulnerability Recurrence

![](https://mmbiz.qpic.cn/mmbiz_png/bDYS2PAYoqic9mQ5FnGia01eSuHGU1UPycSXqxrvp6ibBX9pQPGfK2AWibOef8ET2TJ8OCoaian4s8C6zgqyavG6ibPQ/640?wx_fmt=png)

fofa：header="X-Powered-By: ezEIP"

  

  

  

1. 访问系统中的用户注册页面，正常注册一个正常用户（注册的用户为模拟被未授权找回密码的用户，比如 admin 账户）。

```
http://xxxxxxx.com/shop/member/register.aspx

```

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHRTfKwlWXMf3AbmFF2Ribh78peT7Ijq1XwGJUicRMP1GR0mHD8Vk2ibibibhicwTU0VktyQS1jeNyibJFYcA/640?wx_fmt=png)

  

  

2. 再注册一个我们用来找回其他用户密码的账户 test666，此时的**邮箱一定要能正常接收与发送**，否则将会无法复现。

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHRTfKwlWXMf3AbmFF2Ribh78BcYTIYp0pnPHeE2SfrQPOK3blvrbzibJTDxiaAGAuVNtRWWBxFeD6YcA/640?wx_fmt=png)

  

  

3. 注册成功后，直接去找回刚才注册的 test666 用户密码即可，具体访问路径如下，然后模拟找回 admin 用户的账号密码，输入我们自己的账号 test666 以及验证码，抓包并释放，admin 的密码就被发送到你注册的真实邮箱中。：

```
http://xxxxxxx.com/shop/member/forgotpassword.aspx

```

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHRTfKwlWXMf3AbmFF2Ribh78nuMOomo9K9bv6lEq9b4sgxrea1CkWUEuRVDtjAJ7ZG3z00dahRRqLQ/640?wx_fmt=png)

  

  

4. 将 hdUserID 改为其他用户 ID（比如数字 3），就可以将其他用户的密码发送到你注册的用户的邮箱中，此时你的小心脏将会加速砰砰![](https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Lol.png)。

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHRTfKwlWXMf3AbmFF2Ribh78UTQpwSRPTchiaNTxMNxGzUoYQyOc3Rlyibpia9PbHcgf1g6HVzbQhZvDQ/640?wx_fmt=png)

0x04

     修复建议     

Repair Suggestions

  

  

1.  实施产品的权限访问控制，降低互联网搜索引擎的查询。
    
2.  加强后台认证要求（如 AAAA 策略等），提高口令的安全性。
    
3.  增强关键页面的安全性，提升 WEB 后台的安全访问控制权限能力。
    

  

  

END

![](https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaaBAicDNCSs6H0O0SBGSALfn3R3579I4bCLalicIr2ib0xY9ujssMRaUE3hGg4oW0QaiclhD6Vib8WY3Ig/640?wx_fmt=gif)