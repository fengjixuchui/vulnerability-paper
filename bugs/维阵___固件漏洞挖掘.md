<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/WBaH62Jy0akFTZ_QHwhhew)

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpicctyibDibVYcRFfKGYZCY90EwheFLjicRgE57csME7eaco2T7ru3Syw9A/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/wbFNMtoYNOstP6xybicugTfjwE5S1p9Kp6jZ9vg6VWfVsuF10GyawVB23paIRHsCUGOGZOBt64pqLXKTKJibic6yw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

**作者：维阵漏洞研究员--km1ng**

  

**一、概述**

维阵是国内首款AI自动化漏洞挖掘系统，提供对应用和软件包分析发现0day的在线服务。极光无限研发团队自研维阵创新内核，基于图神经网络，对二进制文件的程序流图（CFG）进行SaaS平台化漏洞挖掘分析，结合反汇编出来的代码或者脚本语言，识别出可疑的汇编代码序列，快速有效地发现未知漏洞。目前在线版本支持多类型文件格式检测，包括ELF、Linux软件包、IoT固件包、APK安装包。本文主要展示维阵对固件方面的漏洞挖掘。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpkTyC8WXoUJCK9PeD9uZLmKPXgaicN3RW4MlfysVR6Xvb9IVWicOPvSsQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**二、环境版本**

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpZKbGagvhntNZWonAQrhJrWAhRh4bekpQpt2bYqHpacgticWfGGGvOQQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**三、挖掘OWASP-IOTGoat** 

IOTGoat项目github链接：

https://github.com/OWASP/IoTGoat

  

**3.1.介绍**

IoTGoat 项目是一个基于OpenWrt的故意不安全的固件由OWASP维护，现使用维阵发掘其中存在的安全问题并验证。

  

**3.2.固件上传**

首先进行固件下载，链接：

https://github.com/OWASP/IoTGoat/releases/download/v1.0/IoTGoat-raspberry-pi2.img

  

使用binwalk-Me命令，解压使用上面链接下载的固件文件。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpViahlwFqlOGNktuTcVA6umU7pz14QBScQH0kXyZEI3lerlepL3zWgQg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

运行后会在固件同级目录创建_IoTGoat-raspberry-pi2.img.extracted目录。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpNic6kBa1wmZau4VicYGV0vvVo7xibSD9ytmXGWwp43BIUGu8B9pRPWp5A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

进入_IoTGoat-raspberry-pi2.img.extracted目录可以看到squashfs-root文件系统，将文件系统打包为zip压缩包。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9Kpqw1LTAVxAmCe026uc7ibn3UiaGwibnVeUVufNNom82jicVv134f00trdsg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

登录维阵的产品页面，如下图所示：

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KplDicgibHedpHicRIN1KKmEApBJriaAZaVJL7r5JpibiaOicGlpZ9YtViaLVRIg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

点击上传文件，选择刚才压缩的文件系统包，这里为IoTGoat.zip.然后选择iot类型，最后点击开始检测，即可开始自动化处理固件信息并完成分析。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpkPUcpQ4ia2Bfttxa5teGn04mXyqwIyRw7ygibvT22E9JicGDQDN5dMeJw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpXnL1RMHXsLiaeEOCprGsIiaVuUONNwEic2bZolFruwVGKAcKHdg0QhAvw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**3.3.固件仿真**

固件vmdk虚拟磁盘文件下载，链接：

https://github.com/OWASP/IoTGoat/releases/download/v1.0/IoTGoat-x86.vmdk

  

这里选择的是vmware安装虚拟机的方式模拟运行固件，这一步主要是为了验证漏洞，也可以使用一些固件模拟软件或者真实设备进行漏洞验证。

  

首先vmware点击文件新建虚拟机，选择自定义高级。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpRdEEnYTkUsNERQPSCJU3nZqpV6oToo9wbLRJEoADZ6xaVzuTViaV8icw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

默认下一步。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpDicl9Laic46V2TvK9EvAl0cVrwpb63f5N8WZ1l2W03T35OGbPwg8cr7A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

选择稍后安装操作系统，然后点击下一步。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KprkhxoCBFZEVBXBNnWCYQMwRZ1LxtE9icQ9w7wbyE9D5abiamIO4icMNrQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

这里客户机操作系统选择linux版本选择ubuntu64,然后点击下一步。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KprOqzUkj66iawCuUbibVfFbFt6Zsia6p22l2eD295wky8mvQnNg7gBq3zg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

填写虚拟机名称与安装路径，点击下一步。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpQTLR6x3zfUV6QHNOe0E8v7AvuGDoSs4q3cU980Ln6ZHvc6LFDU8nLA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

设置处理器，这里设置为两处理器。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9Kpn0nV83JFcqAiaP5Br5CPRr9hXtg4VEHxuDiagmjhwFXFqzGzAB8NBomw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

设置内存为4096Mb。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9Kp7nCMkfvwEDQU2A3Te5FfJFPMAU7LNBZCZhHagngxtspxmV393Siaiazw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

设置网络连接为网络地址转换。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpRlhkGXOqh163cuia1FFMrpz5duBs1wZpZynibv0vYxt9ZttKfLiaJfkyw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

使用默认设置。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9Kpia3xNbTUjPfxqxbYicIHXFf1DlkZSW0NvIkicPtvmrppmPyaVibMfs5wZw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

选择使用现有虚拟磁盘。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpiaUZKUnMqBOadcj4CgAHoa9cmcmAScFKnRoDiaS5j87OgLqzH0VshKaw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

选择磁盘文件，为上面下载的vmdk文件。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpnLicYw4ickUNhS9X14ibNhVuUHRMTRBG4r08dISHMwNmXA42jhCuYnfibw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

这里选择保存现有格式。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KptqqiaE5VylJkLFE7icUzV8xeTlXySuOm6YabwcQgJlfTK2sXPQW3QXtw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

点击完成。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpWdwEWGFdGYqr5KZ2kRELSBDh3UhwT79DcTiaMjMUceJ2NQShnSlcVAg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

如下图所示虚拟机正常运行。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用ifconfig > ip，然后使用vi ip查看ip地址信息。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpyJcmIA5lJ4vx9bwIFWGUl2kDg3gvd40OgCnr7BIibEz5BTRHs0JnZLQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

使用浏览器能够正常访问如上图所示网址即为正常运行。

  

使用passwd root命令更改root密码，更改之后即可使用ssh连接。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpIiahjiaqWs4KkjNNuvJAZV19tvecvtnONb9S3v0KvqHskd9t7RiaxKiclg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

固件仿真环境搭建成功。

  

**3.4.漏洞挖掘**

**3.4.1.弱加密密码**

维阵分析完成之后点击查看结果。  

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KprxK9qqlNwwgvejdibNV6wpINUyozkEU5EhumfAlgSbHaibjO5egylQTA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

进入总览概况页面，里面存在文件信息、敏感信息、缓解措施选项。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

点击敏感信息，可以看到里面存在证书、敏感文件、敏感账号、服务、工具选项。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpUfiaXnJO67ibvwaGMjENq0JiatLpWtqRSnZt4oT6vwq29icZgBnSFwdzGg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

首先查看敏感账号，在其第48页查看到有/squashfs-root/etc/shadow。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpYs6OG7DjlfX1bqRhNXc2AsfEtdMaDKUfvmOhCFc1GqMlRHJ0b6nzAQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

进入解开的固件包中的文件系统，查看/etc目录确实存在shadow文件。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpR7l1XchO1j5AKOtNl29wmrmDedelqnBeHW5J1CsZ3T6uWDiacNN9V2Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

查看固件中/etc/shadow文件保存的信息。

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KpMdGDH4w8dM5DkJPpgvUCZsQibiajmxg4BRXKWqm6agR0U5lD9VDbxdkQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

加密密码格式：**$id$salt$encrypted**，id为1时表示采用md5进行加密，id为5时，表示采用SHA256进行加密，id为6时，表示SHA512进行加密，该固件使用的加密方式为md5加密。

  

使用以下命令创建password.txt（用于破解的文件）。

```
`git clone git://github.com/danielmiessler/SecLists.git``cd Malware``awk '{print $2}' mirai-botnet.txt > /home/test/Desktop/password.txt`
```

  

将password.txt 拷贝到kali，使用如下命令爆破：

```
hydra -l iotgoatuser -P password.txt ssh://192.168.112.172
```

![图片](https://mmbiz.qpic.cn/mmbiz_png/wbFNMtoYNOstP6xybicugTfjwE5S1p9KphXmQpcYKxZpiaVh5dtB5eAA9ic88yzKjISMeQ9j9lFgyPx1h5O6aYbtA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

上图IP地址为之前搭建的固件环境ip。  

  

可以根据上面爆破的密码，使用ssh登录固件。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**视频演示**

 已关注  关注  重播  分享   赞    _切换到竖屏全屏__退出全屏_极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)[](javascript:;)分享视频，时长01:25

0/0

00:00/01:25 切换到横屏模式 继续播放进度条，百分之0[播放](javascript:;)00:00/01:2501:25_全屏_

倍速播放中 [0.5倍](javascript:;) [0.75倍](javascript:;) [1.0倍](javascript:;) [1.5倍](javascript:;) [2.0倍](javascript:;) [超清](javascript:;) [高清](javascript:;) [流畅](javascript:;) <video src="http://mpvideo.qpic.cn/0b2eneaacaaammadfs7bdfqva2odafuqaaia.f10002.mp4?dis_k=982026aae713a4a9f19adcfeab1dc938&dis_t=1654222964&vid=wxv_2223926472736571395&format_id=10002&support_redirect=0&mmversion=false" control></video>

继续观看

维阵 | 固件漏洞挖掘

转载,维阵 | 固件漏洞挖掘极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)

[视频详情](javascript:;)

**3.4.2.web命令注入**

继续向后查看维阵的敏感信息页面，发现有很多的lua脚本。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

搜寻lua脚本所在目录，在其中找到了iotgoat.lua文件，发现在其中可以执行系统命令。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用web浏览器访问https://192.168.112.172/cgi-bin/luci，使用root：root进行登录web界面。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

在向Web地址栏输入 https://192.168.112.172/cgi-bin/luci/admin/iotgoat/webcmd?cmd=uname%20-a，可以发现输入的命令已被执行如下图所示。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**视频演示**

 已关注  关注  重播  分享   赞    _切换到竖屏全屏__退出全屏_极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)[](javascript:;)分享视频，时长00:45

0/0

00:00/00:45 切换到横屏模式 继续播放进度条，百分之0[播放](javascript:;)00:00/00:4500:45_全屏_

倍速播放中 [0.5倍](javascript:;) [0.75倍](javascript:;) [1.0倍](javascript:;) [1.5倍](javascript:;) [2.0倍](javascript:;) [超清](javascript:;) [高清](javascript:;) [流畅](javascript:;) <video src="http://mpvideo.qpic.cn/0bc3keaaoaaa2yadldhbd5qvauoda5iqabya.f10002.mp4?dis_k=87885bd4fc168772db3a9faf7e9f4cd7&dis_t=1654222964&vid=wxv_2223924274904498185&format_id=10002&support_redirect=0&mmversion=false" control></video>

继续观看

维阵 | 固件漏洞挖掘

转载,维阵 | 固件漏洞挖掘极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)

[视频详情](javascript:;)

**3.4.3.程序后门**

查看维阵的文件系统模块，在其中的etc/init.d/找到了一个很可疑的shellback文件。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用 netstat -antp 查看进程。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

查看shellback文件。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用IDA分析/usr/bin/shellback，如下图所示：

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用nc连接，如下图所示成功连接，代表这是一个后门漏洞。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**视频演示**

 已关注  关注  重播  分享   赞    _切换到竖屏全屏__退出全屏_极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)[](javascript:;)分享视频，时长00:59

0/0

00:00/00:59 切换到横屏模式 继续播放进度条，百分之0[播放](javascript:;)00:00/00:5900:59_全屏_

倍速播放中 [0.5倍](javascript:;) [0.75倍](javascript:;) [1.0倍](javascript:;) [1.5倍](javascript:;) [2.0倍](javascript:;) [超清](javascript:;) [高清](javascript:;) [流畅](javascript:;) <video src="http://mpvideo.qpic.cn/0b2elyaaeaaax4adathbxjqvaxwdajpaaaqa.f10002.mp4?dis_k=2366960d60d0dc5ef117cbecebf4cc1c&dis_t=1654222964&vid=wxv_2223925778277269511&format_id=10002&support_redirect=0&mmversion=false" control></video>

继续观看

维阵 | 固件漏洞挖掘

转载,维阵 | 固件漏洞挖掘极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)

[视频详情](javascript:;)

  

**3.4.4.不安全固件更新**

在维阵文件信息模块中发现usr/lib/lua/luci/view/admin_system/flashops.htm文件。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用浏览器查看是否能访问到这个文件，是可以正常访问并在其中找到固件升级功能。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用文本编辑工具查看此文件并分析后续流程，没有对文件系统及关键文件进行签名，攻击者可以任意修改固件，达到植入后门的目的，这里并无真实物理机不进行固件更新操作。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**3.4.5.组件漏洞**

**3.4.5.1. wget ssl证书校验缺失**

查看维阵敏感信息模块的工具页面，里面存在有固件中使用的组件信息。这些组件中很有可能存在漏洞可以进行利用。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

如上图所示，去虚拟机中查看Busybox的版本。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

去cve官网查看是否有符合此版本漏洞进行利用。（图中展示的是CVE-2018-1000500漏洞利用。）

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

如下图所示固件中的wget命令并没有进行ssl校验。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**视频演示**

 已关注  关注  重播  分享   赞    _切换到竖屏全屏__退出全屏_极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)[](javascript:;)分享视频，时长01:21

0/0

00:00/01:21 切换到横屏模式 继续播放进度条，百分之0[播放](javascript:;)00:00/01:2101:21_全屏_

倍速播放中 [0.5倍](javascript:;) [0.75倍](javascript:;) [1.0倍](javascript:;) [1.5倍](javascript:;) [2.0倍](javascript:;) [超清](javascript:;) [高清](javascript:;) [流畅](javascript:;) <video src="http://mpvideo.qpic.cn/0b2esiaaeaaavuaddihbxjqvbewdakjaaaqa.f10002.mp4?dis_k=524d65084d52ed6d8e786d4c49de245f&dis_t=1654222964&vid=wxv_2223927367348060166&format_id=10002&support_redirect=0&mmversion=false" control></video>

继续观看

维阵 | 固件漏洞挖掘

转载,维阵 | 固件漏洞挖掘极光无限已关注分享点赞在看已同步到看一看[写下你的评论](javascript:;)

[视频详情](javascript:;)

  

**3.4.5.2.dnsmasq 缓冲区溢出漏洞**

维阵的漏洞分析页面，里面给出了有可能存在漏洞的地址与所属文件，如下图所示dnsmasq组件中就被AI检测模块检测出可能存在漏洞。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

如上图所示dnsmasq中有很多可能存在漏洞的地址，首先在虚拟机中使用dnsmasq -v查看程序版本为2.73。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

在cve官网搜索dnsmasq，发现存在不少漏洞，经过分析有不少可以与上面维阵给出的信息互相对应。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**四、总结**

维阵在检测IOT固件包的时候可以解析文件目录、敏感信息、缓解措施，在漏洞分析页面给出有可能存在漏洞的地址信息与对应的文件路径，是一款非常全面的漏洞挖掘工具。

  

**维阵服务**

维阵官网预约演示通道持续开放中，欢迎各大企业、软件厂商对软件产品进行安全性评估咨询。

  

服务模式包含：SaaS平台部署、专家包年服务、独立部署，从软件开发源头避免安全隐患，让维阵为您服务。

  

**官网通道: https://vul.secwx.com**

**商务邮箱: business@secwx.com**

  

**往期精选**

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=MzkyNTEwMTUzMA==&mid=2247493637&idx=1&sn=581008102437cde24d412cf9b36a23cc&chksm=c1c914b0f6be9da6493cf08d35dbdcb668cf8267cb0d39e579432cfd1db814af87e7ba64d0d9&scene=21#wechat_redirect)

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=MzkyNTEwMTUzMA==&mid=2247493497&idx=1&sn=8e8312fef5a74cf88c6448abd0d49bea&chksm=c1c91bccf6be92dae332b6c3ae5a24c3d6322e32fb189857b1759ae800bf3885483683f7b624&scene=21#wechat_redirect)

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=MzkyNTEwMTUzMA==&mid=2247493504&idx=1&sn=2bb639bd1f57cd6da96b8ec7ccb4bb24&chksm=c1c91b35f6be922355b721173060d6e204f6335dab5cdcb8ae82f818d750cac852aeb328aa02&scene=21#wechat_redirect)

  

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=MzkyNTEwMTUzMA==&mid=2247493976&idx=1&sn=308432964db7de0e751d247d0cfca299&chksm=c1c915edf6be9cfb9ad30c843748b5995b59ddef847a26ffc95ea1818182eb5e182f0500d698&scene=21#wechat_redirect)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)