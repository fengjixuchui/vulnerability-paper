> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Lm3LqrOamlaKxBX0vOc3CA)

前言

首发在知识星球, 没想到有这么多表哥来交流。

1

最近遇到海康多一点，但是无法直接进后台。

发现很多 js 会存在泄漏 key 和 secret

可以直接访问到摄像头。

不止一次遇到。

1

![](https://mmbiz.qpic.cn/sz_mmbiz_png/MzKvKJKNPPfx0FXibr61KMx5ZHfJtWDaxStnDKKpqjuFia0fjHu6NP1GzYNsxG24yibcAlVfWBqXKkmoodVibUnCAg/640?wx_fmt=png)

js 发现

![](https://mmbiz.qpic.cn/mmbiz_png/aukmFcvZ9rXV8YRH9BRtg6YwuMJtjWXmAtibU0egYvVevOCoEcjl5zJjbjjPAMaIGR1CYmIKe4XTeQS56DcsLRA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/eycUesMAvEaf49NVG3GOdGWKvgMVibNymv72yQHZGaIEncgEx8RbictXxTpUyJpCHCCKrBd8NA2H2bicItyq4zcag/640?wx_fmt=png)

进行 js 多次查看发现存在 jsconfig 的调用。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISIEIKtxMplfDm6icd9iaPbCUia2FJd40ktRoXySKicYLjTWIaHDiaibh6j7YA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISFQKGhd89Oictx5ZzG1GeH9kxKHW4hCiaYlKH28cSUhyC83bW1xNRrmfw/640?wx_fmt=png)

又比如 burp 中某一个 js 请求包。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISmecn8GGAoWzETDmW8YrYFsuc32kXC7l4IRNxm8z7gnj7U0Pk5sDdoQ/640?wx_fmt=png)

上述都泄漏了 appkey 和 Secret,

有的叫法可能也是 User 或者 Passwd 大同小异

appkey 就是 user 由一个 8 位数数构成: 23412412

Secret 就是 passwd，由 21 位的密钥构成: QfQPss5GOac9Bjxkfuv3

和阿里云 / 企业微信的 Token——Secret 泄漏一样, 都可以进行 api 调用。

这里可以直接访问到所有摄像头  

2

![](https://mmbiz.qpic.cn/sz_mmbiz_png/MzKvKJKNPPfx0FXibr61KMx5ZHfJtWDaxStnDKKpqjuFia0fjHu6NP1GzYNsxG24yibcAlVfWBqXKkmoodVibUnCAg/640?wx_fmt=png)

利用过程

![](https://mmbiz.qpic.cn/mmbiz_png/aukmFcvZ9rXV8YRH9BRtg6YwuMJtjWXmAtibU0egYvVevOCoEcjl5zJjbjjPAMaIGR1CYmIKe4XTeQS56DcsLRA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/eycUesMAvEaf49NVG3GOdGWKvgMVibNymv72yQHZGaIEncgEx8RbictXxTpUyJpCHCCKrBd8NA2H2bicItyq4zcag/640?wx_fmt=png)

官方提供 api 接口文档

```
https://open.hikvision.com/docs/docId?productId=5c67f1e2f05948198c909700&version=%2Ff95e951cefc54578b523d1738f65f0a1&curNodeId=16741aecc05944a6b0cd1341d68e4546
```

1./api/resource/v2/encodeDevice/search 接口, 获取权限的编码设备列表

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISJMibtF9hbMlYP8sLOdwsBIooqwTRmRcicq1qCohvAOaz9awCb8Ikkh4Q/640?wx_fmt=png)

2./api/resource/v1/cameras 获取 cameraIndexCode  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXIStTBWFRaneJAI5cHkpViaXF3rmXKkPdF6BwP8rHfpsgDiczbrA8BekKhg/640?wx_fmt=png)

3./api/video/v1/manualCapture 带 cameraIndexCode 去获取摄像头的 Picurl

```
{
"cameraIndexCode":id号,
  "pageNo": 1,
  "pageSize": 1000
}
```

3. 会获取如下图的 picUrl, 直接访问就是摄像头的画面

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISibE419M21OFe9Z12roQonz3UtTIOcIIbctK3Iv8hzvCT9Nv421TH6Eg/640?wx_fmt=png)

3

![](https://mmbiz.qpic.cn/sz_mmbiz_png/MzKvKJKNPPfx0FXibr61KMx5ZHfJtWDaxStnDKKpqjuFia0fjHu6NP1GzYNsxG24yibcAlVfWBqXKkmoodVibUnCAg/640?wx_fmt=png)

另一种方法

![](https://mmbiz.qpic.cn/mmbiz_png/aukmFcvZ9rXV8YRH9BRtg6YwuMJtjWXmAtibU0egYvVevOCoEcjl5zJjbjjPAMaIGR1CYmIKe4XTeQS56DcsLRA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/eycUesMAvEaf49NVG3GOdGWKvgMVibNymv72yQHZGaIEncgEx8RbictXxTpUyJpCHCCKrBd8NA2H2bicItyq4zcag/640?wx_fmt=png)

利用 rtsp 协议去访问

利用 / api/video/v2/cameras/previewURLs 接口 。获取获取 rtsp 协议摄像

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISiaATLM9nicfLPUoy7rfuV1ibEemSCdojqiaKvzUoNVg7uhgyXl5Hg3OvFw/640?wx_fmt=png)

这里借助借助 VLC media player 播放去访问 rtsp 协议摄像头

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISntqc1FWhL42nxibPUvo8QW0sSZG8QTo87Whicy18ynPvo3xaibUA8KVZA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/PZCtvaaOQSmT2IPRNVJzSuibhZdL9aXISiaASzDib3LFLgOiaMXbclpC1ica3tsc9EsVqicqf2icY2ZPW4YZSib22ACxDA/640?wx_fmt=png)

  

往期推荐

  

  

[

记一次拿图书馆小姐姐微信的全过程



](http://mp.weixin.qq.com/s?__biz=MzkwMzMwODg2Mw==&mid=2247491221&idx=1&sn=642758d8fb144b1be1d5f401da7a37c6&chksm=c0996dc5f7eee4d30e462915634d459973265651dd5ece3010d341017104a7ef93d05d2ceab5&scene=21#wechat_redirect)

[

《网络￥安全联盟站》星球周报



](http://mp.weixin.qq.com/s?__biz=MzkwMzMwODg2Mw==&mid=2247491212&idx=2&sn=a0d137affabbcf83d9a68478f775c621&chksm=c0996ddcf7eee4ca7b9b3ffae10796f48aefc44904f791e726199c27409a8c04221342b81a00&scene=21#wechat_redirect)

[

一次渗透从弱口令 ->docker 逃逸



](http://mp.weixin.qq.com/s?__biz=MzkwMzMwODg2Mw==&mid=2247491196&idx=1&sn=e824883197558fd41b528c0378183dae&chksm=c0996d2cf7eee43a891557a162a6ab3f214e000f1ee2534a65bc9bb7b627900a1f45bdbe0492&scene=21#wechat_redirect)

### 网络￥安全联盟站

【**网络￥安全联盟站**】成立于 2021 年，高质量网络运维与安全攻防领域星球，致力于路由交换、云计算、存储、网络实战运维、web 安全、APP 安全、内网安全、红蓝安全攻防等资料分享，每日分享行业最新资讯和前沿学习资料，星球中已发布 1000 + 网络运维和安全攻防等资源，针对网络和安全学习成员的普遍水平，并为星友提供了视频教程、工具、最新漏洞 POC、EXP 等等，循序渐进的方式引导广大网络从业者转型为安全技术人员，加深技术学习提高以及岗位内推等等。

![](https://mmbiz.qpic.cn/mmbiz_jpg/XoIcX2HtlUAN4oj9lyh9OESImGzeOwWQY83EZX7p2d3AUIWdG3DrvMAiayaibAgUn8h3mNBBic8ia0iciaWKVet0nO3A/640?wx_fmt=jpeg)