<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/qS41JckO-VioYYJ28sVKaw)

**![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3MmaYz8UWHicLDSC4e3NqcibOLicCiaYtmQm9A0Ied3OLs4Wibj6bLz8jmf0gB3k0h1aQNNVKNqjKFcZV0Mg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)**
----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Part1

漏洞状态

<table interlaced="enabled" data-sort="sortDisabled"><tbody><tr><td valign="top" align="center" width="38">漏洞细节<br></td><td valign="top" align="center" width="45">漏洞 POC<br></td><td valign="top" align="center" width="60">漏洞 EXP<br></td><td valign="top" align="center" width="38">在野利用<br></td></tr><tr><td valign="top" align="center" width="58">有</td><td valign="top" align="center" width="65">有</td><td valign="top" align="center" width="60">无</td><td valign="top" align="center" width="58">未知</td></tr></tbody></table>

Part2

漏洞描述

<table interlaced="enabled"><tbody><tr><td valign="middle" align="center" width="111.66666666666667">‍漏洞名称<br></td><td valign="middle" align="left" width="448"><p>&nbsp;&nbsp;某路由器密码重置漏洞</p></td></tr><tr><td valign="middle" align="center" width="111.66666666666667">CVE 编号</td><td valign="top" width="448">CVE-2023-26615</td></tr><tr><td valign="middle" align="center" colspan="1" rowspan="1" width="18">漏洞类型<br></td><td valign="middle" align="left" colspan="1" rowspan="1" width="448"><section>逻辑漏洞<br></section></td></tr><tr><td valign="middle" align="center" colspan="1" rowspan="1" width="111.66666666666667">漏洞等级</td><td valign="middle" align="left" colspan="1" rowspan="1" width="448">未知</td></tr><tr><td valign="middle" align="center" colspan="1" rowspan="1" width="111.66666666666667">公开状态</td><td valign="middle" align="left" colspan="1" rowspan="1" width="448">nvd 发布日期 2023-06-28<br></td></tr></tbody></table>

Part3

漏洞验证

### **1.** **验证环境**

系统版本：Kali 2022.4

### **2.** **验证过程**

修改 WEB 管理密码

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1viaJSpZQYu2jNuF4Po5WEIPGiajMZtvfSZyaKyWZ5qIfYqmIky9eUyevQ/640?wx_fmt=png)

使用 BurpSuite 发送 PoC

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vBteZL9Yibo9Rb9ezcXadMmOMVMygwdADfLKvUsBPodbEBgRUia95PtIQ/640?wx_fmt=png)

随后可以通过空密码登录

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vbq9mcYsAxLZ8vJ5uN2mkyw37SHyYHia8vCicuMzEGRSawkXDQpmmiaVCQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vicnIyMYbbWojh2rVY2KRSYHfJ202wWjjjKJI1S4wSU7ZECV1PcrSlTw/640?wx_fmt=png)

Part4

漏洞分析

请求处理函数 sub_4339E8 使用 for 循环检测传入的 XML 数据，满足条件时调用 dword_58AA80 + 4，其 dword_58AA80 初始值为地址 off_589200。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1v0QXMeJkibjkeN3z47OlZXiaxqSn7fpXq6vknygpSUh9dJQ6avCYkhJMw/640?wx_fmt=png)

查看 off_589200 处数据，发现了 SetPasswdSettings 字段，其后面跟着一个函数地址。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1v1iaPVQK6pJa6NBzA0uILGFVddJdGOqDUtiaTmMedYzgpO1g6VgXdT0fg/640?wx_fmt=png)

分析 sub_43D518 函数函数，发现其 32 行获取了修改的密码，随后在 38 行调用 sub_45B320 函数进行解密。当 sub_45B320 执行成功，且原始密码长度小于 0x40，则会在 41 行设置密码。当 sub_45B320 执行失败时，则在 53 行设置一个密码。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vLWkgmKib92gvkSQicdbg5zSmBibgK7PTdZ2tkyUsNTBRPcfBiaE895EYBg/640?wx_fmt=png)

查看 dword_4A7540，发现其值是硬编码的 00，这意味着当 sub_45B320 函数调用失败时，则会置为空密码。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1v33u0sVRibC7HHEnNMfsK0weoTsm33ohH5gILcLRtL51Bhuk6oDqxWPQ/640?wx_fmt=png)

查看 sub_45B320 函数，其 29 行调用 sub_425ED0 函数进行解密，并在 30 行检测 byte_58ADEC 是否为 0，为 0 则继续循环。当循环 20 次后则通过 16 行代码跳出循环，返回结果 0。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vaIZQVq8SV3XkueTpZ3AIqcluCbjSibdenLVdMy4QQ1uylbvLsibVIHOw/640?wx_fmt=png)

sub_425ED0 函数第 30 行调用 sub_425CB0 函数将密码写入到 v11，然后在 31 和 32 行将密码写入 sub_45B320 函数提供的缓冲区内。但 14 行代码首先将 v11 数组初始化为了 0，因此如果 sub_425ED0 函数没有操作 v11 数组，则写出的数据也将是 0。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vRxqp9AfqvHCa19WadNoSSVnEdJB9M2NfafY2hULTcVWrALCiaoQkIXg/640?wx_fmt=png)

sub_425CB0 函数 18 行调用了 sub_425830 函数检测密码格式，当返回结果为 0 时，将不处理加密密码。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vMRt9JDLn97hfBLdJWVUrNNXPDdMa8IpH4TgDmjILRNSNK1regwNVtg/640?wx_fmt=png)

sub_425830 函数第 10 行代码获取加密密码的长度，并在 11 行检测密码长度是否为奇数，如果为奇数则退出函数，并返回结果 0。

![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vrYKlpA2wz1ydpFL8G6RGQYHQfVYCpreiapYiadqiaD8dTS2AlzNS70ufw/640?wx_fmt=png)

因此当加密密码的长度为奇数时，sub_425830 函数返回 0，从而导致 sub_425CB0 函数不会进行解密操作，此时 sub_425ED0 函数的 v11 数组将为 0，并写入到 sub_45B320 函数提供的缓冲区内。sub_45B320 函数判断 byte_58ADEC 缓冲区首字节为 0，则继续执行循环，直至 i 为 20，跳出循环，并返回结果 0。当 sub_43D518 函数 36 行代码检测 sub_45B320 执行失败后，则使用空字符串设置登录密码。

 **![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmaolAkPsicNuzDOok8n4xXZIczeyb9icH1wWwdibvVxEQqY0znTbqgES8yD0bHynSX6ADlHCoBrYtqaA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)** **获取更多情报**

  

联系我们，获取更多漏洞情报详情及处置建议，让企业远离漏洞威胁。  
电话：18511745601

邮箱：shiliangang@andisec.com

**漏洞分析回顾**  
![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3MmYrt8sZBqiah8aNInQspzccnPAAhd0OKLQ5Ziad4ovQEohiamyrpYjQcwVAWROpYWmMXia1YRKPiczFSQw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vW30n1mR8GDrzNLHg8G7D49pc1YTXUg9rvCjqgrT7rww16XJJ6ZomxA/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247546778&idx=1&sn=96054f3ebf298aa7cd783d8d6c617de6&chksm=fd76ddcdca0154db9107e7eb301b94fdf95211e5048009a2948d20e2f0b1cdae1a39c8487b90&scene=21#wechat_redirect)[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vKB9dtSGkibDiansbYC1qBabCfDKFldpblyDNgSqiavSyJMOkLalI3jc9g/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247546298&idx=1&sn=661e071b4bedd729573ed35814d6c701&chksm=fd76dfedca0156fb4fe1d3eb7bec5382fa3c927da8acbca4bc27910b27119738a1493ea0fbc2&scene=21#wechat_redirect)[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1vYleQoJdIgH98mZbYLaCl9Yy9rQsPTua7Qv6y3L1kkpVIHd6icHJWQmA/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247545941&idx=1&sn=e1214819fc692fe4214ff8f9d4886145&chksm=fd76de02ca01571455845b00e92535a5f958b9dd1ee0529a462dbb2a1090cc73b2e8dedf54b0&scene=21#wechat_redirect)[![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmZXqdjee2MQEVqnKPkibEg1v6u2YcqiaIic2los1CoWRCudyYs1eurlzbuiaHJjZ7xLKS9hjNgWSjEhug/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247545350&idx=1&sn=5ef4dd1168ae52996d339a4fec81c745&chksm=fd76d851ca0151474d2d508b9dfb712a40bd3e5ab6542406d458837bf21e1aef3e4c1beb1929&scene=21#wechat_redirect)

  

北京安帝科技有限公司是新兴的工业网络安全能力供应商，专注于网络化、数字化、智能化背景下的工业网络安全技术、产品、服务的创新研究和实践探索，基于网络空间行为学理论及工业网络系统安全工程方法，围绕工业网络控制系统构建预防、识别、检测、保护、响应、恢复等核心能力优势，为电力、水利、石油石化、轨道交通、烟草、钢铁冶金、智能制造、矿业等关键信息基础设施行业提供安全产品、服务和综合解决方案。坚持 IT 安全与 OT 安全融合发展，坚持产品体系的自主可控，全面赋能客户构建 “业务应用紧耦合、用户行为强相关、安全风险自适应、网络弹性稳增强” 的主动防御和纵深防御相结合的安全保障体系。

![](https://mmbiz.qpic.cn/mmbiz_gif/ll2PVky3Mma4ibTfp7sC3ibt8WmetoDfiaGHEb7VOiaemeFbuCTupYgus7NTKkibwKwpsEDfzqZdXh1skHff6A6VNgA/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

**点击 “在看” 鼓励一下吧**

**![](https://mmbiz.qpic.cn/mmbiz_png/ll2PVky3MmZOFFgf4oTyfUTx7y0ZBV9yIg8qmaSwAvbjiba2KQn7VgmXYIriagc9H0hMu1u0UIZr98JYSmyG9tibg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)**