<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/6i2XEsrXoaQH3OFk3-QW6A)

**版本**

Ladon>=9.1.2  

  

**模块  
**

DraytekPoc  检测指定IP或URL是否存在CVE-2020-8515漏洞

DraytekPoc  无txt密码字典时，仅检测Draytek路由默认密码

DraytekExp  CVE-2020-8515漏洞命令执行EXP

  

**用法  
**

```
`Example: Ladon 192.168.1.8 DraytekPoc``Example: Ladon 192.168.1.8/24 DraytekPoc``Example: Ladon http://k8gege.org DraytekPoc``Example: Ladon ip24.txt DraytekPoc``Example: Ladon url.txt DraytekPoc``Example: Ladon cidr.txt DraytekPoc`
```

PS：目标为IP（IP或批量C段）时检测80、443、8080、8181端口，已确认目标URL可指定URL，以减少对4个端口的探测浪费时间。

  

**漏洞描述**

DrayTek URI未能正确处理SHELL字符，远程攻击者可以利用该漏洞提交特殊的请求，可以ROOT权限执行任意命令。远程命令注入漏洞被标记为CVE-2020-8515，主要影响了DrayTek Vigor网络设备，包括企业交换机、路由器、负载均衡器和VPN网关。

PS: 该漏洞公开已快2年，但实战中还是能遇到一些机器  

  

**影响范围**

```
`Vigor2960 < v1.5.1``Vigor300B < v1.5.1``Vigor3900 < v1.5.1``VigorSwitch20P2121 <= v2.3.2``VigorSwitch20G1280 <= v2.3.2``VigorSwitch20P1280 <= v2.3.2``VigorSwitch20G2280 <= v2.3.2``VigorSwitch20P2280 <= v2.3.2`
```

**漏洞检测**  

Poc检测指定URL是否存在CVE-2020-8515漏洞以及探测路由器版本，存在漏洞会返回漏洞编号，默认执行id命令。  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**密码审计**

用法和SshScan、SmbScan检测密码一样，该模块区别在于不指定密码字典时检测Draytek默认密码，想要速度快检测默认密码即可。除非说目标真的很重要，可以只跑特定URL的帐密。  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**Exploit**

使用Exp模块示例为uname -a查看系统版本，其它命令和Linux差不多，但可能很多命令执行不了。一是系统不存在，二是由于该漏洞的限制，部分存在的命令也执行不了。  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

深入利用后续有空的话再写，本文先简单说一下，拿到密码后，登陆路由器开启代理，再使用Ladon渗透内网即可，如使用Ladon noping 192.168.1.1/24 ms17010 t=8 探测17010快速拿下内网机器。对于没有密码，路由器getshell后从路由开socks代理，同样方法内渗即可，如果拿不下内网机器，也可专门用于代理上网（相信大家也遇到不少站点，只允许特定区域IP访问）。  

**默认密码**  

```
`http://www.draytek.com.cn/support/FaqcontentShow.php?article_id=220``初始用户名密码/默认用户名密码：``VigorFly 200默认用户名密码 admin/admin``VigorFly 210默认用户名密码 admin/admin``Vigor 2110默认用户名密码 admin/admin``Vigor 2120默认用户名密码 admin/admin``Vigor 2910默认用户名密码 admin/admin``Vigor 2912默认用户名密码 admin/admin``Vigor 2920默认用户名密码 admin/admin``Vigor 2922默认用户名密码 admin/admin``Vigor 2925默认用户名密码 admin/admin``Vigor 2930默认用户名密码 admin/admin``Vigor 2950默认用户名密码 admin/admin``Vigor 2955默认用户名密码 admin/admin``Vigor 2960默认用户名密码 admin/admin``Vigor 3900默认用户名密码 admin/admin``Vigor 3300默认用户名密码 draytek/1234``https://www.draytek.co.uk/support/guides/kb-defaultpassword``Vigor 120     admin     <blank>``Vigor 130` `admin     admin``VigorNIC 132     admin     admin``Vigor 2760 Series (Linux & DrayOS)` `admin     admin``Vigor 2762 Series     admin     admin``Vigor 2832 Series     admin     admin``Vigor 2860 Series     admin     admin``Vigor 2862 Series     admin     admin``Vigor 2925 Series     admin     admin``Vigor 2926 Series     admin     admin``Vigor 2952     admin     admin``Vigor 2960     admin     admin``Vigor 3220     admin     admin``Vigor 3900     admin     admin``VigorBX2000 Series     admin     admin``VigorAP 710     admin     admin``VigorAP 810     admin     admin``VigorAP 902     admin     admin``VigorAP 903     admin     admin``VigorAP 910C     admin     admin``VigorSwitch P1100     admin     admin``VigorSwitch P2261` `admin     admin``VigorSwitch G2260` `admin     admin``VigorSwitch G1241     admin     admin``Older DrayTek Products``Model` `Username` `Password``Vigor 100, 110     admin     <blank>``Vigor 2110 Series` `admin     admin``Vigor 2130 Series     admin     admin``Vigor 2600 Series` `admin     <blank>``Vigor 2700 Series     admin     <blank>``Vigor 2710 Series` `admin     admin``Vigor 2750 Series` `admin     admin``Vigor 2800 Series     admin     <blank>``Vigor 2820 Series (3.3.5.1+)     admin     admin``Vigor 2820 Series (before 3.3.5.1)     admin     <blank>``Vigor 2830 Series` `admin     admin``Vigor 2850 Series` `admin     admin``Vigor 2900 Series` `admin     <blank>``Vigor 2910 Series` `admin     <blank>``Vigor 2920 Series` `admin     admin``Vigor 2930 Series     admin     <blank>``Vigor 2950, 2955     admin     <blank>``Vigor 3200     admin     admin``Vigor 3300     draytek     1234``Vigor 3300Vplus     draytek     1234``VigorPro 5510     admin     admin``VigorAP 700``Serial numbers 095670000001 to 112670000025` `admin     admin``VigorAP 700``Serial number 114670000001 and later` `admin     1234``VigorAP 800     admin     admin``VigorAP 900     admin     admin``VigorIPPBX 2820 Series     admin     <blank>``VigorIPPBX 3510     admin     <blank>``VigorPhone 350     admin     admin``VigorPro 5510     admin     <blank>``VigorSwitch P2260     admin     admin``VigorSwitch G2240     admin     admin``VigorSwitch G1240     admin     admin``VigorSwitch G1260     admin     admin``https://www.cleancss.com/router-default/DRAYTEK``Model     IP Address     Username     Password``2800         none     none``2920n` `V2920N` `VIGOR         admin     admin``Vigor 120` `Vigor 120     192.168.1.1     none     none``Vigor 2110     192.168.1.1     admin     admin``Vigor 2130         admin     admin``Vigor 2130n         admin     admin``Vigor 2130Vn     192.168.1.1     admin     admin``Vigor 2132F         admin     admin``Vigor 2132FVn         admin     admin``Vigor 2200 USB         admin     none``Vigor 2200E         none     none``Vigor 2200USB     192.168.1.1` `Vigor 2200USB     192.168.1.1     none     none``Vigor 2500     192.168.1.1     admin     admin``Vigor 2500         none     none``Vigor 2500V     192.168.1.1     admin     admin``Vigor 2500V         admin     none``Vigor 2600         admin     (none)``VIGOR 2600         admin     none``Vigor 2600 Plus Series Annex A         admin     none``#     Username     Password``1    admin    admin``2    (blank)    (blank)``3    admin    (blank)``4    'blank'     'blank'``5    draytek    1234``6    ''blank''    (blank)``7    draytek    (blank)``8        admin`
```