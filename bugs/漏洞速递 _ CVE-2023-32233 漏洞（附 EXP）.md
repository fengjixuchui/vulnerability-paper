<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/f5Ua7jdb3gC4TWB9eO-3Qw)

**0x01 前言**

Linux Netfilter 是一个在 Linux 内核中的网络数据包处理框架，也称作 iptables，它可以通过各种规则和过滤器，基于数据包的来源、目标地址、协议类型、端口号等信息，控制网络流量和数据包的转发和处理，是 Linux 系统网络安全性和可靠性的重要组成部分

**0x02 漏洞描述**  

Linux 内核的 Netfilter 子系统在处理批量请求更新 nf_tables 配置信息时，由于处理匿名集的逻辑存在缺陷，存在释放重利用（UAF）漏洞。利用该漏洞可实现对内核内存的任意读写，具有 CAP_NET_ADMIN 权限的本地用户可利用该漏洞提升其权限至 ROOT 级别

**0x03 影响版本**  

```
Linux Kernel <= v6.3.1

```

**0x04 修复方案**  

```
官方已发布补丁修复了此漏洞。
https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c1592a89942e9678f7d9c8030efa777c0d57edab

```

**0x05 参考**  

```
https://www.openwall.com/lists/oss-security/2023/05/15/5
exploit: 
https://www.openwall.com/lists/oss-security/2023/05/15/5/3

```

注意：一旦在易受攻击的系统上启动了 PoC（概念验证），该系统可能会处于不稳定状态，并且内核内存可能被破坏。我们强烈建议在专用系统上测试 PoC，以避免可能的数据损坏。

```
EXP地址: 
https://github.com/Liuk3r/CVE-2023-32233
poc作者为Piotr Krysiuk，在使用前请先阅读README.md

```

![](https://mmbiz.qpic.cn/mmbiz_gif/shVkAyu04IEW5J2EpTK5b0fPkrXgcIbdBKGv4TuKa9J39XgnR47f0ibrf0je6wn9yyB6I6xfQCicG0ER4GYKEypQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

**文章来源：EchoSec**