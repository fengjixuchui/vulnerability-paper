<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/w69N8siC17AivkCazcJB2g)

![](https://mmbiz.qpic.cn/mmbiz_png/US10Gcd0tQHDte6ZzXiclrYUTCQHiak0k38kaD0O6NSfpyrRicr2rspyQicXCp6I4iagSbNbaKt2IiboYfRyUpnDZrtQ/640?wx_fmt=png)

本环境是蛇矛实验室基于 "火天网演攻防演训靶场" 进行搭建，通过火天网演中的环境构建模块，可以灵活的对目标网络进行设计和配置，并且可以快速进行场景搭建和复现验证工作。火天网演中，内置大量固件设备，包含大型网络设备及物联网设备，可以灵活选取进行测试验证。

![](https://mmbiz.qpic.cn/mmbiz_png/US10Gcd0tQHDte6ZzXiclrYUTCQHiak0k38kaD0O6NSfpyrRicr2rspyQicXCp6I4iagSbNbaKt2IiboYfRyUpnDZrtQ/640?wx_fmt=png)

  

  

![](https://mmbiz.qpic.cn/mmbiz_gif/wPnzTpdoDPrGXFX9ml3Sr0nzMVTJZQ097OSjLMsRQnrWYaZ5feh5HpNgUqQ7D6vF3kUUArCDnTt0opiceMbo1Cg/640?wx_fmt=gif)

![](https://mmbiz.qpic.cn/mmbiz_png/WhJmjZC42nabEOaBuVseRZEianL1UHpzYGrb8zaibYcKGHZYvDic3noFsv7biaFp31wEqXfiacWOUKiaJ8pib9TnhsFBA/640?wx_fmt=png)

背景

![](https://mmbiz.qpic.cn/mmbiz_png/wYsnyKj8LwfPJGxuIZGzA4WAA8nURnKibeVYH6CnYIOeBTRE6j1nIoof9RicouRbBf8rqaJ4icseT90tHeNpCibYEg/640?wx_fmt=png)

2022 年 11 月 16 日，F5 官方公布了 F5 BIG-IP 和 BIG-IQ 设备中的多个安全漏洞。其中高危漏洞（CVE-2022-41622，CVSS 评分 8.8）是 iControl SOAP 跨站点请求伪造，可允许未经身份验证的远程代码执行攻击。高危漏洞（CVE-2022-41800，CVSS 评分 8.7）为 iControl REST 远程代码执行漏洞，允许经过身份验证的管理员用户通过 RPM 注入执行任意代码。

![](https://mmbiz.qpic.cn/mmbiz_png/fOFibflaHhKKYCSBlTHDkpgG9WCzEO2e57DFWic0CGxVvw6sK67FzIPRMDCloU7dQzEzAeazcYy9dreAbG0cP1qg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicvqZricWhnkUZOoaoBgXomNowcYGRtDDLZicUl5ia8rSuu9ExZj8PNrx9A/640?wx_fmt=png)

    受 CVE-2022-41622 影响的版本为：

```
BIG-IP:17.0.0BIG-IP:16.1.0-16.1.3BIG-IP:15.1.0-15.1.8BIG-IP:14.1.0-14.1.5BIG-IP:13.1.0-13.1.5BIG-IQ:8.0.0-8.2.0BIG-IQ:7.1.0
```

    受 CVE-2022-41800 影响的版本为：

```
BIG-IP:17.0.0BIG-IP:16.1.0-16.1.3BIG-IP:15.1.0-15.1.8BIG-IP:14.1.0-14.1.5BIG-IP:13.1.0-13.1.5
```

![](https://mmbiz.qpic.cn/mmbiz_png/wYsnyKj8LwfPJGxuIZGzA4WAA8nURnKibeVYH6CnYIOeBTRE6j1nIoof9RicouRbBf8rqaJ4icseT90tHeNpCibYEg/640?wx_fmt=png)

BIG-IP 设备默认有俩个用户 (终端用户和 web 用户)，在配置设备信息时由于系统对 web 端用户的密码没有什么严格要求 (如必须数字、字母组合、特殊符号等等)，可能会导致攻击者可以爆破出 web 端用户密码，加上今年 5 月刚爆出的 CVE-2022-1388 未授权绕过漏洞几乎为同型号设备，这就使得俩个 web 用户导致的 pre-auth 漏洞很容易被利用。

![](https://mmbiz.qpic.cn/mmbiz_png/fOFibflaHhKKYCSBlTHDkpgG9WCzEO2e57DFWic0CGxVvw6sK67FzIPRMDCloU7dQzEzAeazcYy9dreAbG0cP1qg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_gif/wPnzTpdoDPrGXFX9ml3Sr0nzMVTJZQ097OSjLMsRQnrWYaZ5feh5HpNgUqQ7D6vF3kUUArCDnTt0opiceMbo1Cg/640?wx_fmt=gif)

![](https://mmbiz.qpic.cn/mmbiz_png/WhJmjZC42nabEOaBuVseRZEianL1UHpzYGrb8zaibYcKGHZYvDic3noFsv7biaFp31wEqXfiacWOUKiaJ8pib9TnhsFBA/640?wx_fmt=png)

环境搭建

    本小节使用的漏洞环境固件为 BIG-IP，漏洞版本号为 16.1.0。在靶场中调用 BIG-IP 后，BIG-IP 会自动分配出 mgmt 口的 IP 地址。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicibnkr2za4X5dpuzLbN5vIbWuOM1HkvPcxRee9RYqmRckyL6icibJo5chg/640?wx_fmt=png)

    在浏览器端使用 (admin/admin) 登录后，如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicP3Qu8TONRQ0pjbvSsv28MFGWC0a3ojNovfj5p9qC9DpPx3USicK1ZFw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_gif/wPnzTpdoDPrGXFX9ml3Sr0nzMVTJZQ097OSjLMsRQnrWYaZ5feh5HpNgUqQ7D6vF3kUUArCDnTt0opiceMbo1Cg/640?wx_fmt=gif)

![](https://mmbiz.qpic.cn/mmbiz_png/WhJmjZC42nabEOaBuVseRZEianL1UHpzYGrb8zaibYcKGHZYvDic3noFsv7biaFp31wEqXfiacWOUKiaJ8pib9TnhsFBA/640?wx_fmt=png)

漏洞分析

![](https://mmbiz.qpic.cn/mmbiz_png/wYsnyKj8LwfPJGxuIZGzA4WAA8nURnKibeVYH6CnYIOeBTRE6j1nIoof9RicouRbBf8rqaJ4icseT90tHeNpCibYEg/640?wx_fmt=png)

BIG-IP 的管理模式有多种，包括 web 页面，tmsh 命令行，rest api，以及 soap api。soap api 数据交换格式为 soap/xml。rest api 数据交换格式使用 http/json。soap api 为比较旧的技术，在版本 11.6 中已经放弃维护，目前支持正常使用，rest api 目前官方一直在推荐用户使用和开发。cve-2022-41622 为 csrf 漏洞，漏洞本身危害不大，但是由于在漏洞利用过程中可以使用 soap api 接口进行操作从而 rce。cve-2022-41800 为 iControl rest 容易受到 rpm 注入攻击导致 rce。

![](https://mmbiz.qpic.cn/mmbiz_png/fOFibflaHhKKYCSBlTHDkpgG9WCzEO2e57DFWic0CGxVvw6sK67FzIPRMDCloU7dQzEzAeazcYy9dreAbG0cP1qg/640?wx_fmt=png)

明白了漏洞利用的方法，下面我们开始分析。进入 BIG-IP 终端，BIG-IP 默认开启 ssh 服务，我们可以使用 "scp -r root@ip:/* ./" 命令将 BIG-IP 的所有文件拷贝到本地进行分析。BIG-IP 中程序运行的 httpd 服务为 apache

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVichyGzFtoBe9gDZIrbQOWuOicicmAemuQbeH2xcK6E05hXxeDgs6e26fQA/640?wx_fmt=png)

CVE-2022-41800

    我们在 "etc" 目录简单查看一下，在 "init.d" 目录下发现了 httpd 启动服务的 httpd 脚本，脚本注明为 apache server 并且配置文件的位置为 "/etc/httpd/conf/httpd.conf"。  

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicCHWfSlFlLpDYaJRAFlcstNWJPUeibm5q6hAtSTtiaCmIOYfgUGeM2Bqg/640?wx_fmt=png)

    查看一下配置文件，我们发现 httpd 接受请求，并将请求转发到不同端口的服务上完成对应的处理。下图中 AuthPAM 开启，说明调用了 httpd 的某个 ".so" 文件进行预先的认证，并且将所有向 /mgmt 发送的请求都转发到了 "http://localhost:8100/mgmt/"。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVic7Zib41YsNCicGcesEav8ZiaRc0U1Ijn4CmukvWF3oNwBuKw1ibvyWlxyvw/640?wx_fmt=png)

    在 16.1.0 的官方文档中，简单翻阅我们得知所有 REST API 的 uri 中都是含有 "mgmt" 的。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicEccPib53h8ITANjCjcAaWK18fpzziaibibKbjPmo4SHj5FkxbeArpc6VIg/640?wx_fmt=png)

    查看一下 8100 端口的服务，发现有 java 服务在监听

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicJDr7ic3OIyr8ric8dCKwDhG1jgkF0c6tsrMwUcicI8YuoOghNZkibz7WWg/640?wx_fmt=png)

    查看一下 pid 信息，发现 java 的 "-classpath" 参数后为 "usr/share/java/rest" 和 "usr/share/java/rest/libs" 目录下的所有 jar 包，且 "--port" 参数为 8100。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicWYN1tbnickwaItfYt3S9opruVgYFrGib6WTcDpVzibaw0GpiaMjyUfxAFg/640?wx_fmt=png)

    如果要动态调试 java 程序，我们可以修改 "etc/bigstart/scripts/restjavad"，在 jvm_options 后附加 "-agentlib:jdwp=transport=dt_socket,address=1043,server=y,suspend=n" 选项，并且使用 Idea 配置好 ip、port 后进行远程调试。

    注意：防火墙默认策略为禁止，动态调试需要放行调试端口

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVictCnyKLSaYofwLWaEUC0nGCrznjfX91qJ3Tp5seicfiafWOI3IIvuRPbA/640?wx_fmt=png)

    RestServerServlet 是整个 iControle REST 的入口，在其 "service" 方法中 "RestServerServlet" 异步执行，注册了一个 "ReadListener"。而且会在处理请求时，为每一个请求创建了一个 "RestOperation"，并且后续处理将以回调的方式执行。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicdfiaGO93c26Od9HDZvGWQGIv7BVoibNdCdBMv3UwIsd74MvrkOicC8zJA/640?wx_fmt=png)

    这里会检测请求中是否包含相关认证，并将其设置到 "RestOperation" 中。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicGNQEzgwIK4S7FuP6WD4SjDhqic4hPgnD3gNBE5lfVccEVDINaPGEXicQ/640?wx_fmt=png)

调用 setIdentityFromBasicAuth 方法后，并且 basic 认证的 value 不为空便会进入 setIdentityData，在比较 userName 和 userReference 都不为空时，最后在 completeEvaluatePermission 中比较完成后完成身份认证过程。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicR8xOKQ6PV2lpZ4PT1HgCDNEVnxTKRf7fQrjTNLUJhBb6KTOz8bicHXw/640?wx_fmt=png)

    随后 "trySendInProcess" 中会根据请求端口来寻找相关的 "RestWorker" 。在 findWorker() 方法中，将以请求路径为查询条件，匹配 RestServer 的 pathToWarkerMap 。之后便会执行 worker.onRequest() 方法，将 worker 添加到 RestServer.readyWorkerSet 中。后面会以该 Set 为消费者队列，并执行各个 worker。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVic2iaYuRNT6jkcPBMZq9nq0LxlpuwoaQ1CxL4fQla8YTO3CIfJX6q0Whg/640?wx_fmt=png)

    "RestServer" 中主要工作是维护队列，并执行相关的 worker。入口点为其构造方法：

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicQibgzlZ86UtQLrFIKBBibtZpO7ODliaGicnzCicicLn8bCWR6sWwAZPacl8g/640?wx_fmt=png)

    processQueueRequests 后面运行到 "callDerivedRestMethod" 方法，这里便会调用对应 worker 的处理方法并完成对应的链调用。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVic3wibScNF1NEqcbC6a14wtQibpZt3X1yGcohCh81EGibt9ecD5k21o4f0w/640?wx_fmt=png)

    在官方文档中，有开发编写 worker 的例子，流程如下，在 worker 中我们发现 WORKER_URI_PATH 为 uri 中 / mgmt/" 后面的的地址。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicPAKMJmiaP0C3kD38CsDhLlwHqWeddtMHpDmy1w6oAfWZiahcWqerD74Q/640?wx_fmt=png)

    根据 "WORKER_URI_PATH" 字符串，我们可以简单搜索一下系统中的 worker，结果如下图所示。这里 WORKER_URI_PATH 为 "shared/iapp/rpm-spec-creator" 就是生成 spec 文件的 worker

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicE97Vtpv0KylhoV1ibWrqoNq8kWjibEViak1TpLR6rHjVcspkoBD75JzgQ/640?wx_fmt=png)

    打开 "iAppRpmSpecFileCreatorWorker.js"worker 的文件，发现加载了 "../infrastructure/specFileCreator" 模块，并使用 SpecWriter 变量调用，随后 new 了一个 specWriter

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKViclHITibHticct7ao2b5PJjrXYIQB6wNBibWpsCCwEEHdn0mKMGk7WPZ5eQ/640?wx_fmt=png)

    java 中的 onPost 方法传进来的 restOperation，先 getBody 获取内容，并且调用_validate 进行判断，随后使用 specWriter.render 进行格式化，最后调用 getFs().writeFile 生成 ".spec" 文件

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicKwNTDbcRfQecleUbMDTprBPsRbicJHHRVOxcHibXlpF0rQw2HdbDLQpQ/640?wx_fmt=png)

    生成 spec 文件的名字如下。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicc81kmlpPbK9PcaQdZtdnJ7qDlPEc6lYStgoT4AcBueCj71kIU7qpgQ/640?wx_fmt=png)

    _validate 对传进来的内容进行判断，如判断 body 是否为空，header 是否存在 "application/json"，取出 specFileData 的 json 内容并进行判断，判断是否有 name、summary、version、release、description、srcBasePath 字符等等。这里便是漏洞点，漏洞成因便是没有对用户传来的 json 数据进行判断，导致攻击者可以通过 "\n" 特殊字符进行绕过。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicpwtTrg76x0TbCyrrEUQYKJwAsUPEAUW9zp1k805hEQVyEicg58n7oYg/640?wx_fmt=png)

    在进行格式化时，使用 specFileCreator.js 模块。这里使用了 doT.js 模板，模板 path 为 "./resources"。doT.js 灵感来源于搜寻基于 V8 和 Node.js ，强调性能，最快速最简洁的 JavaScript 模板函数。它在 Node.js 和浏览器两端都彰显出卓越的性能。下图中 specFileData 调用 specTemplate 格式化 json 数据

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicbYPhRqQsxrRgNK0ibuPKLKOdx7qH16dFpW8KawVjBb8WpBWeOjSic4uQ/640?wx_fmt=png)

    doT.js 模板如下，当攻击者传来的数据 "description" 后面跟着 "\n" 是，spec 文件就变得攻击者可控，可随意添加恶意数据，如调用 "%check\n'command'" 执行系统命令。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicwKqlwLmpSEH342051lq3N35HK98ibr787OTicxf1FttMz6ia7T9td2VEQ/640?wx_fmt=png)

    当我们再次通过 rest api 进行 build-package 时，就会执行 spec 文件中的恶意命令

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicFNooIhppSgic7NMq9rf9aakrmy3tdB3zo29YDCQibhiaqm15fCGzIIQHQ/640?wx_fmt=png)

CVE-2022-41622

    CVE-2022-41622 为 CSRF 漏洞，CSRF 漏洞的成因是网站的已认证通过信息在浏览器中一段时间内不会过期，以后只要是访问这个网站，会默认用你已经通过的认证信息来进行，所以不用再次登录。如果攻击者发送了构造好的 CSRF 脚本或包含 CSRF 脚本的链接，管理者点击后可能会执行恶意操作（比如是添加账号、获取信息等）。

    漏洞程序为 "/iControl/iControlPortal.cgi"，并且该程序为 suid 权限。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicuFe46F71d7REfU5dWic9CqHlWHq5Vsq7MTJiaERAxyg2FQHTk7ibiaQQ6g/640?wx_fmt=png)

    csrf 漏洞本身的成因比较简单，没有对 Content-Type 以及 Referer 进行验证，以及 Token 机制不完善。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicSynNXKvoSL7TezVjc2YS8jdPZm7dUnRLRhwN5fib3LFibRhThmfwzTCg/640?wx_fmt=png)

    下面说一下漏洞利用。在前面我们已经分析了 CVE-2022-41800 漏洞，这里的 CVE-2022-41622 与前面的利用过程类似，这里只不过是利用 soap api 进行发送 soap 请求。当我们在 http 中用 soap 方式发送 xml 数据去调用一个服务时，我们只知道通用的 http 协议的传参方式还是不够的，我们仍然需要知道目标服务的接口文档。在 soap 中每个服务都有的接口文档就是一个用 wsdl 规范编写的 wsdl 文档，当程序接收到 soap 请求后根据 wsdl 文档进行解析执行。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVic24eT3zRTBAI20mc2rKLtSCkJkEuMiaDDsmF5HibRnCM8Ihxe6TsDTr9A/640?wx_fmt=png)

    下图为添加用户请求的 wsdl 文件为 "Management.UserManagement.wsdl"

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicyZcLaXA9KOnglOzdyM5qoURAzNqZQtwMS2yspFiaYfIMjRgK1Jm81nw/640?wx_fmt=png)

    这样我们在 pre-auth 的情况下就可以发送创建用户的请求来创建用户，当然我们也可以构造其他的请求（如上传文件）

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicwiciboUthibLqCVz6rHkaj3s19xWKToFQJbwgjWzushj2tRickvwndNYSg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_gif/wPnzTpdoDPrGXFX9ml3Sr0nzMVTJZQ097OSjLMsRQnrWYaZ5feh5HpNgUqQ7D6vF3kUUArCDnTt0opiceMbo1Cg/640?wx_fmt=gif)

![](https://mmbiz.qpic.cn/mmbiz_png/WhJmjZC42nabEOaBuVseRZEianL1UHpzYGrb8zaibYcKGHZYvDic3noFsv7biaFp31wEqXfiacWOUKiaJ8pib9TnhsFBA/640?wx_fmt=png)

漏洞复现

CVE-2022-41800

    使用 rest api 调用 rpm-spec-creator 创建 spec 文件并查看。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVic76ZKYDQKZP9uQnhdQGRCG4BTjuUZtsoGesrfic2ECdEHANz8CM0G8icg/640?wx_fmt=png)

    使用 "nc -lvp 4444" 命令监听 4444 端口

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicT9YX1unibDvUjIS00zMUVsb51htOUicicohX6WuzXL5cFenZpicAXhNQQw/640?wx_fmt=png)

    使用 rest api 调用 build-package 构建 package 包裹。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVico8EB4Wb20rHpxLLcicfs9nqScotRGmD3iaFFrzg9wnPicTN6Pj6hmNOeg/640?wx_fmt=png)

    此时已经获到 shell，并且是 root 权限。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicHDxV9jl08ia1pISfKfsXApWg3ic8Qhic9b750kSLzcEDe5pumaYsylRCg/640?wx_fmt=png)

CVE-2022-41622

    将 csrf.html 目录使用 python 启动 http 服务  

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicbSjPSzac37I4w2CJRcofrCnpwywmBhWRDqdglvsTRaV6j3Jt5dgkJg/640?wx_fmt=png)

    假设管理员使用账号密码登录 BIG-IP web 管理页面，此时点击了我们启动 http 服务的链接，链接自动跳转到 "https://192.168.141.152/iControl/iControlportal.cgi" 并提交 soap 请求

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicgLycGCcJs1ia2VAOjJ0ia1H13rpvy5GGHKQHdOXp0twnM0DAXiaQHxV8A/640?wx_fmt=png)

    用户已经添加成功

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVicLONWEJXFkjEleyoHMQchKX2ENbcC9hK3T5Hzzq3bd0iaAYOvYYhdfUw/640?wx_fmt=png)

    使用我们设置好的用户名和密码进行登录。

![](https://mmbiz.qpic.cn/mmbiz_png/WGegAIkTRic9OdC0eBERtOhzPib5NNXKVic0YbbSwENJXcg1Q4HVPdjH5jsOQ7EjadRtkibdbBomoibcI8hYgdRBicwg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_gif/wPnzTpdoDPrGXFX9ml3Sr0nzMVTJZQ097OSjLMsRQnrWYaZ5feh5HpNgUqQ7D6vF3kUUArCDnTt0opiceMbo1Cg/640?wx_fmt=gif)

![](https://mmbiz.qpic.cn/mmbiz_png/WhJmjZC42nabEOaBuVseRZEianL1UHpzYGrb8zaibYcKGHZYvDic3noFsv7biaFp31wEqXfiacWOUKiaJ8pib9TnhsFBA/640?wx_fmt=png)

总结

![](https://mmbiz.qpic.cn/mmbiz_png/US10Gcd0tQHDte6ZzXiclrYUTCQHiak0k38kaD0O6NSfpyrRicr2rspyQicXCp6I4iagSbNbaKt2IiboYfRyUpnDZrtQ/640?wx_fmt=png)

这一小节，我们简单分析了 F5 设备的俩个 pre-auth 漏洞，了解了 rpm 注入和 csrf 漏洞产生原因。并且在此过程中我们简单学习 F5 设备中 soap 接口和 rest 接口的区别以及利用。

![](https://mmbiz.qpic.cn/mmbiz_png/US10Gcd0tQHDte6ZzXiclrYUTCQHiak0k38kaD0O6NSfpyrRicr2rspyQicXCp6I4iagSbNbaKt2IiboYfRyUpnDZrtQ/640?wx_fmt=png)

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/wYsnyKj8LwfPJGxuIZGzA4WAA8nURnKibeVYH6CnYIOeBTRE6j1nIoof9RicouRbBf8rqaJ4icseT90tHeNpCibYEg/640?wx_fmt=png)

蛇矛实验室成立于 2020 年，致力于安全研究、攻防解决方案、靶场对标场景仿真复现及技战法设计与输出等相关方向。团队核心成员均由从事安全行业 10 余年经验的安全专家组成，团队目前成员涉及红蓝对抗、渗透测试、逆向破解、病毒分析、工控安全以及免杀等相关领域。

![](https://mmbiz.qpic.cn/mmbiz_png/fOFibflaHhKKYCSBlTHDkpgG9WCzEO2e57DFWic0CGxVvw6sK67FzIPRMDCloU7dQzEzAeazcYy9dreAbG0cP1qg/640?wx_fmt=png)