<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/GtwmudZRIuod2Waa5JATaQ)

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/SE49V9dKJrzCbaIINpuJ2vrAdmpYibFiaDIJpTQ9pHy14kWjt3yRb0XliaVhRxHcPA6icBu8AS9vbcVjWdibjIZ63ag/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

戟星安全实验室  

  

    忆享科技旗下高端的网络安全攻防服务团队.安服内容包括渗透测试、代码审计、应急响应、漏洞研究、威胁情报、安全运维、攻防演练等

  

本文约1000字，阅读约需4分钟。

  

  

---

0x00  前言

![图片](https://mmbiz.qpic.cn/mmbiz_png/F5fjqXxeV4BpyqyFY96joAs95uctK5C40icC7GfefCs1Unjrp7ZaVd90g37d8gDNic1qgtwTFLM9V2ydbH8Zvwdg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

工作之余挖掘某厂专属SRC，对目标指定域名范围进行子域名收集、端口探活、服务识别，筛选脆弱性资产，进行漏洞挖掘，发现存在未授权influxdb数据库任意命令执行。

  

---

0x01  什么是influxdb

![图片](https://mmbiz.qpic.cn/mmbiz_png/F5fjqXxeV4BpyqyFY96joAs95uctK5C40icC7GfefCs1Unjrp7ZaVd90g37d8gDNic1qgtwTFLM9V2ydbH8Zvwdg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

InfluxDB是一个由InfluxData开发的开源时序型数据。它由Go写成，着力于高性能地查询与存储时序型数据。InfluxDB被广泛应用于存储系统的监控数据，IoT行业的实时数据等场景。

influxdb提供WEB服务进行数据库操作

![图片](https://mmbiz.qpic.cn/mmbiz_png/SE49V9dKJrzCbaIINpuJ2vrAdmpYibFiaDJoGZKDTfSxD9qhqJNogCMvfAokelm9WzetbmOgnsMofGxkFictQVSpQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

cpu series 存储了timestamp、name、cpu使用率百分比

![图片](https://mmbiz.qpic.cn/mmbiz_png/SE49V9dKJrzCbaIINpuJ2vrAdmpYibFiaDYWP74gsKvPYaDlRyWhy4qQ4UXyBetoMHGFEs9KYrST28BbJ2LSd0Dw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

  

---

0x02  什么是grafana

![图片](https://mmbiz.qpic.cn/mmbiz_png/F5fjqXxeV4BpyqyFY96joAs95uctK5C40icC7GfefCs1Unjrp7ZaVd90g37d8gDNic1qgtwTFLM9V2ydbH8Zvwdg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

grafana一般是和一些时间序列数据库进行配合来展示数据的，例如：Graphite、OpenTSDB、InfluxDB等。grafana是用于可视化大型测量数据的开源程序，他提供了强大和优雅的方式去创建、共享、浏览数据。

  

通过配置grafana与influxdb的数据调用，达到可视化监控（demo）

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

---

0x03  未授权influxdb数据库任意命令执行

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

---

在文章的开始，有介绍到influxdb提供web接口对数据库进行操作，这里作者使用ffuf对目标批量检测，发现某个平台存在未授权influxdb数据库任意命令执行。

```
./ffuf -w~/Downloads/target.txt -u FUZZ/query\?q=show%20databases -t 10 -mr"internal"
```

使用ffuf对目标批量请求，并匹配出响应中存在internal的目标。

  

ffuf fuzz

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

show database

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

show series for db

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

---

0x04  总结

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

在挖掘SRC的道路上，很多师傅的操作都不同寻常，或多或少会有不同领域知识面带来的影响，使得在漏洞挖掘方面有一定技巧。除传统漏洞挖掘，知识面也决定了漏洞挖掘的广度。

  

  

  

 声明

    由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，破军安全实验室及文章作者不为此承担任何责任。

    破军安全实验室拥有对此文章的修改和解释权。如欲转载或传播此文章，必须保证此文章的完整性，包括版权声明等全部内容。未经破军安全实验室允许，不得任意修改或者增减此文章内容，不得以任何方式将其用于商业目的。

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

破军安全实验室

# 长按二维码 关注我们 #