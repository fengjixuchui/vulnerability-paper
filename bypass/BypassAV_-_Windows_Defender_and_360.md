<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/wLV3OuuMci4WdO8O_eUIxA)

0x01 前言
=======

在`Github`发现一个免杀项目`@EVA2`![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqE92dVXXv2QkvSUwb9ffNjkUxEJw5dXG8n1J5P0DwUV7uYEkg3hx2n8g/640?wx_fmt=png)  

#### First thing:

*   Dont Upload to virus total. this note is for you and not for me. if you wanna keep this code effective, and u want to use it to bypass windows defender
    
*   `DONT UPLOAD IT TO VIRUS TOTAL OR ANY OTHER WEBSITE LIKE IT`
    

#### Features:

*   anti debugging tech
    
*   encoded shellcode
    
*   decryption & injection of the shellode happens in the memory [byte by byte] and thus, less chance to get detected
    
*   using syscalls
    

#### **REQUIREMENTS:**  

*   Visual Studio 2019
    
*   Cobalt Strike
    
*   Python3 for the encoder
    

#### USAGE:

*   load this profile:`googledrive_getonly.profile` in CobaltStrike
    
*   create your shellcode [use https] (x64 `x86 wont work`) using cobalt-strike [check my cobalt-wipe repo]
    
*   place your shellcode inside `encoder.py` [preferably change the keys] and run it using python3
    
*   after `encoder.py` output your encrypted shellcode copy and paste it inside `EVA.cpp`
    
*   if u want to inject to another process uncomment `line 45` not recommended tho
    
*   build the code using visual studio 2019 - Release - x64 `x86 wont work`
    

项目地址:`https://github.com/ORCA666/EVA2`

*   ###### 测试时间: 2021 年 8 月 31 日 Bypass Def & 360
    

0x02 Load Profile
=================

启动`Teamserver`来加载`googledrive_getonly.profile`

```
./teamserver 服务器IP 密码 googledrive_getonly.profile
```

![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqE1318KaX0EXcgPGmf3XVK1LtZW9TicqezdDrhqGFImzuF5c2TvXouSew/640?wx_fmt=png)

0x03 Encode Shellcode
=====================

启动我们的 CS，生成一个 shellcode 后将它放入`encoder.py`进行加密

##### 记住！一定 x64

![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqEnFRzHsmJVnWt12DtAUfy5zPArTP3vhLfvgbChWibPMjd5c8RfnFsEYA/640?wx_fmt=png)

##### Attacks ->Packages ->Payload Generator ->`Output:Veli`

*   环境:`Python3.X`
    

将生成的 shellcode 写入`raw_data = "shellcode"`当中, 然后运行![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqEibGR4Tg3OnV7wrgoLa01jqfmxia9WHpnQowkRP1liaWEObPzEbtAcOa7g/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqEyLmCKABMyxxUooAOiaml8tJ3icVXPtkY04WA6vH8LeKGicicubBlyx0kOA/640?wx_fmt=png)运行后就可以得到新的`加密后的shellcode`

0x04 EVA.cpp
============

打开`Bypass_AV.sln`将加密后的 shellcode 写入到`const char shellcode[] = ""`![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqEHXvSZJvaYFDXjXX9NcMMFlpjfiaHI3rIHZ7DWYjUWettUBTmMLWic3qA/640?wx_fmt=png)运行项目生成`Bypass_AV.exe`跳转到路径生成路径，然后使用`cmd.exe`运行![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqEF4QwNOeKV2pMXSPojNf4gdllYWlmz8CVum4SjkiatqntSFROX85cjWw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqE8ZxqDVZsicp9rpbM8vDNnLh8JWFI4TcopJhVGBwMQvfSduXFepJF7Pw/640?wx_fmt=png)

0x05 Bypass_AV 效果图
==================

![](https://mmbiz.qpic.cn/mmbiz_jpg/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqE97howArcQ8eMa47ONWWOxz6AYUVibjgWjdSLl53HwISDIbtlBvYfz1A/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_png/icefLCXrhxfhs6NFT9xsWK5oXLiciaYRIqEPicELngCibP1f3QJwIjGEU70dzXxqZa3d3TQTuL54uZibhZa5vAzAPTpw/640?wx_fmt=png)

0x06 EVA2 - DEMO
================

_退出全屏_ _切换到竖屏全屏_ 阿乐你好 关注 已关注 分享 点赞 在看 已同步到看一看[写下你的想法](javascript:;) [](javascript:;)分享视频 视频卡顿，建议切换到自动 [立即切换](javascript:;) 已成功切换至自动模式 ，时长 01:13

0 / 0

00:00 / 01:13 继续播放 转载 , BypassAV - Windows Defender & 360 阿乐你好 关注 已关注 分享 点赞 在看 已同步到看一看[写下你的想法](javascript:;)  进度条，百分之 0  [播放](javascript:;) 00:00/01:13 01:13 _全屏_  倍速播放中 [ 0.5 倍 ](javascript:;)[ 0.75 倍 ](javascript:;)[ 1.0 倍 ](javascript:;)[ 1.5 倍 ](javascript:;)[ 2.0 倍 ](javascript:;) [ 超清 ](javascript:;)[ 高清 ](javascript:;)[ 流畅 ](javascript:;) <video src="http://mpvideo.qpic.cn/0bf2ruaaaaaafuaeatjodzqvbdodacgqaaaa.f10002.mp4?dis_k=daf72a5602d0f00ff1a0ac43a1e95359&dis_t=1631859296&vid=wxv_2027172242035359744&format_id=10002&support_redirect=0&mmversion=false" control></video>

 

继续观看

BypassAV - Windows Defender & 360

[视频详情](javascript:;)