<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/6eFtrmZODrsOHSj8vY0wJQ)

0x1
===

![图片](https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Lf4smCKdN3oFmkB3iaibuGy3Pz9EqNCvavWCOBhxNTHHp8yZYnH7pY6lnbiabPx9wHiarvmr58EqoNWEA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

#### 刚打开就显示 有新版 然后自动退出了  说明有更新了现在这个不能用了 拉进od开整

![图片](https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Lf4smCKdN3oFmkB3iaibuGy3PS2JVJz8r2ick7MKepicIvZUiaPW8geM1iaARbjcsCWonDj2UNOibRC0YIUg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

因为有弹窗，通过弹窗下手，MessageBoxA直接下断

![图片](https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Lf4smCKdN3oFmkB3iaibuGy3PrTNPU4ic7SKk55KMmPPPuuzMZO7UVDNia4LrwaO2w7EdEtBiasrOzUkfw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

成功断下，观看堆栈，发现传入进来的值就是提示新版

![图片](https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Lf4smCKdN3oFmkB3iaibuGy3P3DzKAicUPW1ztHo3mgJDfxAfvPpuVbSNrxtVVTzS6xXkX8V5icJzGjow/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

一路f8 走出来走到用户层  可以发现这个call就是提示更新的  然后下面这个就是退出call

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

我们直接nop掉 然后直接运行起来

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

发现成功运行起来，提示更新就被我们干掉了

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

点击登录显示你未充值到期  假的卡号肯定没用 我们直接搜索字符串

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

点E 然后进去401000基地址来查询字符串

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

发现了 原来是用了天盾网络验证 这里就好办了  这里做一个小知识

解决天盾网络验证分为4个步骤

1.判断登录

2.判断合法

3.判断算法

4.判断时间

我们一步一步解决掉他们

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

先是找到登录中跳转过去

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

直接这里的每一个call都用回车进去查看

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

像这种 FF25这种就是自带函数 而不是人自定义的

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

往下翻找到这个函数 应该就是登录判断函数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

直接改变判断 然后跳转出来

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

找到合法

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

直接retn返回不进行判断

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

查找时间-1

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

进行更改时间 注意不要超出这个00 不然就是改变代码

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

找到算法识别跳转 一直往下翻到红色算法区域结束 第一个jnz判断的位置

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

直接改成jmp

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

往下翻再把jge改成jmp

0x2
---

这时候我以为已经成功了，但是直接闪退退出了。发现可能有暗桩或其他判断

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

一直单步跟进到这里，发现在这里闪退了

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

进去一看发现又进行了一次合法判断，直接改成retn返回

0x3
---

破解成功

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

0x4
---

破解成功后发现，里面的功能无法运行，感觉没有完全破解完，后又发现往路径里填写了一个key.txt

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

里面填了一个也不知道什么用的数字，重新回去调试

0x5
---

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

搜索字符串发现确实有这个key.txt 但是不知道做了什么

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

往上走发现 有一个判断跳过了这个key.txt

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

直接尝试nop掉这个判断，功能最终成功运行。

0x6总结
-----

1.天盾校验就是这么一个过程或者大多数的网络校验都是如此，只需要一直调试。

2.发现有暗桩不要害怕，能断下单步调试，有耐心就能找到。

3.发现破解了还是不能运行，不要着急，仔细观察软件还做了什么，大胆尝试，猜测，改变。

0x7推荐实验
-------

**Ollydbg之程序破解** 

https://www.hetianlab.com/expc.do?ec=ECID172.19.104.182014040814563200001&pk_campaign=weixin-wemedia#st

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

戳“阅读原文”体验靶场实操