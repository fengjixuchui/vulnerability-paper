<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/vV9OfIyKTawkpiXexEWPew)

<table width="677"><tbody><tr><td width="557" valign="top" height="62"><p><strong>声明：</strong>该公众号分享的安全工具和项目均来源于网络，仅供安全研究与学习之用，如用于其他用途，由使用者承担全部法律及连带责任，与工具作者和本公众号无关。</p></td></tr></tbody></table>

本项目是 frp 的二开项目。frp 是 fatedier 开发的一款优秀的反向代理工具，可以将本地服务器暴露在互联网上。但原程序对攻击队而言并不优雅，希望本项目可以为攻击队贡献一个完美的 FRP 二开项目！

**01 - 项目功能修改**

*   程序运行判断是否存在 frpc.ini 或 frps.ini 文件，不存在则自动创建。  
    
*   全部的参数都从 ini 文件获取？or 全部的参数都写到 go 文件中？#Todo
    
*   加入命令执行模块 #Todo
    

```
// 自动生成frpc.ini和frps.ini
func init() {
  frpcini := "frpc.ini"
  if _, errFileExist := os.Stat(frpcini); errFileExist != nil {
    f, err := os.Create(frpcini)
    if err != nil {
      os.Exit(1)
    }
    _, err = f.Write(config.DefaultiniBytefrpc)
  }

}
```

**02 - 敏感信息隐藏**

*    配置文件自动删除：frpc.exe --delini
    

```
// 删除配置文件
  // 程序运行时添加--delini命令
  if delEnable == true {
    err := os.Remove(cfgFile)
    if err != nil {
      return err
    }
  }
```

*   远程加载配置文件：frpc.exe -c http://127.0.0.1/frpc.ini
    

```
func GetRenderedConfFromFile(path string) (out []byte, err error) {
  var b []byte
  rawUrl := path
  if strings.Contains(rawUrl, "http") {
    log.Info("Remote load ini file")
    response, _err1 := http.Get(path)
    if _err1 != nil {
      return
    }
    defer response.Body.Close()
    body, _err := io.ReadAll(response.Body)
    if _err != nil {
      return
    }
    httpContent := string(body)
    var content = []byte(httpContent)
    out, err = RenderContent(content)
    return

  } else {
    log.Info("Local load ini file")
    b, err = os.ReadFile(path)
    if err != nil {
      return
    }
    localContent := string(b)
    var content = []byte(localContent)
    out, err = RenderContent(content)
    return
  }
}
```

*   服务端 IP 地址加密：需要在代码上面修改 aes 的 key 和加密后的字符
    

使用说明：在代码中修改 AESKey 和 AESencryptCode 的值为自己的。AESKey 可不修改，默认使用 Erfrp 的 md5 值。在 frpc.ini 中将 server_addr 的值修改为 AESencryptCode。

```
package dscrypto

// 对服务器IP进行隐藏需要修改此处的AESKey和AESencryptCode。
// 同时需要对frpc.ini中的server_addr进行修改，修改成AESencryptCode。
// server_addr支持正常的ip和加密之后的ip，2种形式。
var (
  VpsIP          = "192.168.1.22"
  AESKey         = "9d9d14b5f6650726afe17e1af4052632" //Erfrp
  AESencryptCode = "J6X+PfMnVldSaM1tpjaNKw=="
  //AESencryptCode = "2HrQDAPV5JgjckfYkO9u4g=="
)
```

**03 - 静态特征修改**

*   去除日志打印相关内容 #Todo
    
*   去除 FRP 相关的字段内容 #Todo
    

**04 - 流量特征修改**

*   0x17 特征修改
    
*   默认开启 TLS
    

**05 - 使用及截图**

*   配置文件自动删除：frpc.exe --delini
    

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyONibwxW3grgstUlQT1icBSWrOdXBYPhAh8OLsibTUFlNdg8AicT58EnPRZ4QR6mJbOiatS0cXFiaM7p9uw/640?wx_fmt=png)

*   服务端 IP 地址加密：需要在代码上面修改 aes 的 key 和加密后的字符
    

如果本地没有 golang 环境的，这里给大家找了一个在线的 golang 编辑器

https://lightly.teamcode.com/

首先生成 aes 加密的 vpsip

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP7MXUxWxkUia3pm2llLhWOCUuCeTcicuO5He3hmQcFuIuxOF5R0aEWiaDQesDDOumZeab9iblZWDVUhw/640?wx_fmt=png)

然后将生成前的 vps 填入 VpsIP 中，密钥填入 AESKey 中，加密后的 VPSIp 填入 AESencryptCode 中

打开终端生成 frps 和 frpc 即可

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP7MXUxWxkUia3pm2llLhWOCjpROQo8ic8FGPdVJnaoxlzLstBf7makFdBibWvg0l01OXEbibh4W8GPHw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP7MXUxWxkUia3pm2llLhWOCB4NzdP4hYu57oEhtQoCS6TDpRGMkWKKYrZIo8x44qiarEjp4fgfDtag/640?wx_fmt=png)

*   远程加载配置文件：frpc.exe -c http://x.x.x.x/frpc.ini
    

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP7MXUxWxkUia3pm2llLhWOCuh5fAWkIBS7FQSBh9Ug350OV76I5QdBrhvdCdyDQZ71Yicswcx7R6bA/640?wx_fmt=png)

**下载地址**

点击下方名片回复 "_**Erfrp**_" 获取

**欢迎加入学习**

![](https://mmbiz.qpic.cn/mmbiz_jpg/0YvAy5BgkyOdovJ8Picp6ricHzviboPL1FwMNoukmibuicibVKLuGiamN9lUYxe8aFU5iau31mWvfkAW6XkOfQjQYickLLg/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyOdovJ8Picp6ricHzviboPL1FwMPGThuwdvsfIBwrcbtjlrVTzOHtCOz4mibWV9FkZLDgQy4GFgxJBiaXg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

**推荐阅读**

[**干货 | 渗透知识库**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247485869&idx=1&sn=d9beeb2d272fe285a874dffa96c9735d&chksm=c01cc53df76b4c2b1b80e43dfa7a89bb226ba516249203eb2006ad48c81c7876897086127c25&scene=21#wechat_redirect)

[**工具｜web 指纹识别脚本**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247488121&idx=1&sn=42f5c275f6dd4a21945f25bd6615b648&chksm=c01cdee9f76b57ffacdc230b74762ec291a1247e7c9e411e1268baae79852594d2e82d5fa0ef&scene=21#wechat_redirect)

[**审计 | SeaCms 代码审计 getshell**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247488008&idx=1&sn=ac5be67686f78945875cc9ac1c6b787f&chksm=c01cde98f76b578e7afc818e5cae9e5707f611ee17f13f24031f59c02fac927a13969ef5cbc0&scene=21#wechat_redirect)

[**证书 | 第一次申请 CVE 的全过程**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247487264&idx=1&sn=6195aa9bd9a0e287948114266f22eb2e&chksm=c01cc3b0f76b4aa68a6e837c4bbeb782fab38e03def6685a918938015f5623e75fbccb40295c&scene=21#wechat_redirect)

[**实战 | 记一次授权的渗透测试**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247487467&idx=1&sn=66df556f4c751110286fb5f9768e7e89&chksm=c01cc37bf76b4a6d7d1581a21f19d2734a06efca04e740adff553c559370d51c5708b782a1bc&scene=21#wechat_redirect)

[**应急 | linux 实战清理挖矿病毒**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247488142&idx=1&sn=56f02c196bf71d8c8d4e82068611ef18&chksm=c01cde1ef76b570836789ee0fc5fcae8db4ec7cb7e7cff338b1acaf6ccfad318d3c4095127cf&scene=21#wechat_redirect)

  

好文分享收藏赞一下最美点在看哦