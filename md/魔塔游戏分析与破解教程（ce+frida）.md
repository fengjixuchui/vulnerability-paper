<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/h8Qd3m0d4PhO5nX-SGlUYw)

准备工具  
1、cheat-engine  
2、frida  
打开游戏，CE 连接进程  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNUyA1g8icia1ALLejVlyFe7CibEpbE4ZQLchd4BBJ5wqxic6QoHJGXnp7vA/640?wx_fmt=png)

  
搜索血量 400  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNWVoCpwEq2VYjjEvE0UX37BrsEDRYVCbrorAOCAvNQ5WvcREgPWgSIA/640?wx_fmt=png)

  
打怪减血，然后搜索 376，只剩一个。明显只能是它了  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNGkBKcuJYJr6WLFcFeHRNN1s4gMzoCQGvAMQ5z7SHmoib3g9iaIfhkXIw/640?wx_fmt=png)

  
然后看下它附近的内存地址，人物是个结构体，附近的地址肯定有会相关的数值。（当然一个个搜索也是可以的）  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNbdE2ooLhjHxCTC6pGApXqkwFsNFDcewVYPXfNP6r46DvXjaJ7kicWcQ/640?wx_fmt=png)

  
现在问题来了，怎么对这内存进行寻址？硬看 so 代码肯定是可以找到，不过 CE 支持内存读写监听，很容易找到读写的指令  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNmBMMvEMQZtsjOA2jRNdJUzGa24KtHwNDAKXcClFrvTxZxbVwlvTLmQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNqrQw5LaWpDT4WyQGkvDL4M1BmYic1rSBQNm44ODB8XiayXmuASVnZib4Q/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNOMGsEDSXfqGW2GuXhIJQqPCmJ2QlSOs8SmVqIRwqI86BfTCk4SoFQQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moN35ibj8gvWwoq0ZM2pBsMK9AOhdBxVdgUibIicAGl8YKwmGRfKNXpOIGEw/640?wx_fmt=png)

分析完毕 ，下面使用 frida 进行 mod

```
var mt24mgr = Module.findExportByName(moduleName, '_ZN4mt247GameMgrC2Ev')
var mt50mgr = Module.findExportByName(moduleName, '_ZN4mt507GameMgrC2Ev')
var refreshAddr = Module.findExportByName(moduleName, '_ZN4mt507UILayer17refreshHeroStatusEv')
 
var schedulerAddr = Module.findExportByName(moduleName, '_ZN7cocos2d9SchedulerC2Ev')
var refreshFunc= new NativeFunction(refreshAddr, "int", ["pointer"])
 
console.log(mt24mgr)
console.log(mt50mgr)
console.log(refreshAddr)
var schedulerInstance = null
 
 
var playerBaseMT24 = null
Interceptor.attach(mt24mgr, {
        onEnter: function (args) {
          console.log('mt24mgr')
          console.log(ptr(args[0]))
          playerBaseMT24 = ptr(args[0])
        }
})
var playerBaseMT50 = null
Interceptor.attach(mt50mgr, {
        onEnter: function (args) {
    
          console.log('mt50mgr')
          playerBaseMT50 = ptr(args[0])
          console.log(playerBaseMT50)
 
        }
})
 
 
{
        setInterval(function(){
           
                if(playerBaseMT50!=null && Memory.readInt( playerBaseMT50.add(0xc))< -200000){
                        console.log('mod',Memory.readPointer( playerBaseMT50.add(0xc)))
                        Memory.writeInt(playerBaseMT50.add(0x18),888888) 
                        Memory.writeInt(playerBaseMT50.add(0x18+4),888888)
                        Memory.writeInt(playerBaseMT50.add(0x18+8),888888)
                        Memory.writeInt(playerBaseMT50.add(0x18+12),888888)
                        refreshFunc(Memory.readPointer( playerBaseMT50.add(0xc)))
 
                   playerBaseMT50 = null
                   playerBaseMT24 = null 
                }
  
        }, 10000)
}
```

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNTiaezF0ibCFH5iatibaTLsJJHhkuSGnh4wl9icF9lNvYPlsNkJib3iaKgRglQ/640?wx_fmt=png)

样本：  
https://lachs.lanzoue.com/i4USG0iz9yif  
代码  
https://github.com/qajknsdjaks/frida-game-cheat

**关 注 有 礼**

  

  

欢迎关注公众号：逆向有你

获取每日抽奖送书

![](https://mmbiz.qpic.cn/mmbiz_jpg/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moN2ciaNMl1xHfmViaSuP96BQv7RDlabSDg8fwXGibchOj2UQNT4mwGDbgSQ/640?wx_fmt=jpeg)

本文内容来自网络，如有侵权请联系删除

![](https://mmbiz.qpic.cn/mmbiz_jpg/WJRHqUiaud0qkNKibHYib9odI6PicXjj3moNwKhUkguPH5ibicKSxg35bkzOGNIULicXttibv7xj7FnpzWUOPEcSPTGgiaw/640?wx_fmt=jpeg)