<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/tw29jBSVdoJDxL0kh9ipNA)

 ![](http://wx.qlogo.cn/finderhead/PiajxSqBRaEJ7Ik2tcpu1fLbiceIMq8ALz06e9g1ENj06MEeFBG1snVQ/0) **之乎者也吧** ， #安卓逆向 #算法分析 视频号

一、抓取数据包

1、请求头有 % 加十六进制，说以是 url 编码，先解密一下

```
GET  http://m.mapps.m1905.cn/User/sendVer?request=jYgPer7AuEqdM+DYqs/AbNb35UrMvjLwt4+f0p3RHXc=  HTTP/1.1
```

2、需要找的数值是 requests 的组成、pid（常量值）、key、did(设备编号)

```
GET  http://m.mapps.m1905.cn/User/sendVer?request=jYgPer7AuEqdM%2BDYqs%2FAbNb35UrMvjLwt4%2Bf0p3RHXc%3D HTTP/1.1
sid:
pid: 236
key: 69b39cb24632252f7bb891bdb1f0de85
did: 010067028741939
uid:
ver: 100/95/2016020901
User-Agent: Dalvik/2.1.0 (Linux; U; Android 7.1.2; HD1900 Build/N2G47O)
Host: m.mapps.m1905.cn
Connection: Keep-Alive
Accept-Encoding: gzip
```

二、搜索链接里关键字 "User/sendVer"

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCgc6lPNhVcd531k0xLKo8Ldibic6lDqASSqpRnnLFwib8SKDDv9IH3CBRCQ/640?wx_fmt=png)

1、查看 aay.b() 函数，DESede 算法

```
key：iufles8787rewjk1qkq9dj76，iv：vs0ld7w3
```

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCglxMzSanUNxTWs0ff5tj8qFAJTwg2H6PrmhJBxdLHib0vN8rpGTG70mw/640?wx_fmt=png)

2、由于 DESede 是对称加密算法，密文是：jYgPer7AuEqdM+DYqs/AbNb35UrMvjLwt4+f0p3RHXc=，可以反推一下得到加密内容为：mobile=15836353612&templateid=1

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCgvTmKVoD2fwRxeq2OcYcSLODzibpfsJgkDTP7yfIU2gbICdvaMicZ8HlA/640?wx_fmt=png)

三、搜索关键字 key

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCg22I37TB4ZyTGIR02FyBX5EcwUOKhCyTgAbZ0uJGb20wteB8fwZGd9w/640?wx_fmt=png)

1、查看 v0.i() 函数

```
public String i() {
        return abh.a(abb.c() + "m1905_2014");
    }
```

2、查看 abb.c() 函数，获取设备 id

```
public static String c() {
        String v0_2;
        try {
            TelephonyManager v0_1 =  (TelephonyManager)BaseApplication.a().getSystemService("phone");
            v0_2 = v0_1 == null ? "" : v0_1.getDeviceId();
        }
        catch(Exception v0) {
            v0_2 = "";
        }
        return v0_2;
    }
```

3、查看 abh.a() 函数，获取 md5 值

```
public class abh {
    public static final String a(String arg9) {
        int v0 = 0;
        if(!TextUtils.isEmpty(arg9)) {
            char[] v2 = new char[]{'0', '1', '2', '3', '4', '5',  '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'};
            try {
                byte[] v1 = arg9.getBytes();
                MessageDigest v3 =  MessageDigest.getInstance("MD5");
                v3.update(v1);
                byte[] v3_1 = v3.digest();
                char[] v5 = new char[(((int)v1)) * 2];
                int v1_1 = 0;
                while(v0 < v3_1.length) {
                    int v6 = v3_1[v0];
                    int v7 = v7 + 1;
                    char v8 = v2[v8 >>> 4 & 15];
                    v5[v1_1] = v8;
                    ++v1_1;
                    v5[v7] = v2[v6 & 15];
                    ++v0;
                }
                arg9 = new String(v5);
            }
            catch(Exception v0_1) {
                arg9 = null;
            }
        }
        return arg9;
    }
}
```

4、最终就是设备 id+m1905_2014，然后再算 md5

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCgVHEmubn47ygiaQTZtDXUV3icPWka47ABVFmMycgHgTKiaicDicaw2SqIaDg/640?wx_fmt=png)

四、响应值解密

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCgiavQheXHx0lZTO0XDcTLkSPjicW7t3JSvTG4ibm5Z53ibFF9EYLOkL1MiaA/640?wx_fmt=png)

禁止非法，后果自负

欢迎关注公众号：逆向有你

欢迎关注视频号：之乎者也吧

欢迎报名安卓逆向培训，报名微信 (QQ)：335158573

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCgQKTmr5H7Z7gK37s62RsXmWL1qo1LCGWSbl9woQnhnuImnj7ibkZmHsA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCgZicLw1A1vDqYibluR1VlbNLEwcazJAq6anicGsRjIFF7AXCTfYLu3TEqw/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/WJRHqUiaud0pSRbkrBLkbe7dphCY5czCgiaFna5d61oq2TklxTftCoG7Jz3p7nwft2aJ2YianiccLxEJYYypIa5fcg/640?wx_fmt=jpeg)