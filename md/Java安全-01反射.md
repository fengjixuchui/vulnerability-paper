<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/B8iNY5DS7s95WOTCTEK5PA)

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnOUGzQLuzP37icFJaVvBWBTu4JgiceNbTshL9gias9aCqkW9voORu4bTug/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

 ![](http://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08NTtG3Q2SqhtC2LYnV6W1OJaAQuJJVIficOprHk3L46X4xvHIbxuf2XxdGfEjQ1nngY7VuJ8YOYSA/0?wx_fmt=png) ** 雷石安全实验室 ** 雷石安全实验室以团队公众号为平台向安全工作者不定期分享渗透、APT、企业安全建设等新鲜干货，团队公众号致力于成为一个实用干货分享型公众号。 119篇原创内容   公众号

  

**知识基础**
========

*   类
    
*   对象
    
*   构造方法
    
*   重载
    
*   单例模式
    

**动态加载**
========

JVM在执行的时候，并不是一次性把所有的class加载到内存中的，而是用到谁加载谁。

  

**反射的概述**
=========

### https://www.cnblogs.com/tech-bird/p/3525336.html

Reflection（反射）是Java被视为动态语言的关键，反射机制允许程序在执行期借助于Reflection API取得任何类的內部信息，并能直接操作任意对象的内部属性及方法

  

**获取class对象的三种方式**
==================

1.  class.forName("全类名")
    
2.  类名.class
    
3.  对象.getClass()，如果上下文存在某个实例对象，可以通过getClass获取他的类
    

```
`public class re {` `public static void main(String[] args) throws ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException {` `Class cls1 = Class.forName("demo.Person");` `Class cls2 = Person.class;` `Person person = new Person();` `Class cls3 = person.getClass();` `System.out.println(cls1);` `System.out.println(cls2);` `System.out.println(cls3);` `System.out.println(cls1==cls2);` `System.out.println(cls3==cls2);``}`
```

![图片](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ09ibKibqE0ibOqmaN4XzmcOM45mB6kAvqicchicMMKNXO6RJiaPPibWAmk3icXAwIB2icqiblSzJEE1GskVuLAg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

  

### **类“初始化”执行顺序是什么**

```
`package demo;``public class test {` `public static void main(String[] args) {` `Ref ref = new Ref();` `}``}``class Ref{` `static {` `System.out.println("最先执行\r\n");` `}` `{` `System.out.println("第二执行\r\n");` `}` `public Ref(){` `System.out.println("最后执行\r\n");` `}``}`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

### **demo1**

```
`package demo;``public class test {` `public static void main(String[] args) throws ClassNotFoundException {` `Class.forName("demo.CalcDemo");` `}``}``class CalcDemo {` `static {` `try {` `Runtime rt = Runtime.getRuntime();` `Process pc = rt.exec("calc");` `pc.waitFor();` `} catch (Exception e) {` `}` `}``}`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

### **Class方法**

获取变量

*   Field getField(name)：根据字段名获取某个public的field（包括父类）
    
*   Field getDeclaredField(name)：根据字段名获取当前类的某个field（不包括父类）
    
*   Field[] getFields()：获取所有public的field（包括父类）
    
*   Field[] getDeclaredFields()：获取当前类的所有field（不包括父类）
    

```
`cls3.getField("aaa");//指定名称的public修饰的``cls3.getFields();//获取所有public修饰的成员变量``cls3.getDeclaredField("aaaa");//获取所有``cls3.getDeclaredFields();`
```

获取构造方法

```
`cls3.getConstructors();``cls3.getConstructor("aaa");``cls3.getDeclaredConstructor("bbb");``cls3.getDeclaredConstructors();`
```

```
`package demo;``import java.lang.reflect.Constructor;``import java.lang.reflect.InvocationTargetException;``public class test {` `public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {``//        Ref ref = new Ref();` `Class cls = Class.forName("demo.Person");` `Constructor constructor = cls.getConstructor();` `Constructor constructor1 = cls.getConstructor(String.class);` `constructor.newInstance();` `constructor1.newInstance("jl");` `}``}`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**demo2**

```
`package demo;``import java.lang.reflect.Constructor;``import java.lang.reflect.InvocationTargetException;``import java.lang.reflect.Method;``import java.util.Arrays;``import java.util.List;``public class test {` `public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {` `Class cls = Class.forName("java.lang.ProcessBuilder");` `Method methodStart = cls.getMethod("start");` `Constructor constructor = cls.getConstructor(List.class);` `Object obj =  constructor.newInstance(Arrays.asList("calc.exe"));` `methodStart.invoke(obj);` `}``}`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### **demo3-可变长参数**

```
`package demo;``import java.lang.reflect.Constructor;``import java.lang.reflect.InvocationTargetException;``import java.lang.reflect.Method;``import java.util.Arrays;``import java.util.List;``public class test {` `public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {` `Class cls = Class.forName("java.lang.ProcessBuilder");` `Method methodStart = cls.getMethod("start");` `Constructor constructor = cls.getConstructor(String[].class);` `Object obj = constructor.newInstance(new String[][]\{\{"calc.exe"\}\});` `methodStart.invoke(obj);` `}``}`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

获取成员方法

```
`cls3.getConstructors();``cls3.getConstructor("aaa");``cls3.getDeclaredConstructor("bbb");``cls3.getDeclaredConstructors();`
```

**demo4**

```
`package demo;``import java.lang.reflect.Constructor;``import java.lang.reflect.InvocationTargetException;``public class test {` `public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {``//        Ref ref = new Ref();` `Class cls = Class.forName("demo.Person");` `Constructor constructor = cls.getConstructor();` `Constructor constructor1 = cls.getConstructor(String.class);` `constructor.newInstance();` `constructor1.newInstance("jl");` `}``}`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

#### **demo5**

```
`package demo;``import java.lang.reflect.InvocationTargetException;``import java.lang.reflect.Method;``public class test {` `public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException {` `Class cls = Class.forName("java.lang.Runtime");` `Method method = cls.getMethod("exec", String.class);` `Method method1 = cls.getMethod("getRuntime");` `method.invoke(method1.invoke(cls),"calc.exe");` `}``}`
```

Runtime类就是单例模式，我们只能通过 Runtime.getRuntime() 来获取到 Runtime 对 象。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

  

### **往期回顾**

01

  

[使用goby检测log4j漏洞](http://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247513834&idx=1&sn=4bc106d1db72f8e0e88556bcf1614fe0&chksm=ec269772db511e64f434591e98ddd51c553404588eae64a8150a31b5c351787259823c32a0ab&scene=21#wechat_redirect)

02

  

[小程序测试流](http://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247513782&idx=1&sn=4d19b7be5ec3d8f3011d60a490dbe65c&chksm=ec26972edb511e389473f5905c3958bcec351a44027b4a300e8f390aa3893b1d16b9ae74df90&scene=21#wechat_redirect)
===============================================================================================================================================================================================================================

03

  

[ModSecurity 搭建web安全防火墙和流量检测](http://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247513682&idx=1&sn=4eccf0163664baf673a0725f2208acc2&chksm=ec2697cadb511edc6bc53da1673f4d05d4cbbf1fdaff60a50751a2be60151c2e96efd691efae&scene=21#wechat_redirect)
====================================================================================================================================================================================================================================================

[](http://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247513614&idx=1&sn=8e7017372b737224fbb3288e96f919a8&chksm=ec269796db511e80ca07e8b499e44e60141fb9a68adaabca7a91df805dddd11f890a632c69cb&scene=21#wechat_redirect)  

============================================================================================================================================================================================================================