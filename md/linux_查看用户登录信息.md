<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/gA8WuCeSS9VOD4JzJw2Aqw)

本文来自“白帽子社区知识星球”  

作者：孙伟

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/HQn53QYo2G7DTFfSqal7VmGU1xKbwvvFCWia9p3AZz1TBhqTGkFeZMzFfby1F0GTp1p28go67IeEfowblxAXJcA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

  

  

**白帽子社区知识星球**

  

加入星球，共同进步

**0****1**

  

last
----

  

查看用户登录历史，读取的是/var/log/wtmp文件中的内容，此文件为二进制格式，无法直接查看其内容。

### 参数

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/HQn53QYo2G4pCHCbSWvDg4iazGxABzbYFwp81R5XOFZ1tDcVhtmNxfosFaFNEwicfoO8yiaYNWL7vkGKpu3icY2brw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

### 示例  

#### 无参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### 查看指定用户登录时间  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -a：将登陆ip显示在最后一行  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -d：将主机名转换为IP地址  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -f：读取特定文件  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -F：显示完整时间  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### i：显示IP  

因为是本地登录，所以是`0.0.0.0` 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -n：设置列出名单的显示列数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -R：不显示主机名  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -t：查看指定时间之前的用户登录历史  

显示2022年01月10日00时00分00秒之前登录的用户 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -s：查看指定时间之后的用户登录历史

显示2022年01月10日00时00分00秒之后登录的用户 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -p：显示指定时间登录的用户信息

显示2022年01月09日登录的用户 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -w：显示完整用户名和主机名称

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -x：显示系统开关机以及执行等级信息  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**0****2**

  

lastb
-----

  

用于列出登入系统失败的用户相关信息。读取的是/var/log/btmp文件 需要sudo权限 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

### 参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

用法与last基本一致

**0****3**

  

lastlog
-------

  

可简单查看所有用户最后一次的登陆时间，默认是读取/var/log/lastlog文件内容

### 参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

### 示例  

#### 无参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -b：显示哪天之前登录的用户

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -c：清除指定用户信息，需要和-u配合使用

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -S：需配合-u指定用户，将指定用户的登录时间定为当前时间

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -t：显示指定天数以来的登录信息

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -u：查看指定用户的信息

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**0****4**

  

who
---

  

显示系统中有哪些使用者正在使用

### 参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -a：显示所有信息  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -b：显示启动信息，可以用于查询启动时间  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -d：显示退出的进程。  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -H：显示标题栏

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -l：显示已登录用户的信息

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -m：显示精简信息

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -q：显示当前有几个用户正在使用  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -r：显示本地系统节点的运行级别

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -s：仅列出名字、线路和时间字段，等同于不加参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -u：显示每个当前用户的用户名、tty、登录时间、线路活动和进程标识。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -T：显示 tty 终端的状态，“+”表示对任何人可写，“-”表示仅对 root 用户或所有者可写，“？”表示遇到线路故障。  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**0****5**

  

w
-

  

用于显示目前登入系统的用户信息。与who的区别：w 命令除了能知道目前已登陆的用户信息，还可以知道每个用户执行任务的情况。

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

### 参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

### 示例

#### 无参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

<table><thead style="box-sizing: border-box;"><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><th style="padding: 6px 13px;box-sizing: border-box;" width="107.66666666666667">标题</th><th style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">含义</th></tr></thead><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="107.66666666666667">USER</td><td style="padding: 6px 13px;box-sizing: border-box;" width="348.6666666666667">登录到系统的用户。</td></tr><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="85.66666666666667">TTY</td><td style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">登录终端。</td></tr><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="107.66666666666667">FROM</td><td style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">表示用户从哪里登陆进来，一般显示远程登陆主机的 IP 地址或者主机名。</td></tr><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="85.66666666666667">LOGIN@</td><td style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">用户登陆的日期和时间。</td></tr><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="107.66666666666667">IDLE</td><td style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">表示某个程序上次从终端开始执行到现在所持续的时间。</td></tr><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="86.66666666666667">JCPU</td><td style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">和该终端连接的所有进程占用的CPU运算时间。这个时间里并不包括过去的后台作业时间，但是包括当前正在运行的后台作业所占用的时间。</td></tr><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="107.66666666666667">PCPU</td><td style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">当前进程所占用的 CPU 运算时间。</td></tr><tr style="box-sizing: border-box;border-top: 1px solid var(--color-markdown-table-tr-border);"><td style="padding: 6px 13px;box-sizing: border-box;" width="107.66666666666667">WHAT</td><td style="padding: 6px 13px;box-sizing: border-box;" width="369.6666666666667">当前用户正在执行的进程名称和选项，换句话说，就是表示用户当前执行的是什么命令。</td></tr></tbody></table>

#### -h：不显示标题

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -u：忽略执行程序的名称

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -f：不显示远程主机名字段  

就是不显示from字段 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -o：使用旧样式

缺少几个字段的数据 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

#### -i：显示IP地址或主机名

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**0****6**

  

users
-----

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

显示当前当登录的用户的用户名 

### 参数

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

命令后面接文件,常用的文件有/var/log/wtmp，/var/run/utmp  

### 示例

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

还可以进行统计 

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**07**

  

查看反弹shell的一般方法
--------------

以上的方法都是查看正常使用账号密码登录的账号的方法。反弹shell的统计和查看方法不在其中。一般反弹shell都会调用/bin/bash可/bin/sh。因此，我们可以借助这个方法，查看进程进行筛选。例如：

```
ps -ef|grep "/bin/bash"`  
或  
ps -ef|grep "sh"  
或  
ps -ef|grep "socat"
```

如果觉得本文不错的话，欢迎加入知识星球，星球内部设立了多个技术版块，目前涵盖“WEB安全”、“内网渗透”、“CTF技术区”、“漏洞分析”、“工具分享”五大类，还可以与嘉宾大佬们接触，在线答疑、互相探讨。

  

▼扫码关注白帽子社区公众号&加入知识星球▼

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)