<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/iIITiM6z1mrMAnza-IP5ng)

![](https://mmbiz.qpic.cn/mmbiz_jpg/8miblt1VEWyxAe55JoiaWV4Sd3lVibzpX8rIuOpuy0icQuHGdqgqAlN8lWic83s7jjkQIaTjL2qYxNy7a11uQjnPsAA/640?wx_fmt=jpeg)

扫一扫关注公众号，长期致力于安全研究![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyxAe55JoiaWV4Sd3lVibzpX8rfiaOPuUGpJnDTSzZHQZa8ibqbs60f287vXgrwbN2FJe2x8SUibUwvXeUA/640?wx_fmt=png)

**前言：最近找了一套 CrackMe 来玩**

  

0x01 前期

打开之后就是一个类似于注册页面，错误就显示 Sorry  

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lgv43WtKbS1I52c0DAM0Gl2by3ePj0oCjXQMvPOQYFGsEicotKGibNxj2w/640?wx_fmt=png)

  

0x02 动态调试

根据搜索关键字符串直接定位

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lg3XdmGRYsF8iaEFbhKJTLv3gbVic5cyu9pMmAKoe3v0TD4GiaZ2M0K4BsQ/640?wx_fmt=png)

之后往函数开始处进行分析，分析了一下是对输入的密码进行各种左移，相加相减

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lgGVgv9kpDBBpWLRPibjbsREyFCIy7zBQF4gAwSHQyWrgbkGnYVqYwVxw/640?wx_fmt=png)

分析半天，发现一个 cmp，前面做的感觉毫无用处，该处 cmp 检测用户输入的长度是否大于 4

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lgjgpboZeDbfFORM9lCv6Izibroqzib1bRSoF9eGZbUVSeg3SDrRBrD40Q/640?wx_fmt=png)

继续往下走之后，首先进行了几个字符的拼接，继续通过堆栈发现，99% 确定了当前这个 call 就是判断用户是否输入正确的密码

(注：这里本人没有输入密码，堆栈中是不正确的)  

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lgGs4SffgA4Md3bTQWSyO8Bsn0Us1mecEXfdJvGSpialyoiaOXQJw4fm2w/640?wx_fmt=png)

因为如果输入不匹配，则会通过 jnz 指令跳转到 Messagebox

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lgRzTPrXEjBNKdFbFPncRJfsicnK7zTD5BNqqNafFySv50HHibVZDeRMsA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lg6yAyDH6s1VUDdKtlkx5hPaxl1dDHiav7RQKF1saBzmrMHibsricOZOyxw/640?wx_fmt=png)

成功完事，收拾收拾下班

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lgK5lE2OlibzKepQLqW7lRhTnd8UlBKb2dI5nAhYvMUOdxEx75CrHQdBw/640?wx_fmt=png)

  

0x03 补丁编写

逆了半天，感觉太不方便了，其实完完全全可以将目标指向 jnz 指令处

将 jnz nop 掉即可

接下来写一个简单的内存补丁即可

```
int PID = 0;
  char buf[] = { 0x90, 0x90 };
  printf("请输入进程ID:");
  scanf("%d",&PID);
  HANDLE h = OpenProcess(PROCESS_ALL_ACCESS,TRUE,PID);
  if (WriteProcessMemory(h, (LPVOID)0x0042FB03, buf, sizeof(buf), NULL)){
    MessageBox(NULL, L"打入补丁成功", L"打入补丁成功", NULL);
  }
  else{
    MessageBox(NULL, L"Error", L"Error", NULL);
  }
```

  这下方便了，直接就成功了

![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyz0apw06WWoAUXrEFXvT2lgC7hfWXJU0NlJfk11zacJgFDKJGdIVmK6GibZxz1Yn6A8iadqFtx3nf8Q/640?wx_fmt=png)

  

  

11111  

微信搜索关注 "安全族" 长期致力于安全研究

下方扫一下扫，即可关注![](https://mmbiz.qpic.cn/mmbiz_png/8miblt1VEWyxAe55JoiaWV4Sd3lVibzpX8rfiaOPuUGpJnDTSzZHQZa8ibqbs60f287vXgrwbN2FJe2x8SUibUwvXeUA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/8miblt1VEWyxAe55JoiaWV4Sd3lVibzpX8rIuOpuy0icQuHGdqgqAlN8lWic83s7jjkQIaTjL2qYxNy7a11uQjnPsAA/640?wx_fmt=jpeg)