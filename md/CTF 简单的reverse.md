> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/944relgRq0XNWeT7FRRqIw)

### <table width="677"><tbody style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><tr style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td valign="top" width="557" height="62" style="outline: 0px;word-break: break-all;hyphens: auto;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br></p><table width="677"><tbody style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><tr style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td valign="top" width="557" height="62" style="outline: 0px;word-break: break-all;hyphens: auto;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin-bottom: 15px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">声明：</strong>该公众号大部分文章来自作者日常学习笔记，也有少部分文章是经过原作者授权和其他公众号白名单转载，未经授权，严禁转载，如需转载，联系时悠</section><section style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与文章作者和本公众号无关。仅供学习研究</section><p style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></p></td></tr></tbody></table></td></tr></tbody></table>

一、Shuffle  

#### 题目来源：攻防世界 (xctf.org.cn)

下载附件，没有任何后缀名，看一下16进制

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpM6q358nB6PCXQb675zrACovOUmNWzMVXdro5x7Kg7yNPiaHyUzkTSJaQ/640?wx_fmt=png)

  

elf文件，linux的可执行文件，用od打不开，再用查壳工具试试看

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMg66t0Qem8cLjIseFfBf7DicuvhRfXdWDX50thwS7Ah3oiaicjL4ueNaDQ/640?wx_fmt=png)

  

没有显示出任务有效信息（这工具可能版本老了或者不行了，但是我懒得更新）

用ida打开

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpM8VTZvichJkg6z6xIm3zUwW2ccjicmicdWxqP07ickwZsmIDXW6ovjukDog/640?wx_fmt=png)

  

可以直接看到定义了一串很像flag的字符串

我们再拖到虚拟机里运行看看

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpM4WAAib0S7N3ZrSicCsVmIribrT4DRa6aLVmBjPPVJxdFeic8rV7pFeDicGg/640?wx_fmt=png)

  

仔细观察可以发现，程序输出的就是ida下看到的那一串字符的随机排列

再结合题目提示：找到字符串在随机化之前

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMDsBUibib018uiblZO0djB49OZSk84fC7spmPcdu6tD2GzpLlLMp0SV0YQ/640?wx_fmt=png)

  

基本确定flag就是那一串字符

SECCON{Welcome to the SECCON 2014 CTF!}

提交正确

### 二、srm-50

#### 题目来源：攻防世界 (xctf.org.cn)

下载附件，是个exe，我们还是放虚拟机里运行一下（最近被某群的群文件放马整怕了）

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpM6ib4921ia2iap2kyvdyqicAhTRxo3cUkah850VOicw5cZRD9PH6H1S2zC4A/640?wx_fmt=png)

  

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMee2ibFsjnSCWry4rP7ve00OWqNsTTtETNvJ4KibxC5Bcqx9krzGIIx0g/640?wx_fmt=png)

  

是个登入框

用ida打开，shift+f12找之前错误提示的字符

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMDaKWVAQfHm0p0kk1VCPwy0K9jUOVLLwFZKicM2E5iaNhaRfRd027jw1A/640?wx_fmt=png)

  

跟踪过去

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMGliblJZoooPYPUQJhicB42dtbn3ibbzpNT7SEzqicicYK5PRW76gibNCYA3g/640?wx_fmt=png)

  

这边反汇编没反应，开始看汇编，虽然会一些汇编，但是不扎实，汇编代码还是看得头疼，果断放弃，去找main函数

找到main函数，反汇编得到代码

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMibR6lNcvHauwwMTI6I71aWEArXIicWvgiaoVnAoexaHsibbg5QYWaHmO4A/640?wx_fmt=png)

  

关键看这边提示成功的字符，

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMUM18wfW88qA9XHKmVgLvIPqJeLjm0j1kQiclHMCuUEwWvc0mJZc8zTw/640?wx_fmt=png)

  

那我们就把下面的V11给他转一下应该就是flag了

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMANzlcibDnzVhdoPRM4Kv2PxTAGKQl2WicblCEnbByPF0oDHQEg2miciabg/640?wx_fmt=png)

  

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMpb0wxz4Y0dTMYH7wVMWG1m2Vgkk7YRQ8xNDwZTEG3iceJCzwTrtVCXQ/640?wx_fmt=png)

  

那么flag就是：CZ9dmq4c8g9G7bAX

提交正确

### 三、dmd-50

#### 题目来源：攻防世界 (xctf.org.cn)

下载附件，查看信息，是个elf

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMhxUduUqrMiaWdPweZIRuZHpY7KCkxSCicNAMwNIoFJ1uBcgXib8BP8cSg/640?wx_fmt=png)

  

运行一下，是个验证

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMHZrBPOCxvBhOrNJWfJgvsuvt0ZgiaibicFEicQ5JRlLVNTwKibQRHB4y3UQ/640?wx_fmt=png)

  

老规矩，上ida，找enter the valid key，再反汇编一下

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMlzP7ibh9gubPaialRLiapw59j2yiclTL0pP2lZDiazMfCZv9NhaZ9nUXQYA/640?wx_fmt=png)

  

```
int __cdecl main(int argc, const char **argv, const char **envp)  
{  
  __int64 v3; // rax  
  __int64 v4; // rax  
  __int64 v5; // rax  
  __int64 v6; // rax  
  __int64 v7; // rax  
  __int64 v8; // rax  
  __int64 v9; // rax  
  __int64 v10; // rax  
  __int64 v11; // rax  
  __int64 v12; // rax  
  __int64 v13; // rax  
  __int64 v14; // rax  
  __int64 v15; // rax  
  __int64 v16; // rax  
  __int64 v17; // rax  
  __int64 v18; // rax  
  __int64 v19; // rax  
  __int64 v20; // rax  
  __int64 v21; // rax  
  int result; // eax  
  __int64 v23; // rax  
  __int64 v24; // rax  
  __int64 v25; // rax  
  __int64 v26; // rax  
  __int64 v27; // rax  
  __int64 v28; // rax  
  __int64 v29; // rax  
  __int64 v30; // rax  
  __int64 v31; // rax  
  __int64 v32; // rax  
  __int64 v33; // rax  
  __int64 v34; // rax  
  __int64 v35; // rax  
  __int64 v36; // rax  
  __int64 v37; // rax  
  char v38; // [rsp+Fh] [rbp-71h] BYREF  
  char v39[16]; // [rsp+10h] [rbp-70h] BYREF  
  char v40[8]; // [rsp+20h] [rbp-60h] BYREF  
  __int64 v41; // [rsp+28h] [rbp-58h]  
  char v42[56]; // [rsp+30h] [rbp-50h] BYREF  
  unsigned __int64 v43; // [rsp+68h] [rbp-18h]  
  
  v43 = __readfsqword(0x28u);  
  std::operator<<<std::char_traits<char>>(&std::cout, "Enter the valid key!\n", envp);  
  std::operator>><char,std::char_traits<char>>(&edata, v42);  
  std::allocator<char>::allocator(&v38);  
  std::string::string(v39, v42, &v38);  
  md5(v40, v39);  
  v41 = std::string::c_str((std::string *)v40);  
  std::string::~string((std::string *)v40);  
  std::string::~string((std::string *)v39);  
  std::allocator<char>::~allocator(&v38);  
  if ( *(_WORD *)v41 == 14391  
    && *(_BYTE *)(v41 + 2) == 48  
    && *(_BYTE *)(v41 + 3) == 52  
    && *(_BYTE *)(v41 + 4) == 51  
    && *(_BYTE *)(v41 + 5) == 56  
    && *(_BYTE *)(v41 + 6) == 100  
    && *(_BYTE *)(v41 + 7) == 53  
    && *(_BYTE *)(v41 + 8) == 98  
    && *(_BYTE *)(v41 + 9) == 54  
    && *(_BYTE *)(v41 + 10) == 101  
    && *(_BYTE *)(v41 + 11) == 50  
    && *(_BYTE *)(v41 + 12) == 57  
    && *(_BYTE *)(v41 + 13) == 100  
    && *(_BYTE *)(v41 + 14) == 98  
    && *(_BYTE *)(v41 + 15) == 48  
    && *(_BYTE *)(v41 + 16) == 56  
    && *(_BYTE *)(v41 + 17) == 57  
    && *(_BYTE *)(v41 + 18) == 56  
    && *(_BYTE *)(v41 + 19) == 98  
    && *(_BYTE *)(v41 + 20) == 99  
    && *(_BYTE *)(v41 + 21) == 52  
    && *(_BYTE *)(v41 + 22) == 102  
    && *(_BYTE *)(v41 + 23) == 48  
    && *(_BYTE *)(v41 + 24) == 50  
    && *(_BYTE *)(v41 + 25) == 50  
    && *(_BYTE *)(v41 + 26) == 53  
    && *(_BYTE *)(v41 + 27) == 57  
    && *(_BYTE *)(v41 + 28) == 51  
    && *(_BYTE *)(v41 + 29) == 53  
    && *(_BYTE *)(v41 + 30) == 99  
    && *(_BYTE *)(v41 + 31) == 48 )  
  {  
    v3 = std::operator<<<std::char_traits<char>>(&std::cout, 84LL);  
    v4 = std::operator<<<std::char_traits<char>>(v3, 104LL);  
    v5 = std::operator<<<std::char_traits<char>>(v4, 101LL);  
    v6 = std::operator<<<std::char_traits<char>>(v5, 32LL);  
    v7 = std::operator<<<std::char_traits<char>>(v6, 107LL);  
    v8 = std::operator<<<std::char_traits<char>>(v7, 101LL);  
    v9 = std::operator<<<std::char_traits<char>>(v8, 121LL);  
    v10 = std::operator<<<std::char_traits<char>>(v9, 32LL);  
    v11 = std::operator<<<std::char_traits<char>>(v10, 105LL);  
    v12 = std::operator<<<std::char_traits<char>>(v11, 115LL);  
    v13 = std::operator<<<std::char_traits<char>>(v12, 32LL);  
    v14 = std::operator<<<std::char_traits<char>>(v13, 118LL);  
    v15 = std::operator<<<std::char_traits<char>>(v14, 97LL);  
    v16 = std::operator<<<std::char_traits<char>>(v15, 108LL);  
    v17 = std::operator<<<std::char_traits<char>>(v16, 105LL);  
    v18 = std::operator<<<std::char_traits<char>>(v17, 100LL);  
    v19 = std::operator<<<std::char_traits<char>>(v18, 32LL);  
    v20 = std::operator<<<std::char_traits<char>>(v19, 58LL);  
    v21 = std::operator<<<std::char_traits<char>>(v20, 41LL);  
    std::ostream::operator<<(v21, &std::endl<char,std::char_traits<char>>);  
    result = 0;  
  }  
  else  
  {  
    v23 = std::operator<<<std::char_traits<char>>(&std::cout, 73LL);  
    v24 = std::operator<<<std::char_traits<char>>(v23, 110LL);  
    v25 = std::operator<<<std::char_traits<char>>(v24, 118LL);  
    v26 = std::operator<<<std::char_traits<char>>(v25, 97LL);  
    v27 = std::operator<<<std::char_traits<char>>(v26, 108LL);  
    v28 = std::operator<<<std::char_traits<char>>(v27, 105LL);  
    v29 = std::operator<<<std::char_traits<char>>(v28, 100LL);  
    v30 = std::operator<<<std::char_traits<char>>(v29, 32LL);  
    v31 = std::operator<<<std::char_traits<char>>(v30, 75LL);  
    v32 = std::operator<<<std::char_traits<char>>(v31, 101LL);  
    v33 = std::operator<<<std::char_traits<char>>(v32, 121LL);  
    v34 = std::operator<<<std::char_traits<char>>(v33, 33LL);  
    v35 = std::operator<<<std::char_traits<char>>(v34, 32LL);  
    v36 = std::operator<<<std::char_traits<char>>(v35, 58LL);  
    v37 = std::operator<<<std::char_traits<char>>(v36, 40LL);  
    std::ostream::operator<<(v37, &std::endl<char,std::char_traits<char>>);  
    result = 0;  
  }  
  return result;  
}  

```

分析代码，看这，应该是个md5

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMUOiatf6jicUdSnb58w6aybvL44tBVggd2ibl7ibH1Y6jEU3NtN3siciaTApg/640?wx_fmt=png)

  

85行开始往后的那一大串，转化成字符之后，可以发现是程序常量，所以主要看55行开始的那一串就行了

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpM0xGGGaJsqLJ36hEu5Zn8p35SBVINhX6UicbkY2KMUkLnYr84sybic29w/640?wx_fmt=png)

  

把55行if之后的数据全都拿出来，小端存储，所以我们倒着拿，然后就得到了

```
780438d5b6e29db0898bc4f0225935c0  

```

再解密试一下，就得到grape

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMNuCZ7ZJYMcRQNT9voUBPWDpickNo7X1JIXN0ywTg3tiawnp3tMBwAXDw/640?wx_fmt=png)

  

到这里其实我有点懵了，看了下wp，这边解密工具给出的grape是经过两次md5运算的，而程序这里只经过了一次，所以再反向加密一次就能够得到flag

![](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyP9WlUoagV9QULXGJfib7SpMibNonobLT4f4yMHSBK8BgOjUmfYhMAkrGWkOlo1oLKTuvu5qc7EfllQ/640?wx_fmt=png)

  

flag:b781cbb29054db12f88f08c6e161c199

攻防世界，这是一个比较适合新手去练习的一个ctf平台，这些的逆向题目也都不怎么难，尤其第一题都不需要有任何汇编和代码基础，会用ida就能做出来，挺推荐刚接触安全或者想打ctf的朋友去练练的。

玩逆向，基础代码知识得牢固，正向功底越好，逆向才能牛逼，尤其是汇编和C，这两个是躲不开的。多学习，多实践，从0到1，一起加油!

![](https://mmbiz.qpic.cn/mmbiz_jpg/0YvAy5BgkyOBD1717aRBcfewuLGrwKYGgAIeEichRUWKRTXhxT2O0ia4Tz41DfOsZyqajU1LqyMfBqkKrbibDPgYA/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png)

  

**推荐阅读**

  

  

[**干货 | 渗透知识库（鹏组安全）**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247485869&idx=1&sn=d9beeb2d272fe285a874dffa96c9735d&chksm=c01cc53df76b4c2b1b80e43dfa7a89bb226ba516249203eb2006ad48c81c7876897086127c25&scene=21#wechat_redirect)

  

[**信息安全** **| 键盘记录之信息窃取（登录框密码隐藏就真的万无一失吗)**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247484956&idx=1&sn=1e074f66b5bc991e70f96adf002063b5&chksm=c01cca8cf76b439a9187ee5a9adddeeb4d77cb7a962e983ad3bd5aa588bb23507d675e6f97f8&scene=21#wechat_redirect)

  

[**python | 用python写了一个谈恋爱AA公式，我被分手了**](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247484965&idx=1&sn=c4c9ef097281b168cdd09c8a2d61f911&chksm=c01ccab5f76b43a3e9ad4328d7a1e78e38d1c0e5b6a0433b8b30f67e8be0de3ad69037157c0b&scene=21#wechat_redirect)

  

  

  

好文分享收藏赞一下最美点在看哦