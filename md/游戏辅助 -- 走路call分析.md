> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ran0ZWuUnkfRvtVEsa_1Jw)

往期文章

[游戏辅助 -- 获取人物属性代码编写](http://mp.weixin.qq.com/s?__biz=MzI4MDQ5MjY1Mg==&mid=2247496977&idx=2&sn=6fb66f65a4dfbfea3d24a7cd4a134834&chksm=ebb51a12dcc2930448d3a8927c676bb71e89b93c0df70bab172ef58deff4b86e2c6d00087b68&scene=21#wechat_redirect)  

[游戏辅助 -- 人物属性分析](http://mp.weixin.qq.com/s?__biz=MzI4MDQ5MjY1Mg==&mid=2247496929&idx=2&sn=be71005dfaa97be8db41b5c774e885cf&chksm=ebb51be2dcc292f44328c93e990ae926defdda6423713d02f386b93d27502d90c1ab12263de6&scene=21#wechat_redirect)  

  

一、打开游戏，按ESC，选择界面，选择鼠标，点击移动，可以试着搜索1为打对钩的状态，0为没打对钩的状态，也可以反过来测试0为打钩的状态

![图片](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvQviaRSDWfHfWeaOWbPThQ61iaNHSGbLpnYnq6KOFYjiaMI30RWV2uUOC1xPtUYDTgibGgsibpJ4JenOw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![图片](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvQviaRSDWfHfWeaOWbPThQ6jn33G7nI4KSiaKM1iaf9g3FLPc9rOicC9w8IJoyoSsZxBSD32TPiaSOyDw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

二、CE载入游戏进程，不停的搜索0和1，直到搜索到很少的结果

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

三、右击第一个地址，查看什么访问了该地址，切换到游戏界面，鼠标点击地名，让人物走动一下

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

四、发现没有数据，然后切换到第二个地址，查看什么访问了该地址

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

五、用OD打开游戏进程，ctrl+G跳转到0x72b702地址

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

六、猜测，这里进行了是否可以鼠标移动的判断，如果可以移动就往下面走，如果不可以移动就je跳过下面代码。在072b702处下断，现在鼠标可以移动位置，所以跳转实效，箭头是灰色的

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

七、fldz这个是浮点数操作命令，这里可以理解为开始操作浮点数了，也就是我们要找的坐标

1、push ecx是一个常量值，多次测量都一样，游戏重启后会变，

2、push edx存放的是目的坐标，在该处下断，右击edx，在内存窗口中转到

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)3、push eax是一个连续存放8个字节为0的地址

4、push 4

5、call wow.727400，进入call，发现有一个ecx直接拿来用的，所以我们的测试代码如下

```
`sub esp,0x200``lea edx,[esp+0x50]``mov dword ptr[edx+0x00],0``mov dword ptr[edx+0x04],0``lea ebx,[esp+50]``mov dword ptr [ebx+0x00],0xC60BB228``mov dword ptr [ebx+0x04],0xC30C3DAA``mov dword ptr [ebx+0x08],0x42A71492``push 0``push ebx``push edx``push 4``mov ecx,296C8E78``call 727400``add esp,0x200`
```

  

  

八、打开代码注入器，加载游戏，点击注入，发现人物开始走动

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

  

九、获取游戏及相关工具下载地址

关注逆向有你公众号，回复：20220504

 ![](http://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0ouQQFouib41PSeoKKZO7mHSXDQ01XdAqPlLVKZD1yyPlfnErolowiaaDic5GDnU7B2GNhkou8PGqaCQ/0?wx_fmt=png) ** 逆向有你 ** 分享一些Android逆向，PC逆向及游戏辅助等相关学习笔记。。。 20篇原创内容   公众号