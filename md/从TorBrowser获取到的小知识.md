<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/520GLXS6l34xNi2PyMUfWw)

为什么写下这篇**水文**推文？

主要是我看到一位大佬发的文章，记录一下从文章中获取到的知识

手动@N10th大佬//[狗头]

TorBrowser基于Firefox
===================

为什么号称全球最安全的浏览器与Firefox有着不可密切的联系？

N10th大佬在文章提及到Tor的User-Agent信息

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoHH02icRSFcXCDAbxGjL9icPwPaTLKvvIguYYDrhw49g9R5taCy2eoiang/640?wx_fmt=png)

Firefox的User-Agent信息

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXocSoBv3rpvWxq8hdWicu8teVgqmsCmwKicPGTHg9X1dCibzRWcxLrVEDNw/640?wx_fmt=png)

当时就很疑惑Tor后面的Firefox，是什么原因和Tor和Firefox有关？

直到查阅Tor官网：Tor是基于Firefox的，是Firefox旗下的一个顶级项目

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoO8hVd9C0ibdHOf7XPZJI7uDQ1V08tULQA3DP1LxNDaGjOeQgCQ6iacEg/640?wx_fmt=png)

  

延伸360极速浏览器与Google浏览器

360极速浏览器

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoEcYKdybUib9EnkePu3GTian0LxceLsM3YEAiarIYIXgPbXFiaPJX4OtQkg/640?wx_fmt=png)

Google浏览器

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoRaEibKkvQ1KibKtRDQQiagzKDwO32oJ6zkHPjKPl9oIeENKT8fnULibcTw/640?wx_fmt=png)

维基百科：

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXosicI5iaZN3n3oOLJibkZ5kKJoJTAljOKicy1ER1Gn37dpRaRxWaCzCwjIg/640?wx_fmt=png)

  

  

同时去访问ip138访问得到的IP地址也不一样

Firefox：

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoNYDuI6xnWUj0OiaicVqPuxnicPhS7q3QcYW70JS1wdMCwxlH0uANoG4lA/640?wx_fmt=png)

Tor：

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoz0vx5u5mBrWEJBKhG31vjzA87paBDBJEZlq7UXHBf2RyWztjjNyPHw/640?wx_fmt=png)

  

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXo12CjP8KX5VhfrcelpiaARKfsicZeibRib9ScFibN8qiaCGqicVoiaytZgXu92g/640?wx_fmt=png)

  

TorBrowser之保留地址转换
=================

  

首先我们先了解一下什么是保留地址，

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXopsFSEMQ9Z3cDWqhpNp5zFgEz3KhKlsE2ib5Yic3Carbaf7E0ib0b1dIwQ/640?wx_fmt=png)

保留地址主要在以下几类：

**（注意！注意！注意！这里说的是IP的保留地址）**

A类：10.0.0.0－10.255.255.255（本地局域网）

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXo9ib9oIKVyVII0hjVxOk7oeWuKDQ9cbl2libc3lp21E4mIgIzMDVWqK5g/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoAadkEB6baJ02OQp7v5ia39Jhvvm1r9TGicrBKEgd1PtlpicDhCPmnZBOA/640?wx_fmt=png)

A类：100.64.0.0－100.127.255.255（保留地址）

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXojor7sp6ma2C7O6qqRLCK0YMia3tOzsiaTibFMeCgj1zUyicVzrQ4hcSHqw/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoHEkUFuNTMq3lVlYh1loVTVIPaP7qMsps3ibf1gzaljZiaeHsbdicicGYuA/640?wx_fmt=png)

B类：172.16.0.0－172.31.255.255（本地局域网）

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoAJibh3S86vxIhhic630xhjTEahFDXcQh1aF9PHrpBSCRJsT2mDxhzqlw/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXorM7uPaD4nibibhlsQvP2ymqOGgED1UL72zubiaGD21IOeVvS5hSrD4aFg/640?wx_fmt=png)

C类：192.168.0.0－192.168.255.255（本地局域网）

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXo6JvzQrMPXys2yY17NQFGmorDPyCjfGdu72Gw2RvLwRFicpb2lnmkaNQ/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXo8oztz6Xwia9pxlXKtVYw7icURTlV5YJsewvEtFIr9lxZ3QB0VRajdBSQ/640?wx_fmt=png)

还有不常见的两类：

D类：224.0.0.0－239.255.255.255（组播-保留地址）

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXod9ekiatGLYIHL5spYeIrmThOXRX1Hy8eGZlric84RkoiaCwYJpGryc05A/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXobWtBRFnSgZ4v8DbicfpkBOGGgnP49ibK7yzXWTqHPwHDEBEzmDamt6fA/640?wx_fmt=png)

E类：240.0.0.0－255.255.255.255（保留地址）

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoO0D3HdfZ2ia3ia1g7JEwD6hQLQxia98TPumvAp5GN4bBjwx8khjutuXxQ/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoErUdwPdj488feKg3xAsAEIbGwNCJXQwg6Eats6hECnnYbWibkCfwzaA/640?wx_fmt=png)

关于保留地址的转换N10th大佬找到了一篇国外文章，根据图片的页面信息，我也找到了这篇文章。

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoeHBIrugELRVHwoPImheVz3uVibLmkCicibLibh5xgqUph4aIbQR1YfplMw/640?wx_fmt=png)

这篇英文文章大致的意思是利用Tor中继搜索，可以搜索到一个IP地址，然而这个IP地址的反向地址，就是数据包中所呈现的保留地址

当我再去搜索的时候发现并没有搜出结果

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoQXS3snuEtXibicIR3icyxJn9m07cxuhfP9Ow27Kia89EekwBNXEbWibVIUA/640?wx_fmt=png)

猜测是此Tor host`$205ECC49B5BB5230BA0D2F5A0FC1117E391F9825`

已经失效了（毕竟原作者写这篇文章的时候是2017年）![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoQq8fSIfsTbwwyg84vhgMdqxfmQHgfFBn7O23yiafTOic5ceEkciaZ962A/640?wx_fmt=png)

  

然后作者又说到

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXo0QtXosGhkb56rMpUFGfxAX1ibp4Ycv6eG5BcP9ibQO6jqeVia8fS4jQ2A/640?wx_fmt=png)

大意是：有些反向地址是不以E类的保留地址的范围开头。我可以发现它们，因为 IP 地址指定的主机不是有效的 Tor 节点并且没有运行任何服务。

但是，反向地址是与指定签名匹配的已知 Tor 节点。

  

后续原著作者又写到了关于小端模式和大端模式，知识盲区= =

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoibPRwFMibnoDlD5iayCVexpQyxJG97YAwUBUo1yCZjmsushTgxcThCwdQ/640?wx_fmt=png)

作者说对方像是使用了小端模式**(Little Endian)**，而不是大端模式**(Big Endian)。**

并且作者查看了Tor守护进程的源代码，也没有发现利用小端模式这样的情况！也许的自定义的代码所生成的IP地址。

所以什么是小端模式，什么是大端模式呢？

以鸡蛋为例，大的一头为大端模式，小的一头为小端模式

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoibtuC2UUMu7oXAAI2PiaQXia4zzzBLgS5dlTrAfgibRL2O8icZr5eBhnURg/640?wx_fmt=png)小端模式**(Little Endian)**：低位（字节/比特）放在低地址中，高位（字节/比特）放在高地址中。

大端模式**(Big Endian)**：  低位（字节/比特）放在高地址中，高位（字节/比特）放在低地址中。

  

如何判断系统是Big Endian还是Little Endian？

一般来说，LittleEndian系统BYTE_ORDER(或_BYTE_ORDER,__BYTE_ORDER)为1234，BigEndian系统为4321。

大部分用户的操作系统（如windows, FreeBsd,Linux）是LittleEndian的。

少部分用户的操作系统（如MAC OS ）是BigEndian 的。

本质上说，Little Endian还是BigEndian与操作系统和芯片类型都有关系。

  

说到了小端模式和大端模式，就不得不提到`114.114.114.114`和`8.8.8.8`这两个通用的DNS服务器了

为什么说是通用？

①不管这两个地址怎么反转都是原先的地址；

②这里的通用指的是大端模式机器和小端模式机器的通用，因为可能有的机器采用大端模式，有的采用小端模式。

TorBrowser最后的发现
===============

不知道大家有没有发现Tor在浏览网页的时候，所有的网页内容都是显示如下图中的内部红框

![](https://mmbiz.qpic.cn/mmbiz_png/khmibjLuVibFDwgTm1fsjC6hiciaxDf7ibvXoafOEszM0El4Pru2OqzectmFyJAqicBQKX6LupnU0WMPsv90dwsm699g/640?wx_fmt=png)

为什么Tor要大费周章搞这么一出？

清晰记得一年前看一位师傅的视频中有提及过关于浏览器窗口大小的安全隐私，就是说如果使用Tor以外的浏览器访问页面(默认网页最大化)，攻击者可以利用JS或者HTML读媒体判断受害者当前网页的分辨率大小，后续进行一系列的隐私窥探等等。

也不知道是不是真的，我保持敬畏的态度.jpg

所以推测Tor大概也是这么个情况吧，把浏览网页的分辨率直接固定在某一区间内，不愧是你Tor。