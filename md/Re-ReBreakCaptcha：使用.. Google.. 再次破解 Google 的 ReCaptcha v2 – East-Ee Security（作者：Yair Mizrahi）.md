> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [east-ee.com](https://east-ee.com/2022/02/28/1367/)

> TL;DR 一个 5 年后起作用的逻辑漏洞，称为 ReBreakCaptcha，可让您轻松绕过......

**TL;DR** 5 年后出现的一个逻辑漏洞，称为 ReBreakCaptcha，它可以让您轻松绕过网络上任何地方的 Google 的 ReCaptcha v2。

**验证码概述**
---------

我们中的许多人都知道 ReCaptcha，即 Google 的人类识别程序。  
它有两个版本：v2 和 v3。

v3 不是我们在这篇文章中的重点，因为它根本没有用户交互，只会导致没有验证码挑战的分数。  
v2 有两种类型：“我不是机器人”复选框和 Invisible reCAPTCHA 徽章。  
我们将专注于第一种类型，因为它具有所有挑战。  
（[https://developers.google.com/recaptcha/docs/versions](https://developers.google.com/recaptcha/docs/versions)）

ReCaptcha v2 挑战有两种类型：

图像挑战 – 挑战包含描述和由 16 个子图像组成的图像。要求用户选择与给定描述最匹配的那些子图像。  
音频挑战 - 挑战包含录音，要求用户输入听到的单词。

Re-ReBreakCaptcha 知道如何使用 Google 自己的服务解决 ReCaptcha v2 音频挑战！  
因此，我们需要一种如何每次都获得音频挑战的方法。

当点击 ReCaptcha v2 的“我不是机器人”复选框时，我们经常会看到以下挑战类型：

![](https://eastesec.files.wordpress.com/2022/02/untitled1.png?w=476)图 1：图像挑战

要获得音频挑战，我们需要单击以下按钮：

![](https://eastesec.files.wordpress.com/2017/02/audiochallengebutton.png)图 2：音频挑战按钮

然后我们会遇到一个可以轻松绕过的音频挑战：

![](https://eastesec.files.wordpress.com/2022/02/untitled2.png?w=345)图 3：音频挑战

有时，由于 Google 具有自动检测功能，因此会显示错误消息，而不是音频质询：

![](https://eastesec.files.wordpress.com/2022/02/2022-02-24-20-11-51.mkv_snapshot_03.28.53.333-1.png?w=372)图 4：自动化检测到的错误

我们将尽最大努力避免它并绕过它。  
几分钟冷却时间的简单睡眠就足够了。

3 天前，“The Verge”发布了一篇关于验证码的文章：  
[https ://www.theverge.com/2019/2/1/18205610/google-captcha-ai-robot-human-difficult-artificial-intelligence](https://www.theverge.com/2019/2/1/18205610/google-captcha-ai-robot-human-difficult-artificial-intelligence)

它认为验证码越来越难以被人类解决，但算法正在变得越来越好。谷歌似乎是问题本身的一部分。  
另外，感谢 Josh 间接提及 ReBreakCaptcha！

**2017 年 ReCaptcha 绕过**
-----------------------

早在 2017 年，我就发布了一种以 93% 的成功率绕过 Google 的 ReCaptcha v2 的方法——ReBreakCaptcha。  
请参阅此处的帖子：[https ://east-ee.com/2017/02/28/rebreakcaptcha-break-googles-recaptcha-v2-using-google/](https://east-ee.com/2017/02/28/rebreakcaptcha-breaking-googles-recaptcha-v2-using-google/)

Re-ReBreakCaptcha 分三个阶段工作：

1.  音频挑战 – 获得正确的挑战类型。
2.  识别 – 转换音频挑战音频并将其发送到 Google 的语音识别 API。
3.  验证 - 验证语音识别结果并绕过 ReCaptcha。

之前的帖子促使谷歌迅速做出反应，并在短期内采取了严厉措施加以防范。  
已经5年了，所以我决定重新审视这个项目并检查一下。

截至发稿时（28/02/2022），已确认此漏洞在对代码进行一些小改动后仍然有效，**成功率高达 98%——比原来的要好**！

**背景故事**
--------

原帖发表几天后，就获得了大量流量并登上了头条。  
Google 注意到 PoC 已在 GitHub 上运行，因此他们采取了行动。

他们只解决了几个音频问题，就将易于解决的音频挑战（4-5 位数）替换为更难的变体。  
那些更难解决的音频挑战更长（10-12 位数）。  
它们还包含非常糟糕的背景噪音，有时无法手动解决。

2017 年 3 月 3 日，我宣布 PoC 不再可用。  
开始摆弄使用两者之间的静音来拆分音频数字，但成功率较低（低于原来的 97%）——因此决定就此搁置。

在接下来的几年里，许多研究人员的研究都基于我的研究（一个团队甚至根据这个概念撰写论文）。  
有些有一些小的调整，有些有更新的机制。  
谢谢你，我很荣幸。

这包括：  
2017 年 10 月[https://www.reddit.com/r/netsec/comments/78nbmu/code_release_defeating_googles_recaptcha_with/](https://www.reddit.com/r/netsec/comments/78nbmu/code_release_defeating_googles_recaptcha_with/)（在此发布后，Google 决定将音频挑战从数字音频升级为短语音频）  
12/2018 [https:// www.reddit.com/r/netsec/comments/ab94o0/code_release_uncaptcha2_defeating_googles/](https://www.reddit.com/r/netsec/comments/ab94o0/code_release_uncaptcha2_defeating_googles/)  
08/2019 [https://www.digitalwhisper.co.il/files/Zines/0x6D/DW109-3-reCAPTCHA.pdf](https://www.digitalwhisper.co.il/files/Zines/0x6D/DW109-3-reCAPTCHA.pdf)  
05/2020 [https:// /www.reddit.com/r/netsec/comments/gpcic1/bypassing_captcha_with_visuallyimpaired_robots/](https://www.reddit.com/r/netsec/comments/gpcic1/bypassing_captcha_with_visuallyimpaired_robots/)  
01/2021 [https://www.reddit.com/r/netsec/comments/kp7p79/break_the_google_audio_recaptcha_with_googles/](https://www.reddit.com/r/netsec/comments/kp7p79/breaking_the_google_audio_recaptcha_with_googles/)

**那么发生了什么变化？**
--------------

我想已经过去了足够的时间，并试图再次戳它。  
谷歌在音频挑战的开头和结尾添加了一些噪音——但似乎他们没有将其用作指纹来防止这种绕过技术（即使没有拆分单词！）。  
对原始 PoC 做了一些小调整：

1.  更新到 Python 3（特别是 3.7+）。
2.  更新以支持新版本的 Selenium 4。
3.  对绕过 ReCaptcha 自动化检测的逻辑进行少许调整。

以下是更新的 PoC 的链接，它是 ReCaptcha v2**的全自动绕过：**  
[https ://github.com/eastee/re-rebreakcaptcha](https://github.com/eastee/re-rebreakcaptcha)

一段视频显示了使用 PoC 成功解决了 100 个音频挑战，成功率为 98%（x30 速度）：

Re-ReBreakCaptcha PoC – x30 速度