> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/_jm7nLC8MDHKfuAppY5a6A)

往期文章

[安卓逆向 -- IDA 基本用法](http://mp.weixin.qq.com/s?__biz=MzA4MzgzNTU5MA==&mid=2652024870&idx=1&sn=c1128ab7066fe35ca928e0ae19f2a450&chksm=84167f8fb361f69977a03082dbe9007dfe357820f8e2620b0790fa4b1fc735ece0587bb08e26&scene=21#wechat_redirect)

 ![](http://wx.qlogo.cn/finderhead/PiajxSqBRaEJ7Ik2tcpu1fLbiceIMq8ALz06e9g1ENj06MEeFBG1snVQ/0) **之乎者也吧** ， #安卓逆向 #IDA# 动态调试 视频号

一、前言  

上节课已经分析出了关键函数，这里只要在关键函数下断，然后，动态调试就可以获取想要获取的数据

二、IDA 动态调试步骤

1、将 IDA 目录 dbgsrv 文件夹下的 android_server 复制到真机

adb push ....as /data/local/tmp

2、执行 android_server

adb shell 进入手机操作模式

cd /data/local/tmp 进入到 as 所在的位置

chmod 777 as 给 as 可执行权限

./as 执行

3、转发端口

adb forward tcp:23946 tcp:23946

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgUcEK5aibzDBzfiapAdVychPMiaraKia5JVaYSNfFUq6cibVHBuIT3p4YyjA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgib5Z3xe34L7QzKia93nFvE74czQWYsatsKicSAzSSlEribOuTBwWWPNRVQ/640?wx_fmt=png)

4、启动 IDA 附加进程

Debugger--attach--Remote ARM Linux/Android debugger

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgk7TIGNnNASaolx1bjYAia1AyUqRzZNcxKmktyRVYIOoCOYCOoCz7p5w/640?wx_fmt=png)

5、设置本地 IP 及上面设置的端口号 23946，点击 ok

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgicNJfZp1rwPzG0ufb9nIzupIct1AwoFxckEBvq1UlD5dHZI1dgj5sRw/640?wx_fmt=png)

6、选择要调试的进程名字

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgqs0mfUz6lOGPcX5S5HSgMLvLvqVicibVOdUwajeIgIYcApnE6rFecUOg/640?wx_fmt=png)

7、点击运行，让程序跑起来

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgvHTuPNaUpbx7wR9W1XehkoqqiatlDd5KTr44jtdKtxYTsyf2J9fu3Ow/640?wx_fmt=png)

8、从 Modules 模块，选择要分析的 so 文件及 getSign 函数

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lg9PxC7tMvWlGC7aiaDBH4fLdxP7kduEnBqyQgEXtvtFfxct3qia69UyPg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgeHohG8a1lUcic7kfxFw8nrb5YhjruAibvXJwq3wt2eu2iaE4HEgEeJFWg/640?wx_fmt=png)

9、函数名都变成了 unk 开头的，所以需要结合静态分析，记住偏移地址

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgF6uBV6fGib3AMZiblmz5s3JhOPzsicgl0FiaRIIKvfq3vKqyc2VA2Bx9fQ/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgxibolT10cibI2iacJ1OETIXaib23YS9BB2jic1XxAmxkicnLsLqWm8X3kNrA/640?wx_fmt=png)

10、所以我们需要在 B3556A56 处下断，这就是我们分析出的函数地址

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgOWHA57f5iajg1uJlSr06CiaIpJIm0Wib6tiaRCXhEOqC8MhCiaEbsQoVwCQ/640?wx_fmt=png)

11、在数据窗口查看 R0 寄存器，右击数据窗口，选择 Synchronize--R0

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lghdfgZlDAy8YUicIKZicegt9NsXPOEYYbbxb8aHfaxPbON3tXaLBbRdsQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lg2ibKX6Aeib2ToQeckaP5B3mMnUW7prlXdSBGEiahSPu2uXg5k574VLJOA/640?wx_fmt=png)

0093CB6721DAF15D31CFBC9BBE3A2B79 1634609878317

0093CB6721DAF15D31CFBC9BBE3A2B79 1634621200870

12、查看 R1 寄存器 2D，十进制是 45，正好是上面取出来的位数

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgG0VqXjXX2iasIvfBNSpovrGxSrn8nj74SpcT9jdD9PEXILFuGCORicWg/640?wx_fmt=png)

13、查看数据窗口中 R2 的数据，按 F8 单步执行，里面的数值发生了变化

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgjKg9MJMEia2tTw96VJ5jESX3OoaZicyicicuRIVASvSxH07s6HNY9CFT4g/640?wx_fmt=png)

14、将上面的数据进行 md5 运算，正好是执行后得到的数据

45 E9 08 4E  5B D8 5B 94 B5 C5 98 13

3E 90 09 1F

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgoFoYicMxjIwg7Vh2oNZsa7ib9kFfLK0GAyhibc0xplm2fQ1tGaZyibAHUQ/640?wx_fmt=png)

寄存器

SP：栈寄存器

LR：保存函数返回地址

PC：当前运行到的地址

R0-R3：用来放函数的参数，执行完后，R0 存放返回值

R4-R7：用来放函数的局部变量

禁止非法，后果自负

欢迎关注公众号：逆向有你

欢迎关注视频号：之乎者也吧

欢迎报名安卓逆向培训，报名微信 (QQ)：335158573

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgbL5zHWtS5QVcPNsK0icdCmur6ibgQENWq6AMYcT6cldyqU9pOqicibwWlg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0q7iarlQqwxtD69XHtK5w8lgMib3QGib7lmdbVZEOjPY8iaXxZYSopVZX7pfdRu4m3b5ZfQlOUQWXIwicg/640?wx_fmt=png)