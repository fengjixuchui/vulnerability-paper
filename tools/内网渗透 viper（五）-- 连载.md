> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/KQ2cTrFyvmp-NYY30uFGLw)

Behinder 与 Viper 联动
===================

**测试基于** **Behinder_v3.0 Beta 7** **版本**

目标主机不出网 & 上线 java 版本的 meterpreter
=================================

116.85.xx.xx 是 Viper 的 vps 地址

*   Behinder 已经正常获取到目标的 webshell, 可以正常执行命令
    
*   在 Viper 中建立对应监听
    

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1iaQ3ZAUNdDEiaQJ8brxPydIiaeOOyPX0gqOtoXWianIbCicf4jhgh3xM5ibA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1WtlnS95yhgtRp44EHwwvQBFrKLFUIEcOOklA8JCbqGdZj4DkicBPhHQ/640?wx_fmt=png)

*   Behinder 中切换到 `反弹shell` 按照如下配置
    

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1SpicRicFic5EGaX7VMVH2nwx9ckDZBZ0JGbkyc3UFpueAticIZsd4rXYUA/640?wx_fmt=png)

*   执行后即可获取 java 版本的 meterpreter
    

上线的原理

Behinder 会在目标主机 9090 端口建立监听, 通过 Behinder 客户端网络 (也就是你的 PC), 将该端口映射到 116.85.xx.xx 的 9090

目标主机不出网 & 上线原生版本的 meterpreter
=============================

java 版本的 meterpreter 缺失了很多功能, 原生版本的 meterpreter 更加强大

*   Behinder 已经正常获取到目标的 webshell, 可以正常执行命令
    
*   Behinder 中切换到 `内网穿透` 按照如下配置
    

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1mViaAASOql30GDWhqSUkEAnhZ8qpLjra3wNQOAsItbNvbK32Ghia4sjA/640?wx_fmt=png)

*   Viper 按照如下配置建立监听
    

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1YcbYWC2nIpYFibmicLjgSxYcjibhNWpU1mcMiankSiaCU8iatZictSyuT5bYA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1n1pkIcEHgoib4D5d52fqkXiaWBYD0lSdIIjgiaR24KQgGZtAibyCg0JmcQ/640?wx_fmt=png)

*   Viper 按照如下配置生成载荷, 请仔细阅读下方说明
    

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1m0E8ESRic2Fb47IQmHgcIoG06axd0LT5rdsNeoINJdI0QDr8vFlmQng/640?wx_fmt=png)

LHOST 填写为已控主机的内网 IP 地址, 或者填写 127.0.0.1

LPORT 与 Viper 监听, Behinder 配置一致

RC4 密码一定要与监听配置一致

*   将生成的载荷 (exe) 通过 Beninder 上传并执行即可
    

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1O4qeibInVy9icc0yXXao1NcaRiaibEqnCfDe4NgPXpvhCPJWwL2EB0zPjg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/0JWssWBbxkK4PRDyCbhMVQ6F5DYGXtm1dOIRPVTKLHDefIAufFS1jAqvaLHkbumUkDywcGlxDalicAaDfiauhxQA/640?wx_fmt=png)

上线的原理

Behinder 会在目标主机 2222 端口建立监听, 通过 Behinder 客户端网络 (也就是你的 PC), 将该端口映射到 116.85.xx.xx 的 2222

Viper 生成载荷连接目标主机本地的 2222 端口就等同于连接 VPS116.85.xx.xx 的 2222 端口

文章来源: https://www.yuque.com/vipersec/blog/qfgx3k