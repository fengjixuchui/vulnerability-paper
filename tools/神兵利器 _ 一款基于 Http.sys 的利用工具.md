<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/a5PZOnGji3h3UhN0udp_PA)

**工具原理**

利用 Http.sys 驱动对 urlacl 进行操作，由于 Http.sys 是 IIS 服务器的基础，其优先级高于 IIS，不会造成端口绑定冲突，达到端口服用效果，由于与受害机对外服务端口相同，可做到极高的隐蔽性。由于其生效后效果很类似于 LOL 的小丑，故起名为 Joker。  

**使用方法**

此工具的使用前提是：管理员权限、IIS 环境  

**1. 基于路径进行复用**

```
Joker.exe "http://*:{PORT}/{PATH}"

```

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVUKGnFwgFiciaptUx5lApxpfFCx7mIOoqPUhCPwEx4kRlHvVv7IEgLm4cQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

可直接使用蚁剑进行连接，配置如下：  

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVUW2iafDfooG99VU4wLb1LX216qreYGRQVPDIAyeOJSqnDa9XPguicVwMw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

连接密码随便填写

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVUSZnXc76qr0kv3R9zpVShjsFLnufv5IRVrsbI0qNCoYaQJzufE6WuHA/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**2. 基于 HOST 进行复用（强烈推荐）**

```
Joker.exe "http://{HOST}:{PORT}/"

```

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVU4eiaMyYA35TWjfOFL6PY8JF8JCIK3HelozKHdZq8rgj0qMrWPHz6Icw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

蚁剑配置如下  

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVUFHOuXlichHMbCvribk4xZWs1PM3jMXoGOGp6vsdXQr9B6ZevAGoEibTSg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVURDCv5qyLTOmhz9KpUwKlDo4QYakdjgmTytSpiaHKGZuVNqAZ5OrzMPQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

这样，在正常访问 80 端口的时候为正常业务，在带特殊的头访问 80 端口的时候则为后门程序。  

**3. Regeorg 适配**

项目 JokerTunnel 为对 Regeorg 适配版本。  

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVUoBzNmXVC1va2qbju8PAycFcWJicibonQf9ACyW4iaHic4JdDTBb2RgEynQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVUISDqaCzOxVOtbPS07ELlwgbmu6GpJQFM4IA4BJticEA9ELXUnv6qzkw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

客户端使用 Regeorg 进行连接即可  

**二次开发**

此项目的 handle 都集中在 handle.h 当中，以执行为例，传入参数依次为 Request 的 body、RequestBody 的长度与响应内容的指针  

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6ucHEMFZC3swy8WHgAXHtKVUjgEpFODyU1tFic1o2aycrpxBXFvdErX4NorZZyUacicyv9LZvZAejGGg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**下载地址**

**点击下方名片进入公众号**

**回复 “****0824****” 获取下载链接**