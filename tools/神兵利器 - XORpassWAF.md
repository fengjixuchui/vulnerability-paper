> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/gUPcpO8ou9MQHQ-ezg8hPg)

        XORpass 是一种使用 XOR 运算绕过 WAF 过滤器的编码器

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2ctaTwdUp34qiaYYQGKFLE7BsENs1fWVoNGGCOO4k92s6rp9UvR2a5DNzPzqyUY0qfodJcmOKMhBQ/640?wx_fmt=png)

安装

```
git clone https://github.com/devploit/XORpass
cd XORpass

$ python3 xorpass.py -h
```

使用清除 PHP 函数：

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2ctaTwdUp34qiaYYQGKFLE7fLBVanNpGAID2gSHoCiaCx66pIibcu9SfvoKLdImrw8zvbFwnW6eU9Xw/640?wx_fmt=png)

使用该函数的 XOR 绕过：

```
$ python3 xorpass.py -e " system(ls) "
```

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2ctaTwdUp34qiaYYQGKFLE7U98zrhgdaMNyn9dexibhXhMUmQMZ70xdCY5p3yvT5dBl64hVJReuJ7A/640?wx_fmt=png)

#### 为什么 PHP 将我们的有效负载视为字符串？

^ 是异或运算符，这意味着我们实际上是在处理二进制值。那么让我们分解一下发生的事情。

二进制值的 XOR 运算符将返回 1，其中只有一位为 1，否则返回 0 (0^0 = 0, 0^1 = 1, 1^0 = 1, 1^1 = 0)。当您对字符使用 XOR 时，您使用的是它们的 ASCII 值。这些 ASCII 值是整数，因此我们需要将它们转换为二进制以查看实际发生的情况。

```
A = 65 = 1000001
S = 83 = 1010011
B = 66 = 1000010

A       1000001
        ^
S       1010011
        ^
B       1000010
----------------
result  1010000 = 80 = P

A^S^B = P
```

如果我们做一个'echo"A"^"S"^"B";' 如我们所见，PHP 将返回一个 P

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2ctaTwdUp34qiaYYQGKFLE7Rk1wF9N0o0vGE0u0WExiagrR2h2kPMSqrKySNiaicZgZsJe3cTsG2p0sA/640?wx_fmt=png)

项目地址：

https://github.com/devploit/XORpass