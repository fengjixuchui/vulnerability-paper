<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/zNP9nFueyxGuwVnRwuWrSg)

关于 TideFinger
-------------

2020 年的时候，从网上整合了大部分常见的指纹库，参考了一些比较不错的指纹识别工具，写了一款开源的指纹识别小工具——TideFinger，并使用了传统和现代检测技术相结合的指纹检测方法，让指纹检测更快捷、准确。

TideFinger 项目地址：https://github.com/TideSec/TideFinger

搭建了一套在线指纹识别平台：http://finger.tidesec.com/

当时还写了一篇关于指纹识别的文章：https://www.freebuf.com/articles/web/202560.html

指纹工具发布之处，也想着能定期的更新指纹库，但后来忙起来后就陷入了无限期的拖沓。同时也发现靠自己去维护指纹库有些不太现实，花费时间和精力都比较多一些。所以后来自己写一些小工具用到指纹的时候，就开始集众家之长，不再重复造轮子，很多东西都是拿过来直接调用然后解析结果就可以了。

所以在 2021 年上半年的时候，对潮汐指纹平台进行了更新，加入了很多新功能：[https://mp.weixin.qq.com/s/ctrWPQ8NNdc6NwLrkKa3Xg](https://mp.weixin.qq.com/s?__biz=Mzg2NTA4OTI5NA==&mid=2247489480&idx=1&sn=32ce70f78a5ed2d90edd72aa2a6b83e0&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFyMGTpA6A67t0fusKbs4mvFLkj2NWSCb9bRukUtgTiaQIt2EhYGKFqzRA/640?wx_fmt=jpeg)

但是后来由于各种不可说原因，部分功能又被下线了。后来很多小伙伴在后台问能不能开源之类的，所以才有了这次对 TideFinger 进行了一次升级完善。

主要完善点
-----

1、完成了 python3 的代码升级。之前使用 python2 实现的，现在 github 里包含了 python2 和 python3 两个版本，可以根据自己环境去选。

2、升级了 tidefinger 的自身指纹库，2020 年的时候指纹大约为 2100 条，目前指纹文件`cms_finger.db`已包含大约 5900 条指纹。

3、引入了 Wappalyzer 指纹库，使用了 python 版的 Wappalyzer，代码来自`https://github.com/chorsley/python-Wappalyzer`。

4、引入了`webanalyzer`指纹库，这个是国内一群安全爱好者做的一个很不错的项目，项目地址`https://github.com/webanalyzer/`，里面的 role 也集成了 WhatWeb、Wappalyzer、fofa 的规则等。

5、因为多个指纹库都会有部分重合，所以后面对识别到的指纹进行了简单的去重处理，并对部分常见的误报进行了优化。

6、py2 版本中在无法识别到 cms 时会默认使用数据库文件遍历的方式进行进一步指纹识别，但这样会对目标站点发起大量请求，我现在已经基本不大用这种方式，所以 py3 版加了个 - d 的选项，0 为不启用，1 为启用，默认为不启用。

新旧版本对比
------

python2 版：

![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFyaHd7qsA2kv6ww8xAs0FHtTCpENauWiciaicuF4Xe5upvxwnjumPSjjoAw/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFy59Lic10E2I49SkicliaiaZXouJVFiaNhOEVGZTvyhib80Gg4icYhqK45XeXlQ/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFyrHMJp07JAAXKFV5KtYordiaVM3X6MsrTgdjsrERofwQYoFZkCKfS6Mw/640?wx_fmt=jpeg)

python3 新版：

![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFyK0ANQF1ns4IRPdV5z3cRKOG9EcJVPA9XoDknZfXnGYG1tKSxbsksKw/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFyxgBsB6Hx9N8hOwoJARUYNJpoS2YqU3JLVgCKicZTpaFKgZUgzX8tSiaQ/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFyrfRicsxa8ZLJ0zuvmK0Nxn760pxnGy0At3iaywxEyrnOarfJr1KWicWaA/640?wx_fmt=jpeg)

python3 新版本获取的指纹更多，默认对目标发送大约 4-5 个数据包，而且都是没有攻击特征的，相对来说还是是可以接受的。

![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFy8OSfIy96NZdUwZqO0uBBicRYvSMwiaac1jNJhZFFYSNu5aOtufoKLMOw/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFyHohRwxZVbqHbmuGcKRb5dTsY8QZP3R3VDsibU8d4HtyDzmYWlibvMouQ/640?wx_fmt=jpeg)

下一步打算
-----

现在也开始计划能用 Go 重写一下指纹识别工具，Go 的一些特性的确也适合做这些。目前`novasec`团队的`酒零`大佬开发了一个增强版的 whatweb：`https://github.com/winezer0/whatweb-plus`，现在也在召集人马准备用 Go 重写 whatweb，希望感兴趣的小伙伴可以一起参与。

现在写一些红队小工具也越来越看重指纹识别的效率和精准度，这决定了你的自动化攻击流程的下一步走向，特别是在一些框架类和通用 CMS 的识别上。

![](https://mmbiz.qpic.cn/mmbiz_jpg/rTicZ9Hibb6RWT7b6ia8Bg3SyKUfhDhdWFynuFpJ5OuFkT1SY76Lk1R5SJo1TcY1ibiaUJp3In4LQQs3D030eLIUCCg/640?wx_fmt=jpeg)

感谢
--

这次升级主要是引入了一些其他优秀工具，再次表示感谢，包含并不止以下优秀项目和工具。

https://github.com/chorsley/python-Wappalyzer

https://github.com/webanalyzer/

https://github.com/winezer0/whatweb-plus

https://github.com/urbanadventurer/WhatWeb

https://github.com/AliasIO/Wappalyzer

https://github.com/se55i0n/Webfinger