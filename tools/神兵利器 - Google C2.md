<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/s-kTSwRHh9Dudr7H5dz8Fw)

![](https://mmbiz.qpic.cn/mmbiz_gif/3xxicXNlTXLicwgPqvK8QgwnCr09iaSllrsXJLMkThiaHibEntZKkJiaicEd4ibWQxyn3gtAWbyGqtHVb0qqsHFC9jW3oQ/640?wx_fmt=gif)

 Google Calendar RAT 是基于 Google Calendar Events 的 Command&Control (C2) 的 PoC，该工具是为那些难以创建完整的红队基础设施的情况而开发的。要使用 GRC，只需要一个 Gmail 帐户。该脚本通过利用谷歌日历中的事件描述创建一个 “隐蔽频道”。目标将直接连接到谷歌，它可以被视为第 7 层应用程序隐蔽通道。

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2J9ngs52auV2b05N1K9nBRe9vbgkUhKshVUgt7HDXFJibGxZSkntXYtRaByHkqiadyPuPNcSLv2peg/640?wx_fmt=png&wxfrom=13&tp=wxpic)

        GCR 尝试连接到有效的共享 Google 日历链接，并在为任何尚未执行的命令生成唯一 ID 检查之后。如果找不到任何命令，它会创建一个新命令（固定为 “whoami”）作为连接证明。每个事件由两部分组成：

        包含唯一 ID 的标题，这意味着您可以安排多个命令创建具有与名称相同的唯一 ID 的事件  

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2J9ngs52auV2b05N1K9nBRWdhM7vlXCUovneGu9yFIiaZj7FJtVjRM6J5zbSYHHgiagYuE7wm8v8Vg/640?wx_fmt=png&wxfrom=13&tp=wxpic)

其中包含要执行的命令和使用管道符号作为分隔符 “|” 的 base64 编码输出

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2J9ngs52auV2b05N1K9nBRgk0dONibaxOCQ2VGvLibwFLBcDTicWYE5pu4KqSibULZQOsHVx6kn3BuibA/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

攻击流程

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2J9ngs52auV2b05N1K9nBRXfylFJwJ29iajFWvd80wDrm3iaA6RjVDyfvZhOKqJKQgGPADxVMpBexg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

唯一建立的连接将是谷歌的服务器，使连接看起来完全合法。

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2J9ngs52auV2b05N1K9nBRQBwTDcrxC47u8WNVGiatyv5lwadkMy3nHnYPvhtlhickUOibia0eiaM2G3Q/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV2J9ngs52auV2b05N1K9nBRfGpJMFOCzDA96U0hXf2kZNq6PBpDaCvLlWU1RrXLNTvaaXcGbqTVsQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

设置谷歌服务账号并获取 credentials.json 文件，将文件放在脚本同级目录下

创建新的 Google 日历并与新创建的服务帐户共享

编辑脚本以指向您的日历地址

一旦在目标机器上执行，就会自动创建一个具有唯一目标 ID 的事件，并自动执行 “whoami” 命令

在通信的事件描述中使用以下语法 => CLEAR_COMMAND|BASE64_OUTPUT

例子：

"whoami|"

"net users|"

日期固定在 2023 年 5 月 30 日。您可以使用唯一 ID 作为事件名称来创建无限事件。

下载地址  

https://github.com/MrSaighnal/GCR-Google-Calendar-RAT

> **文章来源：**Khan 安全攻防实验室 

黑白之道发布、转载的文章中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途及盈利等目的，否则后果自行承担！

如侵权请私聊我们删文  

**END**

![](https://mmbiz.qpic.cn/mmbiz_jpg/3xxicXNlTXL8fHInwic65QarBzLTDecgAlRicyRRNJu5ItVq0eGBmhibeaUEib2sMnAsOTOHicWtz7P2iaAeftdlNQGCg/640?wx_fmt=jpeg)

多一个点在看![](https://mmbiz.qpic.cn/mmbiz_gif/zYdFdnRZ0h95ZAL5c8h6iaMiaqbgljvZ80YraNgwWAtyyZRGT8INEgx8qWKgf9wXribCDNibDvDa2R1EQB4grqAKDg/640?wx_fmt=gif)多一条小鱼干