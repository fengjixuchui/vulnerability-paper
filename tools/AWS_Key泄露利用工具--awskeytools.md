<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/E61naI8ejK4XQyQQC3lsIg)

文章首发于：

火线Zone社区（https://zone.huoxian.cn/）

  

**准备**

  

**环境**

  

```
`linux or mac(windows不支持)``python version >= 3.7`
```

  

**地址**

  

```
https://github.com/Aabyss-Team/awsKeyTools
```

  

**安装**

  

```
`解压``cd awsKeyTools``pip3 install -r requirements.txt`
```

  

如果遇到 error: command 'x86_64-linux-gnu-gcc' failed with exit status 1 报错

**解决方案：** sudo apt-get install libncurses5-dev

如果在vps上使用不推荐Ubuntu18 , 因为python版本过低 , 虽然可以自己手动安装python3.8但是两个python3环境容易起冲突 , 推荐在kali上使用或者Ubuntu20

  

**使用**

  

第一次使用工具会提示输入ak

  

```
python3 main.py
```

  

输入你的aws_ak即可

  

**1.查看命令帮助**

  

```
`┌──(root192)-[~/桌面/awsKeyTools-new_dev (2)]``└─# python3 main.py` `__                   __                .__` `_____ __ _  _______|  | __ ____ ___.__._/  |_  ____   ____ |  |   ______``\__  \ \/ \/ /  ___/  |/ // __ <   |  |\   __\/  _ \ /  _ \|  |  /  ___/` `/ __ \     /\___ \|    <\  ___/\___  | |  | (  <_> |  <_> )  |__\___ \` `(____  /\/\_//____  >__|_ \___  > ____| |__|  \____/ \____/|____/____  >` `\/           \/     \/   \/\/                                   \/``                                                     version : 0.0.1` `by dbg9 and 无在无不在``aws-key-tools > help``Help:` `help - 查看命令帮助` `userinfo - 获取用户信息` `privileges - 获取用户权限` `ec2 - 获取所有地区的EC2（Elastic Computer Cloud）` `exec - ec2远程命令执行` `aws-url - 根据当前高权限生成aws控制台访问url` `reset - 重置aws_ak` `exit - 退出程序``aws-key-tools >`
```

  

**2.获取ak对应的用户信息**

  

```
aws-key-tools > userinfo
```

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**3.查看用户权限** 

  

默认查看的是用户对应策略的json文件

  

```
aws-key-tools > privileges
```

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

使用enum参数可以通过枚举查看用户的权限

  

```
aws-key-tools > privileges enum
```

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**4.枚举当前用户可用地区存在的ec2主机**

  

```
aws-key-tools > ec2
```

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**5.指定ec2远程命令执行**

  

```
aws-key-tools > exec
```

  

如果无法获取平台信息 , 需要用户手动输入  

如果当前ec2没有关联实例配置文件 , 会先检测是否存在实例配置文件 , 如果不存在就是创建 , 然后附加到ec2上

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

如果创建并添加报错 , 请再次执行exec , 此时不会创建会直接添加

如果存在已创建的示例配置文件直接附加

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

由于实例配置文件的关联需要一定的时间 , 所以约10分钟后 , 才能执行命令

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

输入 `exit` 退出当前命令执行

  

**6.生成aws控制台访问连接** 

  

需要当前用户有一定的权限才可以成功执行

  

```
aws-key-tools > aws-url
```

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**7.重置aws_ak**

  

提示用户重新输入ak , 当你获取到一个新的ak时 , 可以使用这个命令替换ak

  

```
aws-key-tools > reset
```

  

**8.退出**

  

```
aws-key-tools > exit 
```

  

**参考**

  

*   https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html
    
*   https://github.com/NetSPI/aws_consoler
    
*   https://github.com/andresriancho/enumerate-iam
    

  

**免责**

  

本工具仅面向合法授权的企业安全建设行为，如您需要测试本工具的可用性，请自行搭建靶机环境。

在使用本工具进行检测时，您应确保该行为符合当地的法律法规，并且已经取得了足够的授权。请勿对非授权目标进行扫描。

如您在使用本工具的过程中存在任何非法行为，您需自行承担相应后果，我们将不承担任何法律及连带责任。

  

  

**【火线Zone云安全社区群】**

进群可以与技术大佬互相交流

进群有机会免费领取节假日礼品

进群可以免费观看技术分享直播

识别二维码回复**【社区群】**进群

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**【火线zone社区周激励】**

2022.4.18～ 2022.4.24公告

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

**【相关精选文章】**

  

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=MzI2NDQ5NTQzOQ==&mid=2247493910&idx=1&sn=b95b19863a70534d7322f5e904b24dba&chksm=eaa96136dddee8208f725ed307d4d80c5269a0908a90cc1d0cd3de51cd907f279875dd4f6ee1&scene=21#wechat_redirect)

  

[![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)](http://mp.weixin.qq.com/s?__biz=MzI2NDQ5NTQzOQ==&mid=2247493826&idx=1&sn=0a9f0c160d730e735aedff4805a884d3&chksm=eaa960e2dddee9f4db1a2332a662d42aec58376891d96de6371f7fdb770b9e5d8d1580945340&scene=21#wechat_redirect)

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

火线Zone是[火线安全平台]运营的云安全社区，内容涵盖云计算、云安全、漏洞分析、攻防等热门主题，研究讨论云安全相关技术，助力所有云上用户实现全面的安全防护。欢迎具备分享和探索精神的云上用户加入火线Zone社区，共建一个云安全优质社区！

如需转载火线Zone公众号内的文章请联系火线小助手：hxanquan（微信）  

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

//  火线Zone //

微信号 : huoxian_zone

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

点击阅读原文，加入社区，共建一个有技术氛围的优质社区！