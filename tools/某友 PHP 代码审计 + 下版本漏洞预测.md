<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/RaDwZEffQ0pBOk1tAg_jxQ)

![图片](https://mmbiz.qpic.cn/mmbiz_gif/ofBa42GG7Shb736Qree8xzh3FalD631YYibvXXL5XzxAqPibEviaiaT2t9PxYxUvXbXfo1ibrCLEsawHjHxbvvr8AUg/640?wx_fmt=gif)

**前言：**前段时间热度挺高的一个系统存在 SQL 注入漏洞，升级后漏洞被修复了。  

开始前先对比了一下两个版本的 PHP 代码，关键代码没进行修改，没有对单引号进行转义，也没有使用自动转义函数，但是 GET、POST、REQUEST 传参还是被转译了。  

下面请允许我水一篇。

**0x01 问题描述**

测试环境如下：

172.28.113.153（2）

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMG9P49NAE9l87NrqlDkVSKicHibUJ2M14bOuViaB58O9icn9KSiaZf9dtgkw/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMG9P49NAE9l87NrqlDkVSKicHibUJ2M14bOuViaB58O9icn9KSiaZf9dtgkw/640?wx_fmt=png)

192.168.100.130（3）

![](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMkAB5ST8nC4pU9ZUibxWAF6CwoOwEqqGTeW3WIf7icYpGfZGMH0UgOM5w/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMkAB5ST8nC4pU9ZUibxWAF6CwoOwEqqGTeW3WIf7icYpGfZGMH0UgOM5w/640?wx_fmt=png)

测试代码 <?php echo $_GET[1];

在 2 中未对传入参数值做任何处理。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMhJ9Avu3WhaAYeZiauxrg4Y07HcEeXyIauerGHC7VSQOOrGpecp5iae1w/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMhJ9Avu3WhaAYeZiauxrg4Y07HcEeXyIauerGHC7VSQOOrGpecp5iae1w/640?wx_fmt=png)

在 3 中的传入参数值，未进行手动转义、未加入自动转义函数，但是，参数值还是自动被传译了。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMtat2AsFIp6l4Lh3Dibuau3IC4OmP8yI68JekX2QmMXtoeBa7aXAibKBQ/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMtat2AsFIp6l4Lh3Dibuau3IC4OmP8yI68JekX2QmMXtoeBa7aXAibKBQ/640?wx_fmt=png)

查看了 7.0.3.1 的 PHP 版本是 5.3.5，想到 magic_quotes_gpc 还没被移除（从 PHP5.4 开始就已经被移除了），使用 phpinfo 查看发现是果然是开启状态。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMfGIHCz9axTQtCxx5ENQiarKqOpe6oX0JIFGnsdBQxUdpyPrzBr9RBdQ/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMfGIHCz9axTQtCxx5ENQiarKqOpe6oX0JIFGnsdBQxUdpyPrzBr9RBdQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMgYHoPmUWaeIs78YHJib3nVjNZPpNMrJUHzrtSxsOcYjiaJJaL7SibA4xA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMgYHoPmUWaeIs78YHJib3nVjNZPpNMrJUHzrtSxsOcYjiaJJaL7SibA4xA/640?wx_fmt=png)

然鹅 7.0.2.1 的 PHP 版本为 5.6.40，升级到 7.0.3.1 后，PHP 版本却降到了 5.3.5🤣

**其他猜测：如果代码中没有对单引号进行转义，也没有使用自动转义函数，magic_quotes_gpc 等选项也已经关闭，GET、POST 等传参还是被转译。**

还有可能是其他**扩展或模块**（如：Suhosin 扩展、mbstring 模块）引起的，如果该环境的 PHP 程序是**自己编译**的，也可能是编译选项导致了单引号被转义。

**0x02 magic_quotes_gpc**

先确定一下 magic_quotes_gpc 的影响范围。  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMnrnkibRvdicEtPiaYguhC3lomCHEGCTVnqeDUpp1jPTQf2tbxX6bkGU8w/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMnrnkibRvdicEtPiaYguhC3lomCHEGCTVnqeDUpp1jPTQf2tbxX6bkGU8w/640?wx_fmt=png)

测试一手，毕竟要以实物为准嘛。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMqVhPV71r1I57OubSgibhftia0ap8F4zz8rHEicyfQibXSdTOiajUazw7uDA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMqVhPV71r1I57OubSgibhftia0ap8F4zz8rHEicyfQibXSdTOiajUazw7uDA/640?wx_fmt=png)

SESSION（无意义），SERVER、php://input（$HTTP_RAW_POST_DATA）不受影响。

**0x03 $HTTP_RAW_POST_DATA**

上面做的事情是为了解决，升级后增加了 magic_quotes_gpc 限制，寻找有没有什么方法可以绕过转译。

找到了 $HTTP_RAW_POST_DATA，发现 Exxxxxxxx.XGI 文件中出现过多次。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMCTQlKNUC9vdfaohibnXoFub6w0NpWrSnQ9c2RicwUhD03XUGEhwAK25A/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMCTQlKNUC9vdfaohibnXoFub6w0NpWrSnQ9c2RicwUhD03XUGEhwAK25A/640?wx_fmt=png)

选择一个最近的 137 行，发现刚好下方有拼接的 SQL 语句，且语句中的可控点在 $HTTP_RAW_POST_DATA 中。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMHD3LoDJxcxXTqZObyswiaibhuVcJckC0wYNuTZMw1qBaGm5Yc9icn8Ukg/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMHD3LoDJxcxXTqZObyswiaibhuVcJckC0wYNuTZMw1qBaGm5Yc9icn8Ukg/640?wx_fmt=png)

那么我们先让 cmd 等于 "createUser" 好通过 if ($cmd == "createUser") 判断，往上找发现 103 行 $cmd 通过 $requestObj['command'] 赋值。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM9iary5GuxhbcuFqMsysRF1Ezm3php7s8qGHA9D8CcCfPY81N2P4qKTA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM9iary5GuxhbcuFqMsysRF1Ezm3php7s8qGHA9D8CcCfPY81N2P4qKTA/640?wx_fmt=png)

辣么，就是说。。。我们只需要让 $requestObj['command'] == "createUser"，继续往上看，89-95 行是处理 $requestObj 的代码，可以看到其实 $requestObj 的键值是从 $paramArr 中得到的。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMFGNsYYyiaELoW3vs0OjaSpEqhDwWhiadlia96FG0l8UFVVU1tRoAYFbow/640?wx_fmt=png)![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMFGNsYYyiaELoW3vs0OjaSpEqhDwWhiadlia96FG0l8UFVVU1tRoAYFbow/640?wx_fmt=png)

分析一下这段代码的逻辑，其实就是循环取 $paramArr 的键值，然后使用 explode 函数把 $value 通过 "_" 分割打散为数组，并赋值给 $keyValue，然后把 $keyValue[0] 赋值给 $requestObj 当作键名，$keyValue[1] 作为值赋给 $requestObj[$keyValue[0]]。

explode 函数实例：

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMalOkC1icIjgVWhruibkFbGwcwM9xw2cicBOce1iaMp06dTqGjaQvqvRSHA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMalOkC1icIjgVWhruibkFbGwcwM9xw2cicBOce1iaMp06dTqGjaQvqvRSHA/640?wx_fmt=png)

回头看条件，其实只需要让 $requestObj['command'] == "createUser" 成立

就等于让 $paramArr 的 value 等于 "command_createUser" 就好了。（key 在循环中没参与处理不需要管）

然后 explode 函数把 "command_createUser" 通过 "_" 分割打散为数组，就成了 $keyValue = array('command' => 'createUser')，$keyValue[0] 就等于 "command"，$keyValue[1] 就等于 "createUser"，$requestObj[$keyValue[0]] 就等于 "createUser" 了。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMBsXy4Ds0Z7t9WjNYVC5rZvCibU4RIYUma1ORUrQp0JSQxX50qQk76pg/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMBsXy4Ds0Z7t9WjNYVC5rZvCibU4RIYUma1ORUrQp0JSQxX50qQk76pg/640?wx_fmt=png)

继续往上看 $paramArr，在 83 行进行处理并赋值，通过 $initparams 处理后得到，与上方 $requestObj 同理。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM4iaQibxxO2aljIQwB5eNFfrCpCqMCMHZbdcBRmaibppSChiaOQNcicplD1w/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM4iaQibxxO2aljIQwB5eNFfrCpCqMCMHZbdcBRmaibppSChiaOQNcicplD1w/640?wx_fmt=png)

继续往上看 $initparams，在 21 行通过 initParams 传入。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM2dwG1VxexBVYFxUnCk4gMfRh2BQ1qZVRF9qMicrlPZUMv26eroCJ49g/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM2dwG1VxexBVYFxUnCk4gMfRh2BQ1qZVRF9qMicrlPZUMv26eroCJ49g/640?wx_fmt=png)

条件都可控，尝试构造请求，提示参数非法。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMufTPdsLynicHsKCXJyw2vfUbHBjkhywoyL1YibiaiawZz39icUrgVK0OXqA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMufTPdsLynicHsKCXJyw2vfUbHBjkhywoyL1YibiaiawZz39icUrgVK0OXqA/640?wx_fmt=png)

原因是 59 行存在参数是否为空的判断。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMqvWzwMU1JRtHuapSgOWQNeicO6y6hI6uKuNvN7wQnnXJ4x1M1DezRLw/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMqvWzwMU1JRtHuapSgOWQNeicO6y6hI6uKuNvN7wQnnXJ4x1M1DezRLw/640?wx_fmt=png)

加上参数，继续构造请求，还是提示参数非法。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMNpPnoxIPjuA22iclmBWr0lghnx6r86R8RJHS1vib7Wm6lAgVvx2XXEMA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMNpPnoxIPjuA22iclmBWr0lghnx6r86R8RJHS1vib7Wm6lAgVvx2XXEMA/640?wx_fmt=png)

往下看发现 71 行对 $keyVal 有限制，但是可以通过 $key 控制，就是需要 $key == "wusuokey" || $key == "inner"，这里就不看 getfarminfo 方法了（悄悄说一下这里上个版本可以 getshell 噢），这里直接给 $key 赋值为 "inner"，让 $keyVal = "Realor"。

还有 78 行对 sign 的值有限制，就是需要让 $sign == md5($initparams . $keyVal)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM4JQTxLVAaTZWtcibqFY526sVBVTC5tgNxO4jD8cLiaAeNWR3icla0oB4w/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMnP1zibBtqxhxaia7kHnPArZPYRZDMnJWooUrM1FbN5BnQbSibTZC3OHrA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM4JQTxLVAaTZWtcibqFY526sVBVTC5tgNxO4jD8cLiaAeNWR3icla0oB4w/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMnP1zibBtqxhxaia7kHnPArZPYRZDMnJWooUrM1FbN5BnQbSibTZC3OHrA/640?wx_fmt=png)

很简单，把传入的 $initparams 和 $keyVal 拼接起来进行 md5 加密就好了。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMfp2MO1npiblbtxY2klNm3M6sMUogQ2sKRicQzDhPTMn8WJpBEnVvAYibw/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMfp2MO1npiblbtxY2klNm3M6sMUogQ2sKRicQzDhPTMn8WJpBEnVvAYibw/640?wx_fmt=png)

构造请求包，让 $cmd 等于 createUser，通过了 if 判断，离注入就剩几行了。  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMJdN8X4hwKaQfoaelmufJicuVdIX3ziahQGvqiau22KK2kT0dmyfy3S89A/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMlEmBaRIaL5MWECia5lo7UN5HrnUWr0vKWpMCDp0ZXHHQmMH0kcNYGfg/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMJdN8X4hwKaQfoaelmufJicuVdIX3ziahQGvqiau22KK2kT0dmyfy3S89A/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMlEmBaRIaL5MWECia5lo7UN5HrnUWr0vKWpMCDp0ZXHHQmMH0kcNYGfg/640?wx_fmt=png)

这时 $account 还没传值所以上一步报错，接着看 json_decode($HTTP_RAW_POST_DATA, true); 给 $account 传值。

PHP json_decode() 函数用于对 JSON 格式的字符串进行解码，并转换为 PHP 变量。 

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMNIiaW8buAibUhcu3mj0Fb8s5GLyLxIg9bY5BbGGbRe43nZFIfTR8xS0w/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMNIiaW8buAibUhcu3mj0Fb8s5GLyLxIg9bY5BbGGbRe43nZFIfTR8xS0w/640?wx_fmt=png)

好了直接构造数据包，记得把 Content-Type 改一下。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMGtFeiaxOobxbicrLibNh0EHh255AicShPGCTy5RxPxgibnOZfxc68ZibEia6Q/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMGtFeiaxOobxbicrLibNh0EHh255AicShPGCTy5RxPxgibnOZfxc68ZibEia6Q/640?wx_fmt=png)

成功通过 mysql_query，因为是通过 $HTTP_RAW_POST_DATA 传进来的，所以不会被 magic_quotes_gpc 限制，后面的话 dddd，这里就不演示了（小提示：有 32 个字段；这里写 shell 是可以用相对路径的../../WebRoot/shell.xgi😅）。

**0x04 下版本漏洞预测**

毕竟 json_decode($HTTP_RAW_POST_DATA, true); 的地方不多，刚好又看到一个有意思的函数 utf8ToGbk😅，注入经验丰富的师傅看到这可能就猜到下文了

就随便找个了利用点，让 $cmd=getUserDetailByAccount，与上方前半段手法一样不赘述了。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM7P1TktBC9v6vUeO4DFztqElpicwGqCW5CZdOlRsAdaiaTUHFmk1O6BmQ/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM7P1TktBC9v6vUeO4DFztqElpicwGqCW5CZdOlRsAdaiaTUHFmk1O6BmQ/640?wx_fmt=png)

开个上帝模式先。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMCgRQ32mRGib52iasJapGBz5UfA9u8sibfdicS2eHABzycOO2PIwcBWZTXw/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMCgRQ32mRGib52iasJapGBz5UfA9u8sibfdicS2eHABzycOO2PIwcBWZTXw/640?wx_fmt=png)

构造数据包，确认注入点。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMOWSWP32fK6eAVccP6uzc3Yx6N7MYxldzeTiaqRYmHcJ49Ec3qh2HwfA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMOWSWP32fK6eAVccP6uzc3Yx6N7MYxldzeTiaqRYmHcJ49Ec3qh2HwfA/640?wx_fmt=png)

单引号肯定不行啊，直接转译。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMGEDsK1xth1TBprg6Mne2xXcMDiaicp3L7Oyeaq36VboAVQfxicymA1Bzg/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMGEDsK1xth1TBprg6Mne2xXcMDiaicp3L7Oyeaq36VboAVQfxicymA1Bzg/640?wx_fmt=png)

那咋办么，utf8ToGbk 嚒，直接運一下，结束。

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMT65BsCZEqbgUeRHL83AXcxCJ3JLfG0WvmllDgUty2BUgdKBTdibQCvA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMtOial90ZKNkv1KKOGUf15dJXvFuUbtjcoV2H3lbNCsicN1rjOPc4Tk7A/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM7qZrodSJZnDnnX2icwtiac9veGF7ib5N4aCdCxOH77fIuicqNAeKOVNYlA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQMT65BsCZEqbgUeRHL83AXcxCJ3JLfG0WvmllDgUty2BUgdKBTdibQCvA/640?wx_fmt=png)

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/ofBa42GG7ShDZ8q4nlFlKNbAOqretHQM7qZrodSJZnDnnX2icwtiac9veGF7ib5N4aCdCxOH77fIuicqNAeKOVNYlA/640?wx_fmt=png)

！提示：注意一下上面的 md5 加密，这里单引号传进入已经被转译了，所以要加密的是 \'

**说明：**由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，雁行及文章作者不为此承担任何责任。雁行拥有对此文章的修改和解释权。如欲转载或传播此文章，必须保证此文章的完整性，包括版权声明等全部内容。未经雁行允许，不得任意修改或者增减此文章内容，不得以任何方式将其用于商业目的。

**【广告宣传时刻】**

2023 年的【炼石计划 @PHP 代码审计】主题是**【挖 0day，交 CNVD】**，目标是今年将带每个人冲刺**三张 CNVD 证书（**两中一高**）**，你只需认认真真的学习，我则用心手把手的教你。

首先冲刺**第一张**，其次冲刺**第二张**，最后冲刺**第三张，**最后恭喜你获得三张专属于自己的 CNVD 证书！

是不是看我说的还挺简单的，要我说，确实不难，毕竟世上无难事，只怕有心人！

另外这事又遇到了【炼石计划 @PHP 代码审计】，那就又简单了些。

**【炼石计划 @PHP 代码审计】**这里是一个专注 PHP 代码审计，系统化从基础入门到实战提升学习 PHP 代码审计的地方。这里不仅注重夯实基础，更加专注实战进阶。从基础概念知识开始学习，配合项目级系统实战演练，共六大学习阶段，一百二十余篇原创教程，带你提升真正的 PHP 代码审计技术！利用碎片化时间学习也会让你有不菲的收获，总之这里一定是你不错的选择。加上 2023 年主题是【挖 0day，交 CNVD】，目标是带大家挖掘两中一高 CNVD 证书，激情碰撞下来，收获最多的一定是你！

毫不夸张说，认真学习下来，相当于 96 元买了三张 CNVD 证书和一身 PHP 代码审计的技术，随随便便挖个漏洞都是这个数的好几倍！

如果说一年认真学习下来，你还没拿到证书，这事我负责！

来，下面跟随我一起瞅瞅学习计划，看看我们是如何完成这个目标的！

**【第一阶段】**

**入门学习 PHP 语言基础与 WEB 安全漏洞（约 10 篇）**

我们首先关注 PHP 语言，掌握 PHP 基础语法。其次关注 WEB 漏洞入门学习，并掌握 WEB 常见漏洞概念。

**【第二阶段】**

**学习 PHP 代码审计中的 WEB 常见漏洞（约 12 篇）**

学习 PHP 下常见的 WEB 安全相关漏洞代码，并且补充学习常见的 WEB 安全漏洞。

这部分主要关注常见的 WEB 漏洞函数，关键在于了解和记住，进而在下一阶段活学活用。

**【第三阶段】**

**实战代码审计 24 套基于 PHP 开发的系统（约 50 篇）**

提升 PHP 代码审计能力，一定要从实战出发。我们选取 24 套开源 CMS 系统进行代码审计手把手讲解。从挖掘 CNVD 角度出发，发现和理解常见的 WEB 漏洞，为提交 CNVD 证书打下实战基础。

下面是目前分享的系统，剩余还在调试选型中。代码审计漏洞讲解越往后分享的系统越新鲜热乎。

**【第四阶段】**

**PHP 相关系统历史漏洞复现（约 50 篇）**

该阶段与前面阶段进行穿插分享。主要关注历史和最新的 PHP 相关系统漏洞复现，并且着重从代码审计层面进行分享。让大家逐渐有独立分析的能力，而不是只会使用 POC。

并且在有着历史漏洞分析的基础上，进而可以对其他版本的系统进行代码审计，发现和挖掘漏洞！

![](https://mmbiz.qpic.cn/mmbiz_gif/FFcgFn6WVc2zFUUxKakr8FyqhdibwG8ic4sN8xuiaCCnJd3U1G3LLAeicXIJCH3LwLpyw7fB5wF9k7E4gJV3yKrzUw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

**到这，我们基本就可以上手针对相关系统进行漏洞挖掘了，着手提交 CNVD 证书了，提交重复撞洞不可怕，这都是对自己的磨炼，有问题我们可以一起探讨！**

下面是进阶学习阶段。

**【第五阶段】**

**PHP 反序列化漏洞讲解与利用链分析（约 12 篇）**

反序列化可以说是代码审计中非常重要的一部分。但很多朋友学着那是一个痛苦，云里雾里的。

在这里我们将系统学习 PHP 反序列化漏洞。先从 PHP 反序列化基础知识讲起。在从简入深学习 POP 链。让你真正掌握 PHP 反序列化。

**【第六阶段】**

**系统学习 ThinkPHP 框架与代码审计分析（约 12 篇）**

近几年 ThinkPHP 框架漏洞可以说是 PHP 系统漏洞的主力军。

是非常值得我们需要学习的，在这个阶段，我们从 ThinkPHP 框架基础学起，配合历史漏洞代码深入分析。让大家可以对 ThinkPHP 框架有个深入的了解。

从框架角度出发，分析漏洞，总结经验，在框架面前，可以更加得心应手！

好啦，上面就是我们的学习计划，实际上分享会更加精彩！

心动不如行动，赶紧加入，犹豫就会败北！  

早加入早内卷，早拿 CNVD 证书！

![](https://mmbiz.qpic.cn/mmbiz_png/ehibzaP4CvW7a4I1xzrsHH57gturFX0AtU6kmamK0tmCZCQVewamaYrib0aV8DibMIa9xyaDcPQrOib4DLPQWMwwuw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)