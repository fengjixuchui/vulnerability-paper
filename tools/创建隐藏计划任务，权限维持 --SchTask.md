<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/9D7kxSoau3l8TKZjdpvvMg)

  

<table width="676"><tbody><tr><td width="557" valign="top" height="62"><section><strong>声明：</strong>该公众号大部分文章来自作者日常学习笔记，也有部分文章是经过作者授权和其他公众号白名单转载，未经授权，严禁转载，如需转载，联系开白。</section><section>请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与文章作者和本<br>公众号无关。</section></td></tr></tbody></table>

**项目简介**  

利用 Windows API，工具化创建隐藏的计划任务，同时绕过安全软件的阻断，达到持久控制。

<table><thead><tr><th>类别</th><th>说明</th></tr></thead><tbody><tr><td>作者</td><td>AnonySec</td></tr><tr><td>团队</td><td>0x727 未来一段时间将陆续开源工具</td></tr><tr><td>定位</td><td>权限维持，内存加载</td></tr><tr><td>语言</td><td>C#</td></tr><tr><td>功能</td><td>创建隐藏的计划任务，进行权限维持</td></tr></tbody></table>

**项目描述**

‍‍‍‍

**实现原理  
**
-----------

### Steps

1.  选择主机随机进程名作为计划任务程序文件名
    
2.  将计划任务程序文件复制到 `%AppData%\Microsoft\Windows\Themes\` 中
    
3.  创建的计划任务名取同一随机进程名
    
4.  计划任务触发器以分钟为单位，无限期持续
    
5.  更改 Index、删除 SD 的键值，隐藏计划任务对应的 XML 文件
    
6.  删除已添加的计划任务
    

### Articles

更多技术细节，请查看  Windows 计划任务的进阶

**开始体验**
--------

```
Git下载安装
$ git clone https://github.com/0x727/SchTask_0x727.git

```

> 注：直接下载 Release 版本快速使用，已经将 `Microsoft.Win32.TaskScheduler.dll` 打包到 SchTask.exe 中。

**使用方法**
--------

```
SchTask.exe   (.NET Framework 2.0)
C:\>SchTask.exe
  ___       _____ ____ _____
 / _ \__  _|___  |___ \___  |
| | | \ \/ /  / /  __)|  / /
| |_| |>  <  / /  / __/ / /     https://github.com/0x727
 \___//_/\_\/_/  |_____/_/      Author: AnonySec
Usage: SchTask.exe <File Path> <Minutes>
   Eg: SchTask.exe C:\Windows\System32\cmd.exe 10
C:\>SchTask.exe C:\Windows\System32\cmd.exe 1
  ___       _____ ____ _____
 / _ \__  _|___  |___ \___  |
| | | \ \/ /  / /  __)|  / /
| |_| |>  <  / /  / __/ / /     https://github.com/0x727
 \___//_/\_\/_/  |_____/_/      Author: AnonySec
[*] Copy File location:
C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Themes\SearchApp.exe
[*] Hidden task xml file:
C:\Windows\System32\Tasks\Microsoft\Windows\UPnP\SearchApp
[*] RegistryKey location:
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\UPnP\SearchApp
[+] Successfully add scheduled task !

```

**下载地址**

**项目地址：https://github.com/An0nySec/SchTask_0x727**

**点击最下方名片进入公众号**  

# **往期推荐**  

[云安全 - AK/SK 泄露利用工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484850&idx=1&sn=785ebf6284c536262a08a6713cbcac8a&chksm=fcedb115cb9a38030cfe0024ecd722b3269d6eeddcd0845433f73ab68660ed776019b7a1f649&scene=21#wechat_redirect)  

[可以自定义规则的密码字典生成器](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484816&idx=1&sn=80a19335226b0e242a36a85486c541fc&chksm=fcedb137cb9a382100c0fbb51875de2a1183f46acccced953d4ee927c3f627d8d8e4a3f660d4&scene=21#wechat_redirect)  

[MySql、Oracle、金仓、达梦、神通等数据库、Redis 等管理工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484787&idx=1&sn=766263e71666745fca6a1fe71b016170&chksm=fcedb1d4cb9a38c2cccc8c58afb34b31677974540d45ad9db5f032c0eba6c7ff26527c0dbd2c&scene=21#wechat_redirect)  

[JNDI/LDAP 注入利用工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484743&idx=1&sn=42224dd27e62cb0d7a5cbdebf4dbbf19&chksm=fcedb1e0cb9a38f6b091c5a753c80b411bb92197ea02439a0493886ad55b7203fed057ec7718&scene=21#wechat_redirect)  

[jmx 未授权访问 弱口令批量检测 GUI 工具 - jmxbfGUI](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484738&idx=1&sn=3d7cf4b2ec5bc5a92de3db9c57fe036e&chksm=fcedb1e5cb9a38f3e8d8fce41bfd4ac22d001c075bfe2f1425f1a90643ede8b93bce377fa787&scene=21#wechat_redirect)  

[基于 Golang 的高并发子域名收集工具——FindSubs](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484731&idx=1&sn=cedd1f26bfe4227ae8932c77163d6938&chksm=fcedb19ccb9a388a5a3a5cb2ce9dcbfe0cc19e48846c590014d2894707f4f10fbd37579575bb&scene=21#wechat_redirect)  

[用友 NC 反序列化漏洞 payload 生成工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484724&idx=1&sn=d78ecac847f9245ac0275968fec10fa7&chksm=fcedb193cb9a38851d51cc14f0a07a659bfed23a1faab5a326260241eed995fe7c0378c13c05&scene=21#wechat_redirect)  

[一种另辟蹊径的免杀执行系统命令的木马](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484697&idx=1&sn=5daa5b99580bffd7e3db48bebd8e4fa2&chksm=fcedb1becb9a38a841f3fe2f6c6cdbfed5728b9171abcb1eee7645d6659d59e3a5148e7a6b7d&scene=21#wechat_redirect)  

[高并发红队打点横向移动内网渗透扫描器](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484625&idx=1&sn=24e58636f61c0f4542ea0aac467f774f&chksm=fcedb076cb9a396043968b283c67962c72b195f11646afd66db8d4b799701d066528838b3c14&scene=21#wechat_redirect)  

[一款 go shellcode 免杀加载器](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484617&idx=1&sn=1b67b44ccc3f1e8056ce9ac15d4d90e4&chksm=fcedb06ecb9a3978f20b354be309e0f4ebbbc6d34ed283e937e872ec6a92564e13110b483b61&scene=21#wechat_redirect)  

[目录扫描 + 403 状态绕过工具——dirsearch_bypass403](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484589&idx=1&sn=76a011ac81b8751e29374283b7dc2f94&chksm=fcedb00acb9a391c83816dfb653ea260e15bf80341585917d1bd892081e618f4ab430d404390&scene=21#wechat_redirect)  

[跨平台空间资产测绘——superSearchPlus](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484580&idx=1&sn=3beacb4e755b075c6eaf1cf805887719&chksm=fcedb003cb9a3915567143f81f553865ed6a872972b921c62093d5faa9de98d631f534ac426f&scene=21#wechat_redirect)  

[免杀 php 木马](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484572&idx=1&sn=fcaefb5ae7793ad3576913b769a536a6&chksm=fcedb03bcb9a392dd11898b6f918b4a0daf23c414bff586ead9a7fc0d850f5e045aa025632f4&scene=21#wechat_redirect)  

[渗透测试工具合集图形化指引项目](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484545&idx=1&sn=b7b43ded5edcb35c33bec3c72b70fdea&chksm=fcedb026cb9a39302fedd3b517e694210c27e6bce7743c15d8788b19616ab291078e8bdee4a9&scene=21#wechat_redirect)  

[搭建属于自己的漏洞库——Vulnerability-Wiki](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484532&idx=1&sn=ad7b5832f9bc20ea42b87480b57d9223&chksm=fcedb0d3cb9a39c57976b7306d9771b96cdbb41b4af5b99c9c9f4f0cadf66de7d963615ac3be&scene=21#wechat_redirect)  

[飞刃（NextScan）一款免费的企业级分布式安全评估系统。](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484500&idx=1&sn=721f3fc5e71ed5092dca0f7aef9669ce&chksm=fcedb0f3cb9a39e58c961fc3bd0d69f8cf2638b606c1439d5837047da495dd7b48d5ac5bc569&scene=21#wechat_redirect)  

[安全研发 - Pyqt5 UI 设计](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484307&idx=1&sn=edad7d44882766a8ff3839ea66b31995&chksm=fcedb734cb9a3e22ff6ec33343523471b901be861b82e652eabeca97dfc8aac846755d6ce539&scene=21#wechat_redirect)  

[漏洞基础 - XSS 利用](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247483773&idx=1&sn=3c60c0c3cdd1a0380b884f6dcd56ce73&chksm=fcedb5dacb9a3ccc3f8344ee7b44c6d0bcfbdd78a4a013b5fe0ec93b185ce7ddc5f9140c307c&scene=21#wechat_redirect)