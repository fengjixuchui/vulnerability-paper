<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/T6o4fXYLFiHACYiPA8P2CQ)

**免责声明**

由于传播、利用本公众号狐狸说安全所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号狐狸说安全及作者不为**此**承担任何责任，一旦造成后果请自行承担！如有侵权烦请告知，我们会立即删除并致歉，谢谢！

### **0x01 前言**

最近在调研国内外开源的容器安全相关工具，发现了很多优秀的项目，国外的项目有 trivy、anchor 等，在漏洞检测这块做的很出色了；而国内的项目不多，关注非漏洞检测的工具更少，所以对一款名为问脉的开源容器安全工具集比较感兴趣，遂记录初次使用的过程。

### **0x02 用宿主程序进行本地镜像中五种威胁检测**

*   `./parallel-container-run.sh scan-host -h`，查看扫描本地镜像命令参数
    

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmgmtGPPuyFwurq4Fu0F47F69vPaOSmPY1ibTypRFvqTHp6Ur4YbYJ5fA/640?wx_fmt=png)

*   `./parallel-container-run.sh scan-host`，使用所有已识别插件扫描本地所有镜像
    

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmq8JZbDd2TxYAibvsJvicaSNIARibmOIkribFTSyYF10bYkBJlKticr36sew/640?wx_fmt=png)

发现其中一个高危的敏感信息，输出检测详情

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwm9DQHjzibSUbOeaPrh0ZULzYbC7IpIpcCaCBq7cciaiaMVqMHhsticiaYiczA/640?wx_fmt=png)

*   查看当前插件列表 `./parallel-container-run.sh list plugin`
    

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmEXuauVO3JGOkwmicqSGoicJzRa8DpwKicKf5s1jvxmGnFb2mwtZGL8jOQ/640?wx_fmt=png)

*   `./parallel-container-run.sh scan-host -g "**/veinmind-weakpass"`，指定只使用弱口令插件扫描
    

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmItmO4lXmjXTX0Tb53vJ0bmLoeFRpM9gsVvnu1HqFxVdQZQRdekEghg/640?wx_fmt=png)

发现高危的弱口令风险，输出检测详情

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmFeEaR2gn96gGiaLLOcUg9GRsDOg44fmMVH7qBLZl2sLx5zweFFS5uKg/640?wx_fmt=png)

### **0x02 使用宿主程序进行仓库镜像的检测**

*   ./parallel-container-run.sh scan-registry -h ，查看扫描远程仓库命令参数
    

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmabhMDV7FpaG3T59PHqSD1HYicsXY8f4XF6XuWya4icibF62r0asvr5QvA/640?wx_fmt=png)

*   ./parallel-container-run.sh scan-registry oodo ，试试扫描 docker hub 公开仓库中的 oodo 镜像
    

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmh6NzOQNu7O4ticPjLHrp1eNUIZ8e0omu4K1cReE98YHQ13oSLPyLA0g/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmQiao7mEGyE8Azebec5S1JCeZWQKTleMiaicM2R2V4ZCdT28z2PLVuMxsg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmX0w3Ih21JKb80XEzQDLqUeVrtcw4DibIJLA3PS0eictZ0DaBBfHH7pHA/640?wx_fmt=png)

### **0x03 Demo**

![](https://mmbiz.qpic.cn/mmbiz_gif/pH5fZ5lvwwYlOK38fvygML23avrIagwm47LgThf0JibBOV4qad89MPUzBs4dvthhZrXVzXSCeBiaVECqQQRmk6yA/640?wx_fmt=gif)

### **0x04 快速开始**

### 1. 确保机器上正确安装 docker

```
docker info
```

```
docker pull veinmind/veinmind-runner:latest
```

### 2. 安装 veinmind-runner 镜像

```
wget -q https://download.veinmind.tech/scripts/veinmind-runner-parallel-container-run.sh -O run.sh && chmod +x run.sh
```

```
./run.sh scan-host
```

### 3. 下载 veinmind-runner 平行容器启动脚本

```
wget -q https://download.veinmind.tech/scripts/veinmind-runner-parallel-container-run.sh -O run.sh && chmod +x run.sh
```

### 4. 快速扫描本地镜像

```
./run.sh scan-host
```

🔨 工具列表
-------

<table width="NaN"><thead><tr><th>工具</th><th>功能</th></tr></thead><tbody><tr><td>veinmind-runner</td><td>扫描工具运行宿主</td></tr><tr><td>veinmind-malicious</td><td>扫描镜像中的恶意文件</td></tr><tr><td>veinmind-weakpass</td><td>扫描镜像中的弱口令</td></tr><tr><td>veinmind-sensitive</td><td>扫描镜像中的敏感信息</td></tr><tr><td>veinmind-backdoor</td><td>扫描镜像中的后门</td></tr><tr><td>veinmind-history</td><td>扫描镜像中的异常历史命令</td></tr><tr><td>veinmind-asset</td><td>扫描镜像中的资产信息</td></tr><tr><td>veinmind-webshell</td><td>扫描镜像中的 Webshell</td></tr></tbody></table>

PS: 目前所有工具均已支持平行容器的方式运行

☁️ 云原生设施兼容性
-----------

<table width="NaN"><thead><tr><th>名称</th><th>类别</th><th>是否兼容</th></tr></thead><tbody><tr><td>Jenkins</td><td>CI/CD</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr><tr><td>Gitlab CI</td><td>CI/CD</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr><tr><td>Github Action</td><td>CI/CD</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr><tr><td>DockerHub</td><td>镜像仓库</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr><tr><td>Docker Registry</td><td>镜像仓库</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr><tr><td>Harbor</td><td>镜像仓库</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr><tr><td>Docker</td><td>容器运行时</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr><tr><td>Containerd</td><td>容器运行时</td><td><g-emoji alias="heavy_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2714.png">✔️</g-emoji></td></tr></tbody></table>

### **0x05 总结**

veinmind-tools 是由长亭科技自研，基于 veinmind-sdk 打造的容器安全工具集

veinmind, 中文名为问脉，寓意 容器安全见筋脉，望闻问切治病害。 旨在成为云原生领域的一剂良方

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmlIwkGA1XywEuibHCvxCoVXS4qzibFibheGTZxrungicNwryvFZOB9I8cmg/640?wx_fmt=png)

问脉官方网站：https://veinmind.chaitin.com/

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmRxcFqI7USGEDQAGnsOwPlz79RfjPNZFw8R6RkZOIM1t6MsdrGGmL6g/640?wx_fmt=png)

问脉官方文档：https://veinmind.chaitin.com/docs/  

![](https://mmbiz.qpic.cn/mmbiz_png/pH5fZ5lvwwYlOK38fvygML23avrIagwmKu0AkdBdSKxdrYiaq2PnCmicHia5g2YucpOC1bHCKx2O3M5vjW5l49uUQ/640?wx_fmt=png)

问脉项目地址：**https://github.com/chaitin/veinmind-tools**

简单使用下来，问脉是很容易上手的，几乎没有理解成本。扫描本地镜像时检测出了好几个敏感信息和弱口令，看介绍官方还做了一个宿主，可以一个工具调用其他检测插件，还可以自己根据插件规范开发特定需求的插件进行调用，还是比较靠谱的，希望官方持续增加工具的检测规则，调研时提的 issue 集成 Jenkins 很快就实现了，看来是专人维护，项目活跃度蛮高的。

本文章主要来源于 freebuf，部分内容自己整理总结。  

https://www.freebuf.com/sectool/339319.html