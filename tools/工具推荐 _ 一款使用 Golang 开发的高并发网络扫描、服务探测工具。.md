<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/MW4Fsf-1G2aiaLwWeQnPQA)

免责声明

  

  

**本文仅用于技术讨论与学习，利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者不为此承担任何责任。**

**只供对已授权的目标使用测试，对未授权目标的测试作者不承担责任，均由使用本人自行承担。**

![](https://mmbiz.qpic.cn/mmbiz_png/0x3kGZxwKTkyY7BrNkUwicjIkq3F2xlCIgGz7pBpnEMh3rvpbyH2DE2kIKVste0B2yP8TiavoOsuo9sMQKSj9uxQ/640?wx_fmt=png)

文章正文

  

  

一款使用 **Golang** 开发且适用于攻防演习**内网横向信息收集**的**高并发**网络扫描、服务探测工具。

🍭Property
----------

*   • 多平台支持（Windows、Mac、Linux、Cobalt Strike）
    
*   • 存活 IP 探测（支持 TCP、ICMP 两种模式）
    
*   • 超快的端口扫描
    
*   • 服务和应用版本检测功能，内置指纹探针采用:nmap-service-probes[1]
    
*   • Web 服务（http、https）信息探测
    
*   • 扫描结果兼容 INFINITY 攻防协同平台（暂不公开）
    

🎉First Game
------------

总结诸多实战经验，考虑到实战过程中会出现和存在复杂的环境、红蓝对抗过程中常用的内存加载无文件落地执行等，因此 **ServerScan** 设计了**轻巧版**、**专业版**、支持 **Cobalt Strike 跨平台 beacon:Cross C2[2] 的动态链接库**，** 以及支持 INFINITY 攻防协同平台的专用版 **。便于在不同的 Shell 环境中可以轻松自如地使用：如：Windows Cmd、Linux Console、远控 Console、WebShell 等，以及 Cobalt Strike 联动使用 cna 脚本文件加载，实现内网信息快速收集，为下一步横向移动铺路。

**轻巧版：**

参数形式简单、扫描速度快、耗时短、文件体积小、适合在网络情况较好的条件情况下使用。

**专业版：**

支持参数默认值、支持自定义扫描超时时长、支持扫描结果导出、适合在网络条件较苛刻的情况下使用。

**动态链接库：**

为支持 Cobalt Strike 跨平台 beacon，无文件落地执行，无文件执行的进程信息，基于轻巧版本进行动态链接库编译，扫描超时时长为 1.5 秒。

### 💻for Linux or Windows

*   •
    
    #### 轻巧版
    

*   • **for PortScan****Usage：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNphWsmqEphZlyT1yibwdqK9EkSIFU2jqRYSDtJBJouRLEGU6XmDBJicew/640?wx_fmt=png)Air_scan_use
    
    **Scanning：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNhWoo5icVguuJOXAjgxjqIY1cEVKmVS5SwJ09lmz5n0D93iazyhKspQkg/640?wx_fmt=png)Air_scan1
*   • **for Service and Version Detection****Usage：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNO105BuicjRg2fDZqK4K8vQWkUmz5ibWRnjuQ8InznSbfIkMuXwVSGDicg/640?wx_fmt=png)Air_scan_probes_use
    
    **Scanning：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNylkjChcfUMyBkDHGX8oxicxgnuCjAOKz1XBqkJKXGadviaAm6icfOUdwA/640?wx_fmt=png)Air_scan_probes

*   •
    
    #### 专业版
    

*   • **for PortScan****Usage：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNp0PUrDZOLkK8GO4gVPRA3tHicCySq045zC5sqrgSsc3HzTX4FhgrRNw/640?wx_fmt=png)Pro_scan_use
    
    **Scanning：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVN2exZ83DF8W8A9iajOXiavFrmyxMHoRwGtW7ibGjNvZQbzjU7Pm3xDePUQ/640?wx_fmt=png)Pro_scan
*   • **for Service and Version Detection****Usage：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNYXI61yoP6QiczLedibfMMKhXu5bFicbPBIIbACuia7OkBfuRg2k3pVfcow/640?wx_fmt=png)Pro_scan_probes_use
    
    **Scanning：**
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNYDX6owV1hxQT1xxCFfibeDZQJsHHG2J6qJLickh4saRYKE7l4FVib6Vfw/640?wx_fmt=png)Pro_scan_probes

### 🎮for Cobalt Strike

*   • **Windows** 于 Cobalt Strike 已经内置了 PortScan，因此目前 Windows 仅支持利用 cna 上传对应版本的 ServerScan 可执行文件到服务器进行扫描。
    

*   • **for Service and Version Detection**Interact:
    
    ![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNgibbkBu1mGMsCv2uPqxHbqXYCyfJocD1TLzYhQCw5k8xhmSofHKw27w/640?wx_fmt=jpeg)serverscan_windows![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNzdlicmVKp83ib5SGL99jbNrSISyKL5dYjdxG1yPnk1MsGz4o4MuIicwow/640?wx_fmt=jpeg)serverscan2_windows

*   • **Cobalt Strike 跨平台 beacon** ServerScan 的优势在于跨平台，在 Hook 师傅的帮（jiān）助（dū）下目前已经基本适配了 Cross C2[3] 的 Linux、Mac OS 两大平台，为了提高隐匿性减少文件特征，目前支持内存加载可执行程序和动态链接库调用，您只需在安装了 Cross C2 的 Cobalt Strike 中导入对应的. cna 脚本，即可实现 ServerScan 与 Cobalt Strike 跨平台 beacon 联动，具体使用参考。
    

*   • **for PortScan**Interact:
    
    ![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNdIqRaGoqlgBhQWk4dlHdib6nvNNQyBictscW6cZibFA4AYaeplqGTUjNA/640?wx_fmt=jpeg)portscan_console
    
    Targets 结果集自动导入:
    
    ![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNKKOMUBawCViazqfGcqxcficBgMCMBibtRg5U7tNX9XojxgU20q7RscfTg/640?wx_fmt=jpeg)portscan_targets
    
    services 结果集自动导入:
    
    ![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNzTbPDB5fuPic4aCh1q9BcyibD8LnbBdY8sB9KCWViaS2rxhYNibczqWMvA/640?wx_fmt=jpeg)portscan_services
*   • **for Service and Version Detection**Interact:
    
    ![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNibgMkicmic7ia7fVPiadJmkYiaj97GibnZXICVDQgj2L1sqjKnrFy6XFZ0aOQ/640?wx_fmt=png)serverscan_console
    
    Targets 结果集自动导入:
    
    ![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNUn57pPRDZiceDoibD8AyubfTZbNdQZPMd1R9FKtLdGxBl5vPGAxqrE4g/640?wx_fmt=jpeg)serverscan_targets
    
    services 结果集自动导入:
    
    ![](https://mmbiz.qpic.cn/mmbiz_jpg/h8P1KUHOKuao88kg4qpyurE0Na2lxnVNcxnDh8xkdQMPia82LVzKXhcIg4iblUcehORPibLOOSAY0IybXfSuCAWvw/640?wx_fmt=jpeg)serverscan_services

  
**后台回复 “****20230308****" 获取该工具** 

![](https://mmbiz.qpic.cn/mmbiz_png/0x3kGZxwKTkyY7BrNkUwicjIkq3F2xlCIgGz7pBpnEMh3rvpbyH2DE2kIKVste0B2yP8TiavoOsuo9sMQKSj9uxQ/640?wx_fmt=png)

技术交流

  

  

知识星球

  

  

**致力于红蓝对抗，实战攻防，星球不定时更新内外网攻防渗透技巧，以及最新学习研究成果等。常态化更新最新安全动态。专题更新奇技淫巧小 Tips 及实战案例。  
**

**涉及方向包括 Web 渗透、免杀绕过、内网攻防、代码审计、应急响应、云安全。星球中已发布 200+ 安全资源，针对网络安全成员的普遍水平，并为星友提供了教程、工具、POC&EXP 以及各种学习笔记等等。**

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuYmNKGiac5jzvbTTnwhGXXI8mTRm3Hd4PqNKiaZqbxC4rDiaVvxllH9ic3ibV5YJZYX15mTEw0libLS3AsA/640?wx_fmt=png)

交流群

  

  

关注公众号回复 “**加群**”，添加 Z2OBot 小 K 自动拉你加入 **Z2O 安全攻防交流群**分享更多好东西。

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKuYMO5aHRB3TbIy3xezlTAkbFzqIRfZNnicxSC23h1UmemDu9Jq38xrleA6NyoWBu1nAj0nmE6YXEHg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubEBT4bUSeGS6micuPMlUoN1AxpTK5kx2CY2uDNuyvk0Ce2a82UjWrZxkQneexdbrYBLD3W8g2N4JA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)![](https://mmbiz.qpic.cn/mmbiz_png/h8P1KUHOKubEBT4bUSeGS6micuPMlUoN1vd7kGCw2KeNFhicuQunVRDXhWHtDbp7tVRTL5lxPibjePvPrTVa3RjlQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

  

关注我们

  

  

**关注福利：**  

**回复 “****app****" 获取  app 渗透和 app 抓包教程**

**回复 “****渗透字典** **" 获取 针对一些字典重新划分处理，收集了几个密码管理字典生成器用来扩展更多字典的仓库。**

**回复 “****书籍** **" 获取 网络安全相关经典书籍电子版 pdf**

****回复 “资料** **" 获取 网络安全、渗透测试相关资料文档****

往期文章

  

  

[**我是如何摸鱼到红队的**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247489526&idx=1&sn=f52e17f5eb4790395a88a8e64c2a15e4&chksm=cea8fcb6f9df75a03fcf710a7369d8e761a1f8e5ae882709292c49103f22eefeb3a534388cd3&scene=21#wechat_redirect)  

[**命令执行漏洞 [无] 回显 [不] 出网利用技巧**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247488092&idx=1&sn=07ad5a0c09715ca03362bdcacc17f1e1&chksm=cea8f91cf9df700a68c747e2d7185efad50f380f93257293b9b96b5d87dc52cb2082560b0f0f&scene=21#wechat_redirect)  

[**MSSQL 提权全总结**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247488864&idx=1&sn=4888dcec05c0c5c8bc9d3b34136930c0&chksm=cea8fe20f9df7736e03b8544955533ac32671b845ff61d24dc51b5d787960d28256a833350d0&scene=21#wechat_redirect)  

[**Powershell 免杀过 defender 火绒，附自动化工具**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247484469&idx=1&sn=bdac380ee95fd0ef72581a3b60da1443&chksm=cea8ef75f9df66630e2148be842428802b27bcee1cb09748cbc200046742b8052cb6f873e115&scene=21#wechat_redirect)  

[**一篇文章带你学会容器逃逸**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247486670&idx=1&sn=6822dd40dcc20121fce0c42188fcd49a&chksm=cea8e78ef9df6e987896bdbd6b7a96c48992782657680574d7015d72984e7ca67a25a0aeea5d&scene=21#wechat_redirect)  

[**域渗透 | kerberos 认证及过程中产生的攻击**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247483720&idx=1&sn=157c5a4c172315af343bd253bc66da7c&chksm=cea8ea08f9df631e96faca7437a2b1e1900973dfd3b8d3501a666afcd8b05d6d16b8642aabc7&scene=21#wechat_redirect)  

[**通过 DCERPC 和 ntlmssp 获取 Windows 远程主机信息**](http://mp.weixin.qq.com/s?__biz=Mzg2ODYxMzY3OQ==&mid=2247488097&idx=1&sn=cf1e6965c78c9b4636ba15d2bd752655&chksm=cea8f921f9df7037e1e54ae11e03e18562da87309414c0fac3d8bc581bebe69d96cc5fdfce1d&scene=21#wechat_redirect)