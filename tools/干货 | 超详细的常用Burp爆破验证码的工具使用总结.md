> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/bp-oMb0SdtNBLLZW1a-DyA)

0X00 前言
-------

如果在渗透中遇到带有验证码的网站登录口，相信很多小伙伴遇到了带验证码的登录口就直接放弃了爆破弱口令的想法，这样会丧失很多机会，所以今天就让我来推荐一些可以识别验证码的Burp插件，以此用来爆破登录口。

昨天一位小伙伴求助我，如何用burp爆破一个luo聊骗子的网站后台，带验证码的，需要一个简单的解决方案，今天它来了

这里我推荐：

```
`https://github.com/smxiazi/NEW_xp_CAPTCHA``https://github.com/smxiazi/xp_CAPTCHA`
```

这两个项目来进行简单的绕过验证码的爆破

0X01 配置验证码插件
------------

下载下来之后，记得使用python3.7以下的python版本

其次需要修改server.py和xp_CAPTCHA.py两个文件

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXgpV0akFyYfSgFud45UKicZCA4ibTH8kgbneiaRqRjKK2wyS4EHWSfQxDQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

server.py需要设置的是IP和端口，可以不用改，端口看你自己情况而定

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXzfW82CT9xb4nYyjWjzUGiasmjuxzEnickMKSXEwvK9ZS0NWmEBW9NiaEg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

xp_CAPTCHA.py里面的ip和端口需要根据server.py里面的来

我这里是本地运行的server脚本，所以xp_CAPTCHA我设置127.0.0.1  

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXvExaNic9fz0as1vqUY4iaV4f3ONj6H2FsH4Dea8fIIYY44KMTcVaIhiag/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

server.py运行需要安装muggle-ocr模块，记得先更新pip，我这里用的是python3.6.4的环境

```
`更新pip命令：``python -m pip install --upgrade pip``安装模块命令：``python -m pip install -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com muggle-ocr`
```

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXWw3cLnLY3OIG30QRulO0tCMEmnj19pBUETDiczt0Eu2hySNafNfibonw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

安装完成  

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXKslHGbNPgmUFGduznNP4uLByL2TzosG5PxDcTLOoguDmMvkSErgpFA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

报错了，根据搜索，只需要更新一下pip就好了，再运行一次安装muggle-ocr模块的命令就可以了

```
python -m pip install -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com muggle-ocr
```

安装完成后运行一下server.py，然后在浏览器中访问  

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXzR5bmW0McNh2McsGadDthia9IP2XX66qZdIc3L4W1RZ3MyHqCmn4JvQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

访问网页

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXnsfybDKUpnGwK9O2JCkO4Gsgnrm1qeECe5FkcpLia8VwnfltJwAUicew/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

OK，启动成功

0X02 配置Burp插件配置
---------------

PS：**特别提醒，加载插件，Burp上一级文件夹名字中不要包含中文，不然加载插件会报错的**

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yX6UoJ37LJSdRtugz0pT55aAAbR46tMrnBF0Sqbvu0ntribJe26J9GZCg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

需要安装jython 的jar包文件

https://www.jython.org/download

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yX6m3aZO9Yy5flwwId3TVcHTTBYCokia33HK0sxMXjQlemRIUVxZibiaficg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

Burp里面选择jython环境

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXxedUvSnDfRJxXictwsfvADw8tnpDDelVHiauufVvwSwblFAiaWeJczCibw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

添加xp_CAPTCHA插件，本地的python版本要python3.7以下，我用的是python3.6.4版本

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXpHVS9vfYbVYkR2028mDPtyxKdHZTib4AWmBpMwJl3yRVnDBHu2C7oIg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

选择步骤

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXoVQuVeM1Wg4aKERAIyj6Fs54VLsumZ3mtA2Kn0Wo8uUNtIIwDibhicxg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

正确加载完成会显示如下图所示

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXZwr4uIITeLB0UXE94KIf2ibWia9sxylj8icCICibP6Q4GbMm182fZ79rQg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

成功加载插件

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXSfLfC8HtN8tckUQL7o3hbOq1fKVIvoEtkBFuVIiatwiciaetOiaMaoGslg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

加载开始下一步。

0X03 爆破过程
---------

目标网站:

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXDpCfpibgqdIcz9ys5eJJwXhBicQVkcMtPyXYYW7IqshmkQf78rwC7bKQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

找到验证码URL路径：

![图片](https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvouicd0t3gd76gq3kw4MMzz7yXXmSIa841GTxo4FCoPiaKsxJmIFonZAsPDRK62x4madibh3iaxtybx8dRg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

拼接url

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

Burp抓取登录包，然后ctrl+i发送到intruder模块

然后在Attack type选择Pithfork，在请求头信息里添加 xiapao:验证码的请求url，如下图所示：

```
xiapao:http://209.x.x.x/captcha.shtml
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

第二步：选择弱口令字典

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

第三步：设置验证码识别插件

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

第四步：设置线程，设置线程为1

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

第五步：点击Start Attack按钮即可开始爆破带验证码的登录框

开始跑起来，网页端已经接收到了识别的验证码

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

Burp正常工作  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

### 0X04 免费版的插件不足之处

验证码识别成功状态码：374

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

验证码识别失败状态码：395  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

导出验证结果，查看成功率

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

选择长度字段即可

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

然后我导出到了我桌面的1.txt，然后用VScode打开1.txt,搜索374，验证码识别到的，有474条

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

验证码识别错误的有1847条

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

可能是我测试问题，2320条，识别成功验证码的只有474条

识别失败的有1847条，成功率20%多，识别成功率感人！

也可能是我测试的问题，欢迎评论区其他评论你们的测试结果

0X05 付费版验证码API接口测试
------------------

```
`需要使用该插件``https://github.com/smxiazi/xp_CAPTCHA`
```

测试API接口-有钱人的方案：  

1块钱500次验证码  

10块就是5000次验证码识别  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

也有包月套餐  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

```
`http://www.kuaishibie.cn 处注册账号，用这个平台的原因是因为注册方便。``在http头部填入以下格式,账号密码是kuaishibie的账号密码，别搞错了``xiapao:账号,密码,验证码url,验证码类型``验证码类型：纯数字=1，纯英文=2，数字英文混合=3``如：``xiapao:test,123456,http://www.xxx.coom/get-validate-code,3``或（如果不输入验证码类型则默认 数字英文混合 ）``xiapao:test,123456,http://www.xxx.coom/get-validate-code``或（需要填写账号密码在脚本的第12行与第13行）``xiapao:http://www.xxx.coom/get-validate-code,3``或（如果不输入验证码类型则默认 数字英文混合 ）``xiapao:http://www.xxx.coom/get-validate-code``注册时，欢迎填写我的邀请码：d69d095bc064401c91eff66e855cda3b`
```

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

记得切换插件  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

然后Start attack

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

对了，使用API接口的识别验证码可以使用默认的5个线程来跑，如果出现错误就调回1个线程即可

### 使用验证码API的最终结果

总共跑了：1436条，识别错误的有54个，成功的有1381条，网页502状态1条，花了我3块大洋，1块钱是500条

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

成功的验证状态

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

网页端查看识别了多少个接口：1417个

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

我的成功率在96%左右，土豪值得一用！

0X06 其他识别验证码的插件推荐
-----------------

```
`2年前的工具，burp验证码识别接口调用插件``https://github.com/c0ny1/captcha-killer``1年前的工具，对于有验证码的站点爆破，用于安全合法测试``https://github.com/mycve/BurpLogin``3年前的工具，自动识别图形验证码并用于burp intruder爆破模块的插件``https://github.com/bit4woo/reCAPTCHA``2个月前的工具，captcha-killer的修改版，支持关键词识别base64编码的图片，添加免费ocr库，用于验证码爆破，适配新版Burpsuite``https://github.com/f0ng/captcha-killer-modified`
```

  

  

**补充：打包我上述中使用到的工具**

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

  

链接：https://pan.baidu.com/s/1314oopVtaS4FLYISa0OLqA

提取码：c4u6

**![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)**  

  

**推荐阅读：**

  

[**Burpsuite专题学习指南**](http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247486335&idx=1&sn=d81ae76ad29f73205d3b66f3479719bb&chksm=ec1f5e40db68d75699c467277100e0e02d1545b66ca1602f131951583b0fa1a88834a2007809&scene=21#wechat_redirect)  

  

[**干货 | Burpsuite的使用tips总结**](http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247504480&idx=1&sn=17415d18ae3ddfefc8dd78d67dfae8f0&chksm=ec1c875fdb6b0e49b39f21cb91b6b092f3d35b3436aaf39406bf5c94170497bdef946730bfaf&scene=21#wechat_redirect)  

  

[**实战 | WAF-Bypass之SQL注入绕过思路总结**](http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247502903&idx=1&sn=96bfd17d4de95b92aae8a3baec908a6b&chksm=ec1c9908db6b101e2501847d0cbdba83eb4356f22e699237c578ea2ef636656358b01553c788&scene=21#wechat_redirect)

  

**点赞，转发，在看**

  

![图片](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)