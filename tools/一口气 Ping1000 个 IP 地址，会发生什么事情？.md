<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/zLHtvPB3Z-0-pahgZ-rGBA)

ping 命令是我们检查网络中最常用的命令，作为网络人员，基本上每天都会用到，可以很好地帮助我们分析和判定网络故障，对吧？

一般来说，网工们用 ping 查看网络情况，主要是检查两个指标：

*   第一个是看看是不是超时
    
*   第二个看看是不是延迟太高
    

我做个假设啊，如果，你今天需要负责 10 台设备，100 台设备，1000 台设备怎么办？

一个个 ping 过去怕是凉凉，这种情况，在大型网络中很有可能遇到，那该咋整？

这篇文章想和你分享下大量设备的 ping 方法。

**当然，ping 作为网络工程师必备的命令，也反映了它是必学的网络基础之一。**

#### 一、 批量 ping 网段

对于一个网段 ip 地址众多，如果单个检测实在麻烦，那么我们可以直接批量 ping 网段检测，那个 ip 地址出了问题，一目了然。

先看代码，直接在命令行窗口输入：

```
for /L %D in (1,1,255) do ping 10.168.1.%D


```

IP 地址段修改成你要检查的 IP 地址段。

![](https://mmbiz.qpic.cn/mmbiz_jpg/0rWmH3pBYXxQPWNAshXDJo2tQRAoocliaANnDwVm4pExGCjqJG0iatHrHmB1tyd6VTyTstRIKMyElMth6GbTtXAA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

当输入批量命令后，那么它就自动把网段内所有的 ip 地址都 ping 完为止。

那么这段 “for /L %D in(1,1,255) do ping 10.168.1.%D” 代码是什么意思呢？

代码中的这个 (1,1,255) 就是网段起与始，就是检测网段 192.168.1.1 到 192.168.1.255 之间的所有的 ip 地址，每次逐增 1，直接到 1 到 255 这 255 个 ip 检测完为止。

#### 二、批量 ping 网段命令升级

上面的命令虽然能批量 ping 地址，但是上面代码在命令行窗口显示数量多的时候看起来也很麻烦，那么我们再升级一下，用下面的代码。

```
for /L %D in (1,1,255) do ping -n 10.168.1.%D >>a.txt 


```

说明，ip 地址是变的，你填你需要测的 ip 网段就行，a.txt 也是变的，可以自已设置名称。

这样就会把结果导入的 a.txt 文件中，全部 IP 检查完成后打开 a.txt 搜索 “TTL=” 包含它的就是通的地址，没有包含 “TTL=” 的地址就是不通的。

如下图：

![](https://mmbiz.qpic.cn/mmbiz_png/0rWmH3pBYXxQPWNAshXDJo2tQRAoocliaibj0gRXeIZxDrpc3HLXGyibvrOLZtQLd00EDeqFzXJ9guYy1rkJG3pMw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_jpg/0rWmH3pBYXxQPWNAshXDJo2tQRAoocliarIG6nwaSflicJ2sGvsJicz5gy27ibuqjwblNFWzYyZJ8O4Qo1n29rlRZg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

打开后，就直接搜索没 TTL 的就可以了。

#### 三、批量 ping 网段命令再升级

很多人要说了这样还要搜索，也不是太方便，需要这样查来查去，那么我们再看下，是否有更简便的方法呢？

答案肯定是有的，我们来看代码。

```
for /l %D in (1,1,255) do (ping 192.168.1.%D -n 1 && echo 192.168.1.%D>>ok.txt || echo 192.168.1.%D >>no.txt)


```

这段代码会将 ping 通的 IP 和不通的 IP 分别放到两个文件里面，这样是不是很方便啦，如下图：

![](https://mmbiz.qpic.cn/mmbiz_jpg/0rWmH3pBYXxQPWNAshXDJo2tQRAoocliamToqvVjicnOiaY8FS00cuLm6t02pPxibYib7g11QwibMuQ6viaaic1gaShJpw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/0rWmH3pBYXxQPWNAshXDJo2tQRAoocliaSOYaOgZgicQia3GB9eJDfFET2k7zcTicBdiax8WfsAdI9KTPpW62LWckFQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

这段代码非常实用，在大网络中可以用到，就是大家在输入的时候需要细心，不过也没有关系，可以直接把这篇文章收藏，日后要用，直接复制里面代码，然后改下里面 ip 地址就行了。

#### 四、批量 ping 网段命令终极方法

上面提到的三种代码提到的都是针对同一个网段内 ip 地址批量检测。

那么，在实际项目中，也可能存不同网段的 ip 地址需要同时检测，那咋整？

也有方法，可以把没有规划的 ip 地址同时批量检测，我们来看下代码：

```
for /f %D in (ip.txt) do (ping %D -n 1 && echo %i>>ok.txt || echo %D >>no.txt)


```

看见没有，多了一个 ip.txt 文件。

这个文件是要你自己准备的哦，把你 ping 的地址写到这个文件里面，代码会自己读取这个文件里面的 ip 地址，并且把结果放到两个文件里面去。

这里就不给大家截图了与上图差不多。

这里面补充下：上面代码生成的文件，在你命令行默认目录下。

也就是说，如果你的命令行状态是 "c:\windows\system32>"，那么生成的文件，就在系统的 system32 目录下面。

如果是 "c:\" 那么文件就在 C 盘根目录下。这个可以根据自己的实际情况进行调整了哈。

> 链接：https://www.linuxmi.com/linux-kernel-or-os.html

![](https://mmbiz.qpic.cn/mmbiz_png/dW45qY3FeKvBYptMv8qLviaUC8RUgLlicsmLHTRTALQ1xUlyiaEcia4u2ynls98VtvyOPVy0yaXAxIMcaYb1JwYZ4A/640?wx_fmt=png)