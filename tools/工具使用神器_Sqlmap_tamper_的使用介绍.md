<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/gOvVWcjyCZypdnNxHyPS2g)

![](https://mmbiz.qpic.cn/mmbiz_png/Ar7BeyBAjVLic0ia4vSFIKa3mGPglabHsr3w9saZKOUiaicF3nkIIVicIiaX0kMGSG7qG5iaHNHbAoXbIvLmAxf35xaxg/640?wx_fmt=png)

点击上方蓝字关注我们

0x01 前言
-------

从开源软件 Sqlmap 学习字符的篡改，现在的 web 网络环境参数出入处基本都会过滤某些字符串，我们在进行 sql 注入时，Sqlmap 这款 Sql 注入神器的插件就可以帮助我们（Tamper）篡改字符，实现绕过，以下为实战中常用的 Tamper，建议收藏。

Sqlmap 下载地址：https://github.com/sqlmapproject/sqlmap

0x02 常用 Tamper
--------------

用法这里就不过多介绍了

```
python sqlmap.py -u xxx  --tamper xxx.py
```

2.1 0eunion.py
--------------

使用 e0UNION 替换 UNION

已经测试过的数据库：Mysql,Mssql

2.2 apostrophemask.py
---------------------

将**'**替换成 UTF-8urlencoded 的 **%EF%BC%87**

2.3 apostrophenullencode.py
---------------------------

将'替换成 %00%27

2.4 appendnullbyte.py
---------------------

在参数末尾加入 %00

已经测试过的数据库：Microsoft Access

2.5 base64encode.py
-------------------

base64 编码所有字符

2.6 between.py
--------------

将 > **字符替换为** NOT BETWEEN 0 AND

将 = 字符替换为 **BETWEEN # AND #** （这个 #看下面的例子）

```
'1 AND A = B--'

'1 AND A BETWEEN B AND B--'
```

已经测试过的数据库：Microsoft SQL Server 2005

MySQL 4, 5.0 and 5.5

Oracle 10g

PostgreSQL 8.3, 8.4, 9.0

2.7 bluecoat.py
---------------

将 sql 语句后的空格字符替换为 **%09**，**LIKE** 替换字符 **=**

已经测试过的数据库：mysql5.1 之前

2.8 charencode.py
-----------------

URL 编码

已经测试过的数据库：Microsoft SQL Server 2005

MySQL 4, 5.0 and 5.5

Oracle 10g

PostgreSQL 8.3, 8.4, 9.0

2.9 chardoubleencode.py
-----------------------

二次 URL 编码

2.10 charunicodeencode.py
-------------------------

URL 编码

必要条件: ASP,ASP.NET

使用数据库：Microsoft SQL Server 2000

Microsoft SQL Server 2005

MySQL 5.1.56

PostgreSQL 9.0.3

2.11 charunicodeescape.py
-------------------------

url 解码中的 % 篡改成 \\

2.12 commalesslimit.py
----------------------

替换字符的位置

```
'LIMIT 2, 3'
'LIMIT 3 OFFSET 2'
```

必要条件：mysql

已经测试过的数据库：mysql5.0，mysql5.5

2.13 concat2concatws.py
-----------------------

将 concat(a,b) 替换成 concat_ws(mid(char(0),0,0),a,b)

```
'CONCAT(1,2)'
CONCAT_WS(MID(CHAR(0),0,0),1,2)
```

必要条件：mysql

已经测试过的数据库：mysql5.0

2.14 dunion.py
--------------

将 UNION 换成 DUNION

必要条件：Oracle

2.15 equaltolike.py
-------------------

将 **=** 篡改成 **LIKE**

```
SELECT * FROM users WHERE id=1
SELECT * FROM users WHERE id LIKE 1
```

已经测试过的数据库：Microsoft SQL Server 2005

MySQL 4, 5.0 and 5.5

2.16 equaltorlike.py
--------------------

将 **=** 篡改成 **RLIKE**

2.17 greatest.py
----------------

使用 **greatest** 替换 **>**

已经测试过的数据库：MySQL 4, 5.0 and 5.5

Oracle 10g

PostgreSQL 8.3, 8.4, 9.0

2.18 halfversionedmorekeywords.py
---------------------------------

在每个关键字之前添加 mysql 版本注释

```
"value' UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND 'QDWa'='QDWa"
   "value'/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNULL(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,58)),/*!0NULL,/*!0NULL#/*!0AND 'QDWa'='QDWa"
```

必要条件：mysql<5.1

已经测试过的数据库：mysql4.0.18，5.0.22

2.19 htmlencode.py
------------------

html 编码

2.20 ifnull2casewhenisnull.py
-----------------------------

添加一个内联注释 (//) 到 information_schema 末尾

```
'SELECT table_name FROM INFORMATION_SCHEMA.TABLES'
'SELECT table_name FROM INFORMATION_SCHEMA/**/.TABLES'
```

2.21 lowercase.py
-----------------

将字符转换为小写

2.22 misunion.py
----------------

UNION 篡改为 -.1UNION

2.23 modsecurityversioned.py 和 modsecurityzeroversioned.py
----------------------------------------------------------

这两个 tamper 可以绕过 modsecurity 防火墙

2.24 multiplespaces.py 
-----------------------

在 sql 关键字周围添加多个空格

```
'1 UNION SELECT foobar'
'1     UNION     SELECT     foobar'
```

2.25 overlongutf8.py
--------------------

空格替换为 %C0%A0

2.26 percentage.py
------------------

在每一个字符前面添加一个百分比符号

```
'SELECT FIELD FROM TABLE'
'%S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E'
```

2.27 randomcase.py
------------------

字符替换成大小写字符

```
'function()'
'FuNcTiOn()'
```

2.28 randomcomments.py
----------------------

在关键字添加内联注释 //

```
'INSERT'
'I/**/NS/**/ERT'
```

2.29 sp_password.py
-------------------

将 sp_password 附加到有效负载的末尾，用来混淆

```
'1 AND 9227=9227-- '
 '1 AND 9227=9227-- sp_password'
```

必要条件：mssql

2.30 space2comment.py
---------------------

空格替换成 //

```
'SELECT id FROM users'
'SELECT/**/id/**/FROM/**/users'
```

2.31 space2morecomment.py
-------------------------

空格替换成 / /

已经测试过的数据库：mysql5.0 and 5.5

```
'SELECT id FROM users'
'SELECT/**_**/id/**_**/FROM/**_**/users'
```

2.32 space2mssqlblank.py
------------------------

将空格替换成随机的以下字符

```
'%01', '%02', '%03', '%04', '%05', '%06', '%07', '%08', '%09', '%0B', '%0C', '%0D', '%0E', '%0F', '%0A'
```

```
'SELECT id FROM users'
'SELECT%0Did%0DFROM%04users'
```

适用数据库：Microsoft SQL Server

已经测试过的数据库：sql server 2000 sql server 2005

2.33 space2mssqlhash.py
-----------------------

将空格替换成 %23%0A

适用数据库：mssql mysql

2.34 space2plus.py
------------------

将空格替换成 +

2.34 space2randomblank.py
-------------------------

将刻个替换成以下随机的字符

```
"%09", "%0A", "%0C", "%0D"
```

测试过的数据库：

Microsoft SQL Server 2005

MySQL 4, 5.0 and 5.5

Oracle 10g

PostgreSQL 8.3, 8.4, 9.0

2.35 symboliclogical.py
-----------------------

将 and 和 or 的逻辑运算符分别替换为 (&& 和 ||)

```
"1 AND '1'='1"
"1 %26%26 '1'='1"
```

2.36 unionalltonnion.py
-----------------------

将 union all select 替换成 union select

```
'-1 UNION ALL SELECT'
'-1 UNION SELECT'
```

2.37 uppercase.py
-----------------

将关键字符替换成大写

```
'insert'
'INSERT'
```

已经测试过的数据库：Microsoft SQL Server 2005

MySQL 4, 5.0 and 5.5

Oracle 10g

PostgreSQL 8.3, 8.4, 9.0

2.38 varnish.py
---------------

附加一个 HTTP 头来 X-originating-IP = "127.0.0.1" 来绕过防火墙

2.39 xforwardedfor.py
---------------------

附加一个虚假的 HTTP 头 “X-Forwarded-For”

0x3 总结
------

很多人觉得使用这款神器觉得挖不到注入，其实大多数情况下一般都进行了过滤，这时候这款开源软件里面的 tamper 还是很值得我们学习的，对于绕过防火墙也是很好的思路。

![](https://mmbiz.qpic.cn/mmbiz_gif/6aVaON9Kibf7jNIAOgqwdCv2J77riaDsoMDSpLqoaUiao8aD9r3FwP0gFU2Psuqv6SgVAPhib8hibvO8CaEM8wu1Arw/640?wx_fmt=gif)