<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ZO3B9cwNhAwZhevhw-Z_kw)

BurpCrypto 是一款支持多种加密算法、或直接执行浏览器 JS 代码的 BurpSuit 插件。  

**一、编译**  

```
mvn package

```

**二、为什么解决了痛点**

目前越来越多的网站系统在登录接口、数据请求接口中加入各式各样的加密算法，甚至有些网站在每次请求前都动态请求加密密钥等措施，对接口渗透工作造成较大障碍。依赖于 BurpSuite 中的那些编码方式、Hash 算法已经远远不够，通过 BurpCrypto 内置的 RSA、AES、DES 模块可应对较为简单的前端加密接口，较为复杂的加密算法，可使用 ExecJS 模块直接手动编写处理代码。同时为了降低 ExecJS 模块的上手难度，未来将推出远程 JS 模块仓库，支持远程加载已经测试通过的 JS 功能代码，方便直接调用。

**三、未来开发计划**

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9LYPSQojJpUrmk4NdJ86F1Sia5H2eUP1enbz3dFVxmI3xb9CtObypnHQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic)**四、安装**

BurpCrypto 可从其官方 Github 页面进行下载已编译好的版本，或下载源代码本地编译，然后在 BurpSuite 的扩展列表中添加插件，等待 Output 中输出`BurpCrypto loaded successfully!`则表示插件加载成功。

**五、基础加密模块使用**
--------------

基础编码方式，由于不同网站开发人员的使用习惯，加密时所使用的密钥、加密后的密文会使用不同的编码方式。目前插件内密钥输入所支持的编码方式有如下三种
------------------------------------------------------------------------

*   Base64
    
*   HEX
    
*   UTF8String
    

密文输出所支持的编码方式有如下两种

*   Base64
    
*   HEX
    

ExecJS 模块的输出内容由 JS 代码决定。

#### **六、编码方式的辨别方法**

#### 为了照顾到对编码方式不了解的朋友，此处会简单讲解这些编码方式的辨别方法，已经了解的朋友可直接跳过参阅下一章节的具体使用讲解.

Base64 编码与 HEX 编码常常用于编码二进制数据，UTF8String 则是我们操作系统、网页中最常见的字符串的编码方式，下方是 Base64、HEX、UTF8String 编码的示例：

```
对字符串"test_z"进行Base64、HEX编码的结果
Base64：dGVzdF96
HEX：746573745f7a
UTF8String：test_z

```

AES 和 DES 加密都属于对称加密算法，既加解密使用同一套密钥的加密算法，同时也是目前前端加密中较为常见的加密算法，目前插件支持的 AES 加密算法有：

*   AES/CBC/PKCS5Padding
    
*   AES/CBC/NoPadding
    
*   AES/CBC/ZeroPadding
    
*   AES/ECB/PKCS5Padding
    
*   AES/ECB/NoPadding
    
*   AES/ECB/ZeroPadding
    
*   AES/OFB/PKCS5Padding
    
*   AES/OFB/NoPadding
    
*   AES/OFB/ZeroPadding
    
*   AES/CFB/PKCS5Padding
    
*   AES/CFB/NoPadding
    
*   AES/CFB/ZeroPadding
    
*   AES/CTR/PKCS5Padding
    
*   AES/CTR/NoPadding
    
*   AES/CTR/ZeroPadding
    

DES 加密算法有：

*   DES/CBC/PKCS5Padding
    
*   DES/CBC/ZeroPadding
    
*   DES/CBC/NoPadding
    
*   DES/ECB/PKCS5Padding
    
*   DES/ECB/ZeroPadding
    
*   DES/ECB/NoPadding
    
*   DES/OFB/PKCS5Padding
    
*   DES/OFB/ZeroPadding
    
*   DES/OFB/NoPadding
    
*   DES/CFB/PKCS5Padding
    
*   DES/CFB/ZeroPadding
    
*   DES/CFB/NoPadding
    
*   DESede/CBC/PKCS5Padding
    
*   DESede/CBC/ZeroPadding
    
*   DESede/CBC/NoPadding
    
*   DESede/ECB/PKCS5Padding
    
*   DESede/ECB/ZeroPadding
    
*   DESede/ECB/NoPadding
    
*   DESede/OFB/PKCS5Padding
    
*   DESede/OFB/ZeroPadding
    
*   DESede/OFB/NoPadding
    
*   DESede/CFB/PKCS5Padding
    
*   DESede/CFB/ZeroPadding
    
*   DESede/CFB/NoPadding
    
*   strEnc
    
    在前端 JS 中常常会使用 PKCS7Padding，在本模块中可使用 PKCS5Padding 代替，不影响使用。
    
    DES 加密中的 strEnc 算法是取自作者 Guapo 的一种 3DES 的模块，在少数系统中被使用，此处为了方便使用也引入了进来。
    

#### 非对称加密算法

RSA 算法则属于非对称加密算法，密钥分为公钥与私钥，暂时仅支持公钥加密，RSA 加密支持两种公钥格式的输入，分别为

*   X509
    
*   ModulusAndExponent
    

X509 密钥格式表现为一串由 Base64 编码后的字符串，常常以`MIG`开头。ModulusAndExponent(模数，指数) 则表现为两个 HEX 编码的参数，Modulus 是模数，常常较长，Exponent 是指数，常常只有 6 位，以下为密钥示例：

```
X509: MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCC0hrRIjb3noDWNtbDpANbjt5Iwu2NFeDwU16Ec87ToqeoIm2KI+cOs81JP9aTDk/jkAlU97mN8wZkEMDr5utAZtMVht7GLX33Wx9XjqxUsDfsGkqNL8dXJklWDu9Zh80Ui2Ug+340d5dZtKtd+nv09QZqGjdnSp9PTfFDBY133QIDAQAB
ModulusAndExponent:
  Modulus: A1E4D93618B8B240530853E87738403851E15BBB77421F9B2377FB0B4F1C6FC235EAEC92EA25BB76AC221DCE90173A2E232FE1511909C76B15251D4059B288E709C1EF86BCF692757AAD736882DD1E98BEDFED9311A3C22C40657C9A52880BDC4B9E539041D44D52CB26AD13AB086F7DC294D144D6633A62EF91CA1775EB9A09
  Exponent: 010001

```

#### **七、使用**

#### 使用方式也较为简单，首先判断相关接口的加密算法，填入相应算法的加密密钥，点击`Add processor`，在弹出的加密配置命名输入对话框中，给予一个易于分辨的名称，提示`Apply processor success!`即表示添加成功。

此处以 AES 的 CBC 模式，填充 Pkcs7，Key：Y3MxMTg1MzUyOS4x，IV：9875643210132456，Base64 编码的方式做为示例。

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9GGic0VUR6v8Riau6BNEPAZYcJmrMGUdZ3w0D57fKBWOhZd8tCxrI3OwA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic)

若要删除 processor 则要点击`Remove processor`，输入刚刚编写的配置名，即可删除。

关于前端加密的分析过程可参阅 jsEncrypter 开发者 c0ny1 的文章：https://gv7.me/articles/2018/fast-locate-the-front-end-encryption-method/

**八、补充阅读**

对单加密参数的登录接口进行密码爆破的一种方法，ExecJS 模块使用由于软件开发的复杂性，诸如多层嵌套加密、引入时间变量、动态密钥、魔改加密算法、新算法的涌现，插件注定永远无法做到对所有加密算法的百分百覆盖，所以提供了 ExecJS 模块，为动手能力较强的使用者提供一条新途径。

因 JS 新特性的快速迭代，插件中内置了 Rhino、HtmlUnit、Jre 内置三种 JS 执行引擎，各种执行引擎的优劣势可参阅 BurpCrypto 未来开发计划中对于各个引擎的特性介绍。

### **九、编写简单的 JS 脚本**

### 使用 ExecJS 模块前需要先切换至插件的`ExecJS`选项卡，像常见编程语言一样，你需要编写一个入口函数。不过不同于其他编程语言的入口函数，插件将会把待处理 / 加密的内容传递给入口函数的第一个参数，而你编写的入口函数则需要在处理结束后返回处理结果。

为了方便使用，插件内置了一个快速生成函数体的菜单，在代码编辑器中的右键菜单中点击`Append Simple Function`，即可生成一个空函数`calc`，并自动在下面的入口函数名填写入口函数为`calc`。

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9ic3kpalEv1HfsibngoMYpvxtqgwDY0PHrrdqKtUchfursaMd5VlumcZQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic)

我们可以对该函数进行一些简单的修改，下面是一个示例脚本，该脚本将会把输入的内容倒转后再返回。

```
function calc(pass) {
     return pass.split("").reverse().join("");
}

```

编辑完成后，点击`Add processor`即可添加成功。

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9ox9ZMFqxTjiadXnyaatsVobcNy960kdPPJicj0YDgzBqCBAyzZ83aj0Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic)

### **十、引用内置 JS 库**

### 目前内置的 JS 库只有 MD5 与 Base64，后续版本将会上线在线 JS 仓库，操作步骤将会发生变动。

为避免常见库的频繁整理导入的工作量，插件目前内置了 MD5 和 Base64 库，使用方法为在编辑器的右键菜单中的`Include Snippet`选中需要的 JS 库，即可引入。

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9bo5l34kSHAG7BBaRKdSsOwHIFYSmp4caVBuDGSm0x4C32WpPmBZS5A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic)

**十一、在功能区中调用插件**

加密，通过在上述几个模块中成功添加 processor 后，即可通过以下两个渠道进行使用。

QuickCrypto（全局调用）

BurpCrypto 几乎可以在 BurpSuite 的任何位置进行调用，调用方法也较为简单，以下动图为示例：

![](https://mmbiz.qpic.cn/mmbiz_gif/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9uKcKQoJJzwic6tJzLIDXY97b23HJZD8bVKxUAD79vl5b8cPTfhdTAkw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=wxpic)

**十二、Intruder（爆破模块）**

在爆破模块中引用：

![](https://mmbiz.qpic.cn/mmbiz_gif/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9Tkxk37Oiby2by8OKs0x1nHmNiciakS9SjEolEzxKWHn25LAoIwKJ43byQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=wxpic)

### **十三、解密（查询原文）**  

由于部分算法产生的结果具有不可逆性（哈希算法、自定义的 JS 代码等），所以通过本插件生成的所有结果均被保存到本地的 K/V 数据库中，可以通过插件中的`Get PlainText`功能获取原始明文。

使用方法为完整选中密文内容，右单击后找到 BurpCrypto 菜单中的`Get PlainText`功能，

此处演示的是 RSA 公钥加密后通过密文查询原始明文。

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9YTwiaf4JVDxNaRfNZ9GX8lf0XAbdibXdBcKmPPSkCqx4P79nj5hTYt6A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic)

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibvdeFKQ9OpUZ484DdXUgTO9PBfAI28fnCCf8WPbrTJwO1vy51gT3K3ShNwvrx5dpqRTRmxtSsrK9g/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic)

内容来源：https://github.com/whwlsfb/BurpCrypto

**十四、结尾**

以上为本插件的使用说明，后续将会将会陆续加入国密算法、ExecJS 远程模块，模块互调等小功能更新与 Bug 修复，如果各位师傅有更多的建议也欢迎提 PR 或者 Issure，谢谢！

如有侵权，请联系删除

![](https://mmbiz.qpic.cn/mmbiz_png/QO6oDpE0HEmt8Ss52ibJFcYB7ZHBRVbIpxr9XXibHdW6Eib11FYq0FDZFNMUgDMcqTyfs6iaX8OtFdlL6ypEVHCLrw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

好文推荐

![](https://mmbiz.qpic.cn/mmbiz_png/QO6oDpE0HEmt8Ss52ibJFcYB7ZHBRVbIpzdIMlC9plAr8AiaQRUUvBFXZM2scib9zTnRyp0XZQxSUYAWWS0avKrCA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

[红队打点评估工具推荐](http://mp.weixin.qq.com/s?__biz=Mzk0NjE0NDc5OQ==&mid=2247508839&idx=1&sn=abc801070b0e44475887ddbf7273c2e7&chksm=c3087017f47ff901ecb212aadc22c5cbfc6407da79b43a6f48a355cc3fd8c5af79c113db5fd1&scene=21#wechat_redirect)

[干货 | 红队项目日常渗透笔记](http://mp.weixin.qq.com/s?__biz=Mzk0NjE0NDc5OQ==&mid=2247509256&idx=1&sn=76aad07a0f12d44427ce898a6ab2769e&chksm=c3087678f47fff6e2b750f41514d933390a8f97efef8ed18af7d8fb557500009381cd434ec26&scene=21#wechat_redirect)  

[实战 | 后台 getshell + 提权一把梭](http://mp.weixin.qq.com/s?__biz=Mzk0NjE0NDc5OQ==&mid=2247508609&idx=1&sn=f3fcd8bf0e75d43e3f26f4eec448671f&chksm=c30871f1f47ff8e74551b09f092f8673890607257f2d39c0efa314d1888a867dc718cc20b7b3&scene=21#wechat_redirect)

[一款漏洞查找器（挖漏洞的有力工具）](http://mp.weixin.qq.com/s?__biz=Mzk0NjE0NDc5OQ==&mid=2247507539&idx=2&sn=317a2c6cab28a61d50b22c07853c9938&chksm=c3080d23f47f8435b31476b13df045abaf358fae484d8fbe1e4dbd2618f682d18ea44d35dccb&scene=21#wechat_redirect)

[神兵利器 | 附下载 · 红队信息搜集扫描打点利器](http://mp.weixin.qq.com/s?__biz=Mzk0NjE0NDc5OQ==&mid=2247508747&idx=1&sn=f131b1b522ee23c710a8d169c097ee4f&chksm=c308707bf47ff96dc28c760dcd62d03734ddabb684361bd96d2f258edb0d50e77cdb63a3600a&scene=21#wechat_redirect)

[神兵利器 | 分享 直接上手就用的内存马（附下载）](http://mp.weixin.qq.com/s?__biz=Mzk0NjE0NDc5OQ==&mid=2247506855&idx=1&sn=563506565571f1784ad1cb24008bcc06&chksm=c30808d7f47f81c11b8c5f13ce3a0cc14053a77333a251cd6b2d6ba40dc9296074ae3ffd055e&scene=21#wechat_redirect)

[推荐一款自动向 hackerone 发送漏洞报告的扫描器](http://mp.weixin.qq.com/s?__biz=Mzk0NjE0NDc5OQ==&mid=2247501261&idx=1&sn=0ac4d45935842842f32c7936f552ee21&chksm=c30816bdf47f9fab5900c9bfd6cea7b1d99cd32b65baec8006c244f9041b25d080b2f23fd2c1&scene=21#wechat_redirect)

**欢迎关注 系统安全运维**